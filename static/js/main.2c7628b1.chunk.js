(this.webpackJsonpsmviewer=this.webpackJsonpsmviewer||[]).push([[0],{240:function(e,t,n){e.exports=n(416)},251:function(e,t,n){},416:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(37),i=n.n(o),s=n(21),c=(n(250),n(251),n(27)),l=n.n(c),u=n(49),d=n(16),f=n(229),m=(n(253),["left","down","up","right"]),p=["Beginner","Basic","Difficult","Expert","Challenge"],h=["Basic","Difficult","Expert","Challenge"],v=function(){return window.location.search?window.location.href.slice(0,window.location.href.indexOf(window.location.search)):window.location.href},g=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{mode:"cors"});case 2:return n=e.sent,a=n.body.getReader(),r=new TextDecoder("utf-8"),e.next=7,a.read();case 7:return o=e.sent,e.abrupt("return",r.decode(o.value));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(e){return v()+"assets/"+e},y=function(e){return v()+"jackets/"+e},w=function(e){return e.slice(0,1).toUpperCase()+e.slice(1)},O=function(){if(!window.location.search)return{};var e={};try{return window.location.search.slice(1).split("&").forEach((function(t){var n=t.split("="),a=Object(d.a)(n,2),r=a[0],o=a[1];e[r]=o})),e}catch(t){return console.log("error parsing url params",t),{}}}(),E=n(47),S=n(23),P=n(19),k=n(20),C=n(28),j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var n=document.querySelector("#debugLog .debug-text".concat(t));n&&(n.textContent=e)},D=function(e){console.log("DSC",e);var t=e.chart,n="".concat(e.mode," ").concat(e.difficulty," ").concat(e.level,"\n\n");!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var n=document.querySelector("#logView".concat(t));n&&(n.textContent=e)}(n+=t.map((function(e){if(!e.length)return"[    ]\n";for(var t="[",n=e[0].measureD,a=function(a){var r=e.find((function(e){return e.measureN==a}));a>0&&(t+=" "),t+=r?r.note:"0000",a<n-1&&(t+="\n")},r=0;r<n;r++)a(r);return t+="] (".concat(n," ticks)\n")})).join("\n"),1)};function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){var t=e.audio,n=e.globalParams.arrows;if(!n.length)return 0;for(var a=t.seek(),r=0;r<n.length;r++){var o=n[r];if(o.combo&&o.timestamp>a+.07)return o.combo-1}for(var i=n.length-1;i>=0;i--){var s=n[i];if(s.combo)return s.combo}return-1},N=function(e,t,n){return n.height-(e+t)},T={};m.forEach((function(e){T["rainbow_".concat(e)]=new Image,T["rainbow_".concat(e)].src=b("rainbow_".concat(e,".png")),T["note_".concat(e)]=new Image,T["note_".concat(e)].src=b("note_".concat(e,".png")),T["vivid_".concat(e)]=new Image,T["vivid_".concat(e)].src=b("vivid_".concat(e,".png")),T["flat_".concat(e)]=new Image,T["flat_".concat(e)].src=b("vivid_".concat(e,".png"))}));["freeze_head","tap_explosion","freeze_tail_active","freeze_tail_inactive","freeze_body_active","freeze_body_inactive"].forEach((function(e){T[e]=new Image,T[e].src=b("".concat(e,".png"))}));var x=function(){function e(t){Object(P.a)(this,e);var n=t.key;this.key=n,this.note=t.note,this.measureIdx=t.measureIdx,this.measureN=t.measureN,this.measureD=t.measureD,this.originalBeatPosition=t.originalBeatPosition,this.holdBeats=t.holdBeats||null}return Object(k.a)(e,[{key:"currentBeatPosition",value:function(e){return this.originalBeatPosition-e}},{key:"renderFreezeBody",value:function(e,t,n,a){var r,o,i,s,c,l=e.getContext("2d"),u=a.mods,d=u.speed,f=u.scroll,p=u.appearance,h=e.height,v=m[n%4];if("3"===this.note[n]){r=T.freeze_tail_inactive,o=64*(n%4+("reverse"===f?4:0)),i=0,s=64*n,c=64*this.currentBeatPosition(t)*d;var g=T.freeze_body_inactive,b=64*this.holdBeats[n]*d-32,y=Math.floor(b/128),w=b%128,O=w,E=c-(b+32),S=!1;E<=0&&(w+=E,E=0,r=T.freeze_tail_active,g=T.freeze_body_active,c>0&&(S=!0)),E>-w&&E<h&&"stealth"!==p&&l.drawImage(g,o,"reverse"===f?0:128-w,64,w,s,"reverse"===f?N(E+32,w,e):E+32,64,w);for(var P=1;P<=y;P++){var k=128,C=0,j=c-(b+32-O-128*(P-1));j<0&&j>-128&&(k+=j,C-=j,j=0),j>-k&&j<h&&"stealth"!==p&&l.drawImage(g,o,"reverse"===f?0:C,64,k,s,"reverse"===f?N(j+32,k,e):j+32,64,k)}var D=64,L=c;if(64*this.holdBeats[n]*d<32){var A=64*this.holdBeats[n]*d;i+=32-A,c+=32-A,D=A+32}if(c<32&&c>0&&(i+=32-c,c=32),L>0&&L<h&&"stealth"!==p&&l.drawImage(r,o,"reverse"===f?0:i,64,"reverse"===f?64-i:D,s,"reverse"===f?N(L,64,e):c,64,"reverse"===f?64-i:D),S){var _=T.freeze_head;l.drawImage(_,64*m.indexOf(v),128,64,64,64*n,"reverse"===f?N(0,64,e):0,64,64)}}}},{key:"renderArrow",value:function(e,t,n,a){var r=e.getContext("2d"),o=a.mods,i=o.speed,s=o.noteskin,c=o.colorFreezes,l=o.scroll,u=o.appearance,d=e.height;if("0"!==this.note[n]&&"stealth"!==u){var f,p,h,v,g,b=m[n%4];if("1"===this.note[n]||"2"===this.note[n]&&c){if(f=T["".concat(s,"_").concat(b)],this.note.includes("2")&&!c)f=T.freeze_head,p=64*m.indexOf(b),h=0;else if("rainbow"===s){p=Math.floor(4*t)%8*64;var y=this.measureD/4,w=this.measureN%y;0===w?h=0:0<w&&w<=y/4?h=1:y/4<w&&w<=y/2?h=2:y/2<w&&w<=3*y/4?h=3:3*y/4<w&&w<y&&(h=0),h*=64}else if("note"===s){p=Math.floor(4*t)%8*64;var O=this.measureN/this.measureD;h=[0,.25,.5,.75].includes(O)?0:[1/8,3/8,5/8,7/8].includes(O)?1:[1/16,3/16,5/16,7/16,9/16,.6875,.8125,.9375].includes(O)?3:2,h*=64}else if("vivid"===s){p=Math.floor(4*t)%4*64;var E=this.measureD/4,S=this.measureN%E;0===S?h=0:0<S&&S<=E/4?h=1:E/4<S&&S<=E/2?h=2:E/2<S&&S<=3*E/4?h=3:3*E/4<S&&S<E&&(h=0),h=(h+Math.floor(t)%4)%4*64}else"flat"===s&&(f=T["vivid_".concat(b)],p=Math.floor(4*t)%4*64,h=Math.floor(t)%4*64);v=64*n,(g=(g=64*this.currentBeatPosition(t)*i)+.5|0)>0&&g<d&&r.drawImage(f,p,h,64,64,v,"reverse"===l?N(g,64,e):g,64,64)}else"2"===this.note[n]&&(f=T.freeze_head,p=64*m.indexOf(b),h=0,v=64*n,(g=(g=64*this.currentBeatPosition(t)*i)+.5|0)>0&&g<d&&r.drawImage(f,p,h,64,64,v,"reverse"===l?N(g,64,e):g,64,64))}}}]),e}(),R={};m.forEach((function(e){R["shock_".concat(e)]=new Image,R["shock_".concat(e)].src=b("shock_".concat(e,".png"))}));var I=function(){function e(t){Object(P.a)(this,e);var n=t.key;this.key=n,this.note=t.note,this.originalBeatPosition=t.originalBeatPosition}return Object(k.a)(e,[{key:"currentBeatPosition",value:function(e){return this.originalBeatPosition-e}},{key:"render",value:function(e,t,n,a){var r=e.getContext("2d"),o=a.mods,i=o.speed,s=o.scroll;if("stealth"!==o.appearance){var c=e.height;t=Math.floor(t/3)%8;for(var l=0;l<this.note.length;l++)if("M"===this.note[l]){var u=m[l%4],d=R["shock_".concat(u)],f=t%4*64,p=64*Math.floor(t/4),h=64*l,v=64*this.currentBeatPosition(n)*i;v>-64&&v<c&&r.drawImage(d,f,p,64,64,h,"reverse"===s?N(v,64,e):v,64,64)}}}}]),e}(),M={};m.forEach((function(e){M[e]=new Image,M[e].src=b("".concat(e,"_tap_flash.png")),M[e]=new Image,M[e].src=b("".concat(e,"_tap_flash.png"))}));var B={};m.forEach((function(e){B[e]=new Image,B[e].src=b("".concat(e,"_tap_receptor.png")),B[e]=new Image,B[e].src=b("".concat(e,"_tap_receptor.png"))}));var V=function(){function e(t){Object(P.a)(this,e)}return Object(k.a)(e,[{key:"render",value:function(e,t,n){var a=e.getContext("2d"),r=n.mode,o=n.mods.scroll,i=t%1>0&&t%1<.25;m.forEach((function(t,n){a.drawImage(i?M[t]:B[t],0,0,64,64,64*n,"reverse"===o?N(0,64,e):0,64,64),"double"===r&&a.drawImage(i?M[t]:B[t],0,0,64,64,64*(n+4),"reverse"===o?N(0,64,e):0,64,64)}))}}]),e}(),F=function(){function e(t){Object(P.a)(this,e),this.finalBeat=t}return Object(k.a)(e,[{key:"render",value:function(e,t,n){var a=n.mods,r=a.speed,o=a.scroll;if(a.guidelines){var i=e.getContext("2d");i.strokeStyle="#fff";for(var s=e.height,c=0;c<=this.finalBeat;c++){var l=64*(c-t)*r+32,u=c%4===0?2:1;(l=l+.5|0)>0&&l<s&&("reverse"===o&&(l=N(l,0,e)),i.beginPath(),i.moveTo(0,l),i.lineTo(e.width,l),i.lineWidth=u,i.stroke())}}}}]),e}(),U=new Image;U.src=b("tap_explosion.png");var H=function(){function e(t){var n=this;Object(P.a)(this,e),this.frame=-1,this.directions=[],t.note.forEach((function(e,t){"1"!==e&&"2"!==e&&"3"!==e||n.directions.push(t)}))}return Object(k.a)(e,[{key:"render",value:function(e,t){var n=this,a=e.getContext("2d"),r=t.mods.scroll;this.directions.forEach((function(t){if(!(n.frame<0||n.frame>=12)){var o=64*t;a.save(),a.globalAlpha=1-Math.pow(n.frame/12,3),a.drawImage(U,0,0,64,64,o-n.frame,"reverse"===r?N(0+n.frame,64,e):0-n.frame,64+2*n.frame,64+2*n.frame),a.restore()}}))}}]),e}(),z={};["A20","A"].forEach((function(e){z[e]={num:new Image,combo:new Image},z[e].num.src=b("combo_numbers_".concat(e,".png")),z[e].combo.src=b("combo_".concat(e,".png"))})),z.A20.coords={1:{combo:{destX:104,destY:195,width:124.5,height:41},num:{destX:[51],destY:170,width:63,height:70}},2:{combo:{destX:114,destY:195,width:124.5,height:41},num:{destX:[17,61],destY:170,width:63,height:70}},3:{combo:{destX:134,destY:195,width:124.5,height:41},num:{destX:[-7,37,81],destY:170,width:63,height:70}},4:{combo:{destX:134,destY:195,width:124.5,height:41},num:{destX:[-51,-7,37,81],destY:170,width:63,height:70}}},z.A.coords={1:{combo:{destX:104,destY:195,width:124.5,height:41},num:{destX:[51],destY:170,width:63,height:70}},2:{combo:{destX:114,destY:195,width:124.5,height:41},num:{destX:[17,61],destY:170,width:63,height:70}},3:{combo:{destX:134,destY:195,width:124.5,height:41},num:{destX:[-7,37,81],destY:170,width:63,height:70}},4:{combo:{destX:134,destY:195,width:124.5,height:41},num:{destX:[-51,-7,37,81],destY:170,width:63,height:70}}};var Z=function(){function e(t){Object(P.a)(this,e)}return Object(k.a)(e,[{key:"render",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=e.getContext("2d");if(!(t<4)){var r=n.mods,o=n.mode,i=r.comboFont,s=i,c=(t=t.toString()).length,l=z[s].combo,u=z[s].num,d=z[s].coords[c].combo.destX+("double"===o?128:0),f=z[s].coords[c].combo.destY,m=z[s].coords[c].combo.width,p=z[s].coords[c].combo.height;a.drawImage(l,0,0,l.width,l.height,d,f,m,p);for(var h=0;h<c;h++){var v=t[h],g=u.width/4,b=u.height/4,y=v%4,w=Math.floor(v/4),O=y*g,E=w*b,S=z[s].coords[c].num.destX[h]+("double"===o?128:0),P=z[s].coords[c].num.destY,k=z[s].coords[c].num.width,C=z[s].coords[c].num.height;a.drawImage(u,O,E,g,b,S,P,k,C)}}}}]),e}(),X={};X.upper=new Image,X.upper.src=b("upper_lanecover.png"),X.lower=new Image,X.lower.src=b("lower_lanecover.png");var Y=["hidden","sudden","hiddensudden"],q=function(){function e(t){Object(P.a)(this,e)}return Object(k.a)(e,[{key:"render",value:function(e,t){var n=e.getContext("2d"),a=t.mods,r=t.mode,o=a.appearance,i=a.scroll,s=a.laneCoverHeight[Y.indexOf(o)];if(o.includes("hidden")&&"normal"===i||o.includes("sudden")&&"reverse"===i){var c=X.upper;n.drawImage(c,0,N(s,0,e),c.width,s,0,0,c.width,s),"double"===r&&n.drawImage(c,0,N(s,0,e),c.width,s,256,0,c.width,s)}if(o.includes("sudden")&&"normal"===i||o.includes("hidden")&&"reverse"===i){var l=X.lower;n.drawImage(l,0,0,l.width,s,0,N(s,0,e),l.width,s),"double"===r&&n.drawImage(l,0,0,l.width,s,256,N(s,0,e),l.width,s)}}}]),e}(),W=/dance-([a-z]+)/,G=/(Beginner|Easy|Medium|Hard|Challenge|Edit)/,Q={Beginner:"Beginner",Easy:"Basic",Medium:"Difficult",Hard:"Expert",Challenge:"Challenge"},J=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sm",a={},r=e.slice(0,e.indexOf("ssc"===n?"#NOTEDATA:":"#NOTES:")),o=[],i=[];return/#BPMS:/i.test(r)&&(o=/#BPMS:([\s\S]*?)\s*;/i.exec(r)[1]).length&&(o=o.split(",").map((function(e){var t=e.split("="),n=Object(d.a)(t,2),a=n[0],r=n[1];return{beat:parseFloat(a),value:parseFloat(r)}}))),/#STOPS:/i.test(r)&&(i=/#STOPS:([\s\S]*?)\s*;/i.exec(r)[1]).length&&(i=i.split(",").map((function(e){var t=e.split("="),n=Object(d.a)(t,2),a=n[0],r=n[1];return{beat:parseFloat(a),value:parseFloat(r)}}))),t="ssc"===n?e.slice(e.indexOf("#NOTEDATA:")).split(/#NOTEDATA:\s*;/).slice(1):e.slice(e.indexOf("#NOTES:")).split(/#NOTES:\s+/).slice(1),console.log("chartStrs",t),t.forEach((function(e){var t=W.exec(e)[1],r=G.exec(e)[1],s=Q[r];a["".concat(t,"_").concat(s)]={difficulty:s,mode:t,bpms:o,stops:i};var c,l=a["".concat(t,"_").concat(s)];if("ssc"===n)c=/#METER:([0-9]+);/.exec(e)[1];else{var u=new RegExp("".concat(r,":\\s+([0-9]+):"));c=parseInt(u.exec(e)[1])}l.level=c,"ssc"===n&&(/#BPMS:/i.test(e)&&(o=/#BPMS:([\s\S]*?)\s*;/i.exec(e)[1]).length&&(o=o.split(",").map((function(e){var t=e.split("="),n=Object(d.a)(t,2),a=n[0],r=n[1];return{beat:parseFloat(a),value:parseFloat(r)}})),l.bpms=o),/#STOPS:/i.test(e)&&(i=/#STOPS:([\s\S]*?)\s*;/i.exec(e)[1]).length&&(i=i.split(",").map((function(e){var t=e.split("="),n=Object(d.a)(t,2),a=n[0],r=n[1];return{beat:parseFloat(a),value:parseFloat(r)}})),l.stops=i));var f=e.slice(e.lastIndexOf(":")+1,e.lastIndexOf(";")).trim().split(",").map((function(e,t){var n=e.trim().split("\r\n").filter((function(e){return!e.startsWith("//")})),a=n.length,r=[];return n.forEach((function(e,n){if(e.split("").filter((function(e){return"0"!==e})).length){var o={};o.note=e,o.measureIdx=t,o.measureN=n,o.measureD=a,r.push(o)}})),r}));l.chart=f})),a},K=n(111),$=n(48),ee=n(205);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae={chartAudio:{status:"stopped",progress:0},previewAudio:{status:"stopped"}},re=function(e){return function(t){t({type:"CHANGE_ACTIVE_BPM_DISPLAY",payload:e})}};function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se={activeBpm:null,bpmChangeQueue:[],combo:0},ce=function(e){return function(t){t({type:"UPDATE_MODS",payload:e})}},le=function(){try{var e=window.localStorage.getItem("userSettings");return e?JSON.parse(e):{}}catch(t){return console.error(t),{}}},ue=function(e){var t=window.localStorage.getItem("userSettings");try{t=t?JSON.parse(t):{}}catch(n){console.error(n)}Object.keys(e).forEach((function(n){t[n]=e[n]})),window.localStorage.setItem("userSettings",JSON.stringify(t))},de=function(e){window.localStorage.setItem("progress",e)},fe={difficulty:["Beginner","Basic","Difficult","Expert","Challenge"],mode:["single","double"],mods:{speed:[.25,.5,.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.5,5,5.5,6,6.5,7,7.5,8],appearance:["visible","hidden","sudden","hiddensudden","stealth"],turn:["off","mirror","left","right","shuffle"],shuffle:[1,2,3,4,5,6,7,8],stepZone:["on","off"],scroll:["normal","reverse"],noteskin:["rainbow","note","vivid","flat"],comboDisplay:["behind","inFront","hidden"],comboFont:["A20","A"]}},me={difficulty:"Challenge",mode:"single",mods:{speed:3,appearance:"visible",laneCoverHeight:[8,8,8],laneCoverVisible:!0,turn:"off",shuffle:1,stepZone:"on",scroll:"normal",noteskin:"note",guidelines:!0,comboDisplay:"behind",comboFont:"A20",colorFreezes:!1}},pe=le();if(["song","difficulty","mode"].forEach((function(e){pe[e]&&(me[e]=pe[e])})),pe.mods&&Object.keys(me.mods).forEach((function(e){"undefined"!==typeof pe.mods[e]&&(me.mods[e]=pe.mods[e])})),O.difficulty){var he={b:"Beginner",B:"Basic",D:"Difficult",E:"Expert",C:"Challenge"};Object.keys(he).includes(O.difficulty[0])&&(me.difficulty=he[O.difficulty[0]]),"S"===O.difficulty[1]?me.mode="single":"D"===O.difficulty[1]&&(me.mode="double")}if(O.speed){var ve=parseFloat("".concat(O.speed[0],".").concat(O.speed.slice(1)));fe.mods.speed.includes(ve)&&(me.mods.speed=ve)}if(O.turn){var ge=O.turn.toLowerCase();fe.mods.turn.includes(ge)&&(me.mods.turn=ge)}function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we=me.mods;function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=le(),Pe={innerWidth:window.innerWidth,innerHeight:window.innerHeight,activeView:Se.activeView||"song"},ke=function(e){return function(t){t({type:"SELECT_SONG",payload:e})}};function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var De={difficulty:me.difficulty,mode:me.mode},Le=Object($.c)({audio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CHART_AUDIO_STATUS":var n=ne({},e.chartAudio,{status:t.payload});return ne({},e,{chartAudio:n});case"PLAY_CHART_AUDIO":var a=ne({},e.chartAudio,{status:"playing"});return ne({},e,{chartAudio:a});case"PAUSE_CHART_AUDIO":var r=ne({},e.chartAudio,{status:"paused"});return ne({},e,{chartAudio:r});case"STOP_CHART_AUDIO":var o=ne({},e.chartAudio,{status:"stopped"});return ne({},e,{chartAudio:o});case"SET_PREVIEW_AUDIO_STATUS":var i=ne({},e.previewAudio,{status:t.payload});return ne({},e,{previewAudio:i});case"PLAY_PREVIEW_AUDIO":var s=ne({},e.previewAudio,{status:"playing"});return ne({},e,{previewAudio:s});case"STOP_PREVIEW_AUDIO":var c=ne({},e.previewAudio,{status:"stopped"});return ne({},e,{previewAudio:c});case"SET_CHART_PROGRESS":var l=ne({},e.chartAudio,{progress:t.payload});return ne({},e,{chartAudio:l});default:return e}},chart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BPM_CHANGE_QUEUE":return ie({},e,{bpmChangeQueue:Object(E.a)(t.payload)});case"CHANGE_ACTIVE_BPM_DISPLAY":var n=Math.round(t.payload);return ie({},e,{activeBpm:n});case"SET_COMBO":return ie({},e,{combo:t.payload});default:return e}},mods:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_MODS":var n=t.payload,a=ye({},e,{},n);return ue({mods:a}),a;case"UPDATE_LANE_COVER_HEIGHT":var r=t.payload,o=r.diff,i=r.canvasHeight,s=Object(E.a)(e.laneCoverHeight),c=0,l=i;"hiddensudden"===e.appearance&&(l/=2);for(var u=0;u<s.length;u++){s[u]+=o[u];var d=s[u];d<c?s[u]=c:d>l&&(s[u]=l)}var f=ye({},e,{laneCoverHeight:s});return ue({mods:f}),f;default:return e}},screen:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESIZE_SCREEN":var n=t.payload.target,a=n.innerWidth,r=n.innerHeight,o={innerWidth:a,innerHeight:r};return Ee({},e,{},o);case"SET_ACTIVE_VIEW":var i=t.payload;return ue({activeView:i}),Ee({},e,{activeView:i});default:return e}},songSelect:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_SONG":var n=t.payload;return ue({song:n.hash}),je({},e,{song:n});case"SELECT_DIFFICULTY":var a=t.payload;return ue({difficulty:a}),je({},e,{difficulty:a});case"SELECT_MODE":var r=t.payload;return ue({mode:r}),je({},e,{mode:r});default:return e}}}),Ae=Object($.e)(Le,Object($.d)(Object($.a)(ee.a),window.devToolsExtension?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e})),_e=new(function(){function e(){Object(P.a)(this,e),this.mouseDown=!1,this.currentProgress=0,this.presetStart=0,O.progress&&(this.presetStart=O.progress/1e5,this.currentProgress=this.presetStart)}return Object(k.a)(e,[{key:"initCanvas",value:function(){var e=this;this.canvas=document.querySelector("#progress"),this.presetMarker=document.querySelector("#progress + .preset-marker-wrapper"),this.drawBackground(),this.canvas.addEventListener("touchstart",(function(t){t.preventDefault(),e.jumpToProgress(t.touches[0])})),this.canvas.addEventListener("touchmove",(function(t){t.preventDefault(),e.jumpToProgress(t.touches[0])})),this.canvas.addEventListener("mousedown",(function(t){t.preventDefault(),e.jumpToProgress(t),e.mouseDown=!0})),this.canvas.addEventListener("mousemove",(function(t){t.preventDefault(),e.mouseDown&&e.jumpToProgress(t)})),this.canvas.addEventListener("mouseup",(function(t){t.preventDefault(),e.mouseDown=!1})),this.setPresetMarker(),window.addEventListener("resize",(function(t){e.setPresetMarker()}))}},{key:"setPresetMarker",value:function(){if(this.presetStart&&this.presetMarker){var e=this.canvas.offsetWidth;this.presetPosition=e*this.presetStart,this.presetMarker.style.left="".concat(this.presetPosition,"px")}}},{key:"setProgress",value:function(e){this.currentProgress=e}},{key:"getProgress",value:function(){return this.currentProgress}},{key:"jumpToProgress",value:function(e,t){var n;if(t)n=t;else{var a=this.canvas.getBoundingClientRect(),r=a.width;n=(e.clientX-a.x)/r}n<0||n>1||(this.setProgress(n),Ne.seekProgress(n))}},{key:"jumpToPresetStart",value:function(e){this.jumpToProgress(e,this.presetStart),e.stopPropagation()}},{key:"drawBackground",value:function(){var e=this.canvas.getContext("2d");e.fillStyle="#d7e2ed",e.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"render",value:function(e){if(!isNaN(e)){this.setProgress(e),this.drawBackground();var t=this.canvas.getContext("2d");t.fillStyle="#627c92",t.fillRect(0,0,this.canvas.width*e,this.canvas.height)}}}]),e}()),Ne=new(function(){function e(){Object(P.a)(this,e),this.sources={song:{},preview:{},assistTick:{audio:new K.Howl({src:b("sounds/assist_tick.wav")})}},window.sources=this.sources,this.currentSong=null,this.currentPreview=null,this.currentSongId=null,this.currentPreviewId=null,this.previewFadeTimeout=null,this.updateTimeline=this.updateTimeline.bind(this),this.updateProgress=this.updateProgress.bind(this),this.audioResyncFrames=0}return Object(k.a)(e,[{key:"getCurrentSong",value:function(){return this.sources.song[this.currentSong]}},{key:"getCurrentPreview",value:function(){return this.sources.preview[this.currentPreview]}},{key:"getCurrentTime",value:function(){return this.getCurrentSong().audio.seek()}},{key:"storeAudioSource",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.sources.song[e.hash]){this.setLoadingAudio(!0);var a=this.sources.song[e.hash]={title:e.title};a.audio=new K.Howl({src:"https://dl.dropboxusercontent.com/s/".concat(e.dAudioUrl),format:["mp3"],html5:!0,onload:function(){t.setLoadingAudio(!1),t.seekProgress(n)},onloaderror:function(e,t,n){alert("".concat(e,";;; ").concat(t,";;; ").concat(n))},onplay:function(){a.tl.play(),t.resync(),C.a.ticker.add(t.updateProgress),t.startAnimationLoop(),Ae.dispatch((function(e){e({type:"PLAY_CHART_AUDIO"})}))},onpause:function(){a.tl.pause(),C.a.ticker.remove(t.updateTimeline),C.a.ticker.remove(t.updateProgress),t.stopAnimationLoop(),Ae.dispatch((function(e){e({type:"PAUSE_CHART_AUDIO"})}))},onseek:function(){},onstop:function(){a.tl&&a.tl.restart().pause(),C.a.ticker.remove(t.updateTimeline),C.a.ticker.remove(t.updateProgress),t.stopAnimationLoop(),Ae.dispatch((function(e){e({type:"STOP_CHART_AUDIO"})}))},onend:function(e){a.tl&&a.tl.pause(),C.a.ticker.remove(t.updateTimeline),C.a.ticker.remove(t.updateProgress),t.stopAnimationLoop(),Ae.dispatch((function(e){e({type:"STOP_CHART_AUDIO"})}))}});var r=this.sources.preview[e.hash]={title:e.title};r.audio=new K.Howl({src:"https://dl.dropboxusercontent.com/s/".concat(e.dAudioUrl),format:["mp3"],html5:!0,sprite:{sample:[parseFloat(1e3*(e.sampleStart-.07)),parseFloat(1e3*(e.sampleLength-.07))]},onload:function(){},onplay:function(){r.audio.volume(1);t.previewFadeTimeout=setTimeout((function(){r.audio.fade(1,0,2e3)}),1e3*e.sampleLength-2e3),Ae.dispatch((function(e){e({type:"PLAY_PREVIEW_AUDIO"})}))},onstop:function(){clearTimeout(t.previewFadeTimeout),t.currentPreviewId=null,Ae.dispatch((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))},onend:function(){clearTimeout(t.previewFadeTimeout),t.currentPreviewId=null,Ae.dispatch((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))}})}}},{key:"selectSong",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.currentSong&&this.getCurrentSong().audio.stop(this.currentSongId),this.storeAudioSource(e,t),this.currentSong=e.hash}},{key:"resync",value:function(){this.audioReloadFrames=0,this.audioResyncFrames=10,C.a.ticker.add(this.updateTimeline)}},{key:"updateTimeline",value:function(){var e=this.getCurrentSong();if(e.tl&&e.globalParams){var t=!1;try{var n=this.getCurrentTime();"number"===typeof n?(t=!0,e.tl.seek(n+.07),this.updateProgressOnce(),"playing"===this.getChartAudioStatus()&&e.tl.play(),this.audioResyncFrames--):(e.tl.pause(),this.audioReloadFrames++)}catch(i){}if(t&&this.audioResyncFrames<=0){var a=function(e){for(var t=e.beatTick,n=e.bpmChangeQueue,a=0,r=0;r<n.length;r++){var o=n[r];if(o.beat>t)return a;a=o.value}return a}(e.globalParams);Ae.dispatch(re(a));var r=_(e),o=document.querySelector("#combo-temp .combo-num");o&&(o.textContent=r),C.a.ticker.remove(this.updateTimeline)}}}},{key:"seekTime",value:function(e){this.getCurrentSong().audio.seek(e),this.resync()}},{key:"goBack",value:function(e){this.seekTime(this.getCurrentTime()-.001*e)}},{key:"goForward",value:function(e){this.seekTime(this.getCurrentTime()+.001*e)}},{key:"seekProgress",value:function(e){var t=this.getCurrentSong().audio.duration();this.seekTime(e*t)}},{key:"updateProgress",value:function(e,t,n){var a=this.getCurrentSong();if(a&&a.tl){if(t>60){var r=this.getCurrentTime();console.log("frame skip","deltaTime:",t,"currentTime:",r),"number"===typeof r?a.tl.seek(r+.07):(console.log("audio unstable after frame skip, resyncing"),this.resync())}if(n%15===0){var o=performance.now(),i=a.audio,s=i.seek()/i.duration();performance.now();o=performance.now();a.tl.progress(),performance.now();o=performance.now(),de(s),_e.render(s),performance.now()}}}},{key:"updateProgressOnce",value:function(){this.updateProgress(null,null,0);var e=this.getCurrentSong(),t=_(e);j("FC: ".concat(function(e){var t=e.globalParams.arrows;if(!t.length)return 0;for(var n=t.length-1;n>=0;n--){var a=t[n];if(a.combo)return a.combo}return 0}(e))),e.globalParams.combo=t,this.updateAnimationLoopOnce()}},{key:"setTimeline",value:function(e){this.getCurrentSong().tl=e}},{key:"setGlobalParams",value:function(e){this.getCurrentSong().globalParams=e}},{key:"play",value:function(){if("pending"!==this.getChartAudioStatus()){var e,t=this.getCurrentSong();this.currentSongId=t.audio.play(),j("last played: ".concat(t.title),2),Ae.dispatch((e="pending",function(t){t({type:"SET_CHART_AUDIO_STATUS",payload:e})}))}}},{key:"pause",value:function(){this.getCurrentSong().audio.pause(this.currentSongId);var e=this.getCurrentSong().audio,t=e.seek()/e.duration();de(t)}},{key:"stop",value:function(){this.getCurrentSong()&&(this.getCurrentSong().audio.stop(this.currentSongId),this.seekTime(0),this.currentSongId=null)}},{key:"killImmediately",value:function(e){var t=this.sources.song[e];t&&(t.tl&&this.sources.song[e].tl.kill(),this.stop())}},{key:"isPlaying",value:function(){return this.getCurrentSong()&&this.getCurrentSong().audio.playing(this.currentSongId)}},{key:"isPaused",value:function(){return this.getCurrentSong()&&!this.getCurrentSong().audio.playing(this.currentSongId)}},{key:"playAssistTick",value:function(){this.sources.assistTick.audio.play()}},{key:"playSongPreview",value:function(e){if("pending"!==this.getPreviewAudioStatus()){this.currentPreview&&this.getCurrentPreview().audio.stop(this.currentPreviewId),this.storeAudioSource(e),this.currentPreview=e.hash;var t,n=this.getCurrentPreview().audio;this.currentPreviewId=n.play("sample"),Ae.dispatch((t="pending",function(e){e({type:"SET_PREVIEW_AUDIO_STATUS",payload:t})}))}}},{key:"stopSongPreview",value:function(){this.currentPreview&&this.getCurrentPreview().audio.stop(this.currentPreviewId)}},{key:"isPreviewPlaying",value:function(){return this.getCurrentPreview()&&this.getCurrentPreview().audio.playing(this.currentPreviewId)}},{key:"getChartAudioStatus",value:function(){return Ae.getState().audio.chartAudio.status}},{key:"getPreviewAudioStatus",value:function(){return Ae.getState().audio.previewAudio.status}}]),e}());function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sm",r=arguments.length>3?arguments[3]:void 0;Object(P.a)(this,e);this.canvas=t,this.c=t.getContext("2d"),this.sm=n,this.simfiles={},this.tl=C.a.timeline(),this.eventList=[],this.arrows=[],this.shockArrows=[],this.allArrows=[],this.mainLoopRequestRef=null,this.drawBackground(),this.globalParams={beatTick:0,frame:0,combo:0,bpmChangeQueue:[],arrows:this.allArrows,targetFlashes:{}},Ne.startAnimationLoop=this.startLoop.bind(this),Ne.stopAnimationLoop=this.stopLoop.bind(this),Ne.updateAnimationLoopOnce=this.updateLoopOnce.bind(this),this.sm&&(this.simfiles=J(this.sm,a),console.log("this.simfiles",this.simfiles),this.resetChart(r))}return Object(k.a)(e,[{key:"resetChart",value:function(e){var t=e.mode,n=e.difficulty,a=e.mods,r=Ae.getState().audio;this.tl&&this.tl.kill(),this.tl=C.a.timeline(),this.eventList.length=0,this.arrows.length=0,this.shockArrows.length=0,this.allArrows.length=0,this.globalParams.beatTick=0,this.globalParams.frame=0,this.globalParams.combo=0,this.globalParams.bpmChangeQueue=[],this.globalParams.arrows=this.allArrows,this.globalParams.targetFlashes={},Ne.setGlobalParams(this.globalParams);var o=this.simfiles["".concat(t,"_").concat(n)];o&&(D(o),this.generateEventList(o),this.generateArrows(o,a),this.initTimeline(a),this.restartTl(),"playing"!==r.chartAudio.status&&this.pauseTl(),Ne.resync())}},{key:"startLoop",value:function(){this.mainLoopRequestRef=window.requestAnimationFrame(this.mainLoop.bind(this))}},{key:"stopLoop",value:function(){window.cancelAnimationFrame(this.mainLoopRequestRef)}},{key:"updateLoopOnce",value:function(){window.requestAnimationFrame(this.mainLoop.bind(this,!1))}},{key:"generateEventList",value:function(e){for(var t=e.bpms,n=e.stops,a=[],r=0,o=0,i=t[0].value;r<t.length&&o<n.length;){var s=t[r],c=n[o];c.beat<=s.beat?(a.push(xe({},c,{bpm:i,type:"stop"})),o++):(a.push(xe({},s,{type:"bpm"})),i=s.value,r++)}for(;r<t.length;)a.push(xe({},t[r],{type:"bpm"})),r++;for(;o<n.length;)a.push(xe({},n[o],{bpm:i,type:"stop"})),o++;a[0].timestamp=0,this.globalParams.bpmChangeQueue=[a[0]];for(var l=1;l<a.length;l++){var u=a[l-1],d=a[l],f=a[l-1].timestamp,m=(d.beat-u.beat)/("bpm"===u.type?u.value:u.bpm)*60;"stop"===u.type&&(m+=u.value);var p=f+m;d.timestamp=p,"bpm"===d.type&&this.globalParams.bpmChangeQueue.push(d)}return this.eventList=a,a}},{key:"generateArrows",value:function(e,t){var n=this,a=e.chart,r=Ae.getState().songSelect.mode;if(Array.isArray(a[0])){var o=[];a.forEach((function(e){o.push.apply(o,Object(E.a)(e))})),a=o}(a=function(e,t,n){var a=t.turn,r=t.shuffle,o={off:"LDUR",mirror:"RUDL",left:"ULRD",right:"DRLU",shuffle1:"LRDU",shuffle2:"UDRL",shuffle3:"LRUD",shuffle4:"DURL",shuffle5:"DLUR",shuffle6:"DULR",shuffle7:"RLUD",shuffle8:"RULD"},i=a;return"shuffle"===a&&(i+=r),"single"===n?e.map((function(e){var t=e.note;return A({},e,{note:o[i].split("").map((function(e){return t[o.off.indexOf(e)]}))})})):"double"===n?e.map((function(e){var t=e.note.split("");return"mirror"===a&&(t=t.reverse()),A({},e,{note:t})})):void 0}(a,t,r)).forEach((function(e,t){var n=e.measureIdx,r=e.measureN,o=e.measureD;e.currentBeatPosition=4*(n+r/o),e.originalBeatPosition=e.currentBeatPosition;for(var i=0;i<e.note.length;i++)if("3"===e.note[i])for(var s=t-1;s>=0;s--)if("2"===a[s].note[i]){a[s].holdBeats||(a[s].holdBeats=[]),e.holdBeats||(e.holdBeats=[]),a[s].holdBeats[i]=e.currentBeatPosition-a[s].currentBeatPosition,e.holdBeats[i]=e.currentBeatPosition-a[s].currentBeatPosition;break}})),a.forEach((function(e,t){if("M"===e.note[0]||"M"===e.note[4]){var a=new I(xe({key:t},e));n.shockArrows.push(a),n.allArrows.push(a)}if(e.note.includes("1")||e.note.includes("2")||e.note.includes("3")){var r=new x(xe({key:t},e));n.arrows.push(r),n.allArrows.push(r)}})),this.stepZone=new V,this.comboDisplay=new Z,this.laneCover=new q}},{key:"initTimeline",value:function(e){var t,n=this,a=0,r=this.arrows[this.arrows.length-1],o=this.eventList[this.eventList.length-1],i=0;r&&o?i=Math.max(r.originalBeatPosition,o.beat):r?i=r.originalBeatPosition:o&&(i=o.beat),i+=8;for(var s=function(e){var r=n.eventList[e],o=n.eventList[e+1],s="stop"===r.type?r.value:0;if("bpm"===r.type?t=r.value:"stop"===r.type&&(t=r.bpm),o){var c=o.beat-r.beat,l=c/t*60;n.tl=n.tl.to(n.globalParams,{beatTick:a+c,duration:l,ease:"none",onStart:function(){"bpm"===r.type&&Ae.dispatch(re(r.value))}},"+=".concat(s)),a+=c}else n.tl=n.tl.to(n.globalParams,{beatTick:i,duration:(i-a)/t*60,ease:"none",onStart:function(){"bpm"===r.type&&Ae.dispatch(re(r.value))}},"+=".concat(s))},c=0;c<this.eventList.length;c++)s(c);var l=this.globalParams.bpmChangeQueue;this.comboArrows=[];var u=-1,d=0,f=-1,m=null,p=null,h=0,v=0;this.allArrows.forEach((function(e,t){for(;u<l.length-1&&l[u+1].beat<e.originalBeatPosition;){u++;var a=l[u];m=a.value,h=0;for(var r=d;r<n.eventList.length;r++){var o=n.eventList[r];if(o.beat===a.beat&&"bpm"===o.type){d=r;var i=n.eventList[r+1];i&&"stop"===i.type?(f=r+1,p=n.eventList[f]):p=null;break}}}for(;p&&p.beat<e.originalBeatPosition;){h+=p.value;var s=n.eventList[f+1];s&&"stop"===s.type?f++:f=-1,p=n.eventList[f]}var c=l[u].beat,g=l[u].timestamp+(e.originalBeatPosition-c)*(60/m)+h;if(e.note.includes("1")||e.note.includes("2")||e.note.includes("M")){v++,e.combo=v,e.timestamp=g,n.comboArrows.push(e);var b=document.querySelector("#combo-temp .combo-num");n.tl.set(n.globalParams,{onStart:function(){b&&(b.textContent=e.combo),n.globalParams.combo=e.combo,e instanceof x&&(n.globalParams.targetFlashes[e.originalBeatPosition]=new H(e))}},g-.008)}else e.note.includes("3")&&n.tl.set(n.globalParams,{onStart:function(){n.globalParams.targetFlashes[e.originalBeatPosition]=new H(e)}},g-.008)})),this.guidelines=new F(i),Ne.setTimeline(this.tl),this.updateLoopOnce()}},{key:"mainLoop",value:function(){var e,t,n=this,a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e=performance.now(),this.drawBackground(),t=performance.now();var r=Ae.getState(),o=r.songSelect,i=r.mods,s=o.mode;this.stepZone&&"off"!==i.stepZone&&(e=performance.now(),this.stepZone.render(this.canvas,this.globalParams.beatTick,{mode:s,mods:i}),t=performance.now()),this.guidelines&&(e=performance.now(),this.guidelines.render(this.canvas,this.globalParams.beatTick,{mods:i}),t=performance.now()),"behind"===i.comboDisplay&&this.comboDisplay.render(this.canvas,this.globalParams.combo,{mode:s,mods:i}),e=performance.now();for(var c=this.shockArrows.length-1;c>=0;c--){var l=this.shockArrows[c];l.render(this.canvas,this.globalParams.frame,this.globalParams.beatTick,{mods:i})}t=performance.now();var u="double"===s?[2,6]:[2],d="double"===s?[0,1,3,4,5,7]:[0,1,3];e=performance.now();for(var f=function(e){var t=n.arrows[e];d.forEach((function(e){t.renderFreezeBody(n.canvas,n.globalParams.beatTick,e,{mods:i})}))},m=this.arrows.length-1;m>=0;m--)f(m);t=performance.now();parseFloat((t-e).toFixed(3));e=performance.now();for(var p=function(e){var t=n.arrows[e];u.forEach((function(e){t.renderFreezeBody(n.canvas,n.globalParams.beatTick,e,{mods:i})}))},h=0;h<this.arrows.length;h++)p(h);t=performance.now(),parseFloat((t-e).toFixed(3)),e=performance.now();for(var v=function(e){var t=n.arrows[e];d.forEach((function(e){t.renderArrow(n.canvas,n.globalParams.beatTick,e,{mods:i})}))},g=this.arrows.length-1;g>=0;g--)v(g);t=performance.now();parseFloat((t-e).toFixed(3));e=performance.now();for(var b=function(e){var t=n.arrows[e];u.forEach((function(e){t.renderArrow(n.canvas,n.globalParams.beatTick,e,{mods:i})}))},y=0;y<this.arrows.length;y++)b(y);for(var w in t=performance.now(),parseFloat((t-e).toFixed(3)),"inFront"===i.comboDisplay&&this.comboDisplay.render(this.canvas,this.globalParams.combo,{mode:s,mods:i}),["hidden","sudden","hiddensudden"].includes(i.appearance)&&i.laneCoverVisible&&this.laneCover.render(this.canvas,{mode:s,mods:i}),e=performance.now(),this.globalParams.targetFlashes){var O=this.globalParams.targetFlashes[w];O.frame++,O.frame>12?delete this.globalParams.targetFlashes[w]:O.render(this.canvas,{mods:i})}t=performance.now(),this.globalParams.frame++,a&&(this.mainLoopRequestRef=window.requestAnimationFrame(this.mainLoop.bind(this)))}},{key:"drawBackground",value:function(){this.c.fillStyle="black",this.c.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"restartTl",value:function(){this.tl.restart()}},{key:"pauseTl",value:function(){this.tl.pause()}},{key:"isTlPaused",value:function(){return this.tl.paused()}}]),e}(),Ie=n(428),Me=n(426),Be=n(418),Ve=n(206),Fe=n.n(Ve),Ue={Beginner:"b",Basic:"B",Difficult:"D",Expert:"E",Challenge:"C"},He={single:"S",double:"D"},ze=function(e){var t=e.modalOpen,n=e.setModalOpen,o=e.data,i=o.song,s=o.difficulty,c=o.mode,l=o.mods,u=Object(a.useRef)(),f=Object(a.useState)(""),m=Object(d.a)(f,2),p=m[0],h=m[1];if(Object(a.useEffect)((function(){!1===t&&h("")}),[t]),!i)return null;u.current=function(){var e=_e.getProgress(),t={song:i.hash,difficulty:Ue[s]+He[c]+"P",turn:"off"!==l.turn?l.turn:"",speed:l.speed.toString().replace(".",""),progress:parseInt(1e5*e)},n=Object.keys(t).map((function(e){return null===t[e]||"undefined"===typeof t[e]?null:"".concat(e,"=").concat(t[e])})).filter((function(e){return null!==e})).join("&");return v()+"?"+n}();return r.a.createElement(Ie.a,{className:"shareModal",size:"fullscreen",open:t,onClose:function(){return n(!1)}},r.a.createElement(Ie.a.Header,null,"Share link to chart"),r.a.createElement(Ie.a.Content,null,r.a.createElement(Me.a,{type:"text",className:"share-url-input",value:u.current,action:!0},r.a.createElement("input",null),r.a.createElement(Be.a,{onClick:function(){Fe()(u.current),h("Copied link to clipboard")}},"Copy")),r.a.createElement("p",null,p)))},Ze=n(56);function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Ye=function(e){var t=Object(a.useRef)(),n=Object(a.useRef)(),o=Object(a.useRef)(),i=Object(a.useRef)(),s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);delete s.onClick,Object(a.useEffect)((function(){var e=t.current.ref.current;e.removeEventListener("mousedown",o.current,!1),e.removeEventListener("mouseup",i.current,!1),e.removeEventListener("mouseleave",i.current,!1),e.removeEventListener("touchstart",o.current,!1),e.removeEventListener("touchend",i.current,!1),o.current=c,i.current=l,e.addEventListener("mousedown",o.current,!1),e.addEventListener("mouseup",i.current,!1),e.addEventListener("mouseleave",i.current,!1),e.addEventListener("touchstart",o.current,!1),e.addEventListener("touchend",i.current,!1)}),[e.onClick]);var c=function(t){t.preventDefault(),e.onClick&&e.onClick(t),n.current=requestAnimationFrame(u.bind(null,t))},l=function(e){e.preventDefault(),cancelAnimationFrame(n.current)},u=function t(a){e.onClick&&e.onClick(a),n.current=requestAnimationFrame(t.bind(null,a))};return r.a.createElement(Be.a,Object.assign({},s,{ref:t}),e.children)},qe=Object(s.b)((function(e){return{audio:e.audio.chartAudio}}),null)((function(e){var t=e.audio,n=e.controlsDisabled,a=e.setShareModalOpen;return r.a.createElement("div",{className:"play-controls"},r.a.createElement(Ye,{onClick:function(){return Ne.goBack(20)},className:"play-control"},r.a.createElement(Ze.a,{name:"backward"})),r.a.createElement(Be.a,{onClick:function(){n||("playing"===e.audio.status?Ne.pause():Ne.play())},disabled:n,className:"play-control"},r.a.createElement(Ze.a,{name:"playing"===t.status?"pause":"play"})),r.a.createElement(Be.a,{onClick:function(){n||Ne.stop()},className:"play-control"},r.a.createElement(Ze.a,{name:"stop"})),r.a.createElement(Ye,{onClick:function(){return Ne.goForward(20)},className:"play-control"},r.a.createElement(Ze.a,{name:"forward"})),r.a.createElement(Be.a,{onClick:function(){return a(!0)},className:"play-control share-btn",disabled:"playing"===t.status},r.a.createElement(Ze.a,{name:"share square"})))})),We=Object(s.b)((function(e){var t=e.chart,n=e.songSelect;return{chart:t,selectedSong:n.song,selectedDifficulty:n.difficulty,selectedMode:n.mode}}),null)((function(e){var t=e.chart,n=e.selectedSong,a=e.selectedDifficulty,o=e.selectedMode;return r.a.createElement("div",{className:"song-info-row"},r.a.createElement("div",{className:"song-information"},n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"song-title"},n.title),r.a.createElement("div",{className:"song-artist"},n.artist))),r.a.createElement("div",{className:"bpm-information"},r.a.createElement("div",{className:"bpm-header"},"BPM"),r.a.createElement("div",{className:"bpm-value"},t.activeBpm)),r.a.createElement("div",{className:"level-information"},n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"song-difficulty"},a),r.a.createElement("div",{className:"song-level"},n.levels["double"===o?h.indexOf(a)+5:p.indexOf(a)]))))})),Ge=Object(s.b)(null,(function(e){return{updateMods:function(t){return e(ce(t))},updateLaneCoverHeight:function(t){return e((n=t,function(e){e({type:"UPDATE_LANE_COVER_HEIGHT",payload:n})}));var n}}}))((function(e){var t=e.canvas,n=e.mods,o=e.updateMods,i=e.updateLaneCoverHeight,s=Object(a.useRef)(),c=function(e){if((38===e.keyCode||40===e.keyCode)&&(e.preventDefault(),["hidden","sudden","hiddensudden"].includes(n.appearance))){var a=[0,0,0],r="reverse"===n.scroll?-1:1;if(38===e.keyCode)switch(n.appearance){case"hidden":a[0]-=4*r;break;case"sudden":a[1]+=4*r;break;case"hiddensudden":a[2]+=4}else if(40===e.keyCode)switch(n.appearance){case"hidden":a[0]+=4*r;break;case"sudden":a[1]-=4*r;break;case"hiddensudden":a[2]-=4}i({diff:a,canvasHeight:t.height})}};return Object(a.useEffect)((function(){document.removeEventListener("keydown",s.current),s.current=c,document.addEventListener("keydown",s.current)}),[n.appearance,n.scroll,n.laneCoverHeight,t]),r.a.createElement("div",{className:"cab-buttons-container"},r.a.createElement(Ye,{className:"directional-button",onClick:function(e){e.keyCode=38,c(e)}},r.a.createElement("img",{src:b("directional_button.png")})),r.a.createElement(Be.a,{className:"center-button",onClick:function(e){!function(e){e.preventDefault();var t=n.laneCoverVisible;o({laneCoverVisible:!t})}(e)}},r.a.createElement("img",{src:b("center_button.png")})),r.a.createElement(Ye,{className:"directional-button",onClick:function(e){e.keyCode=40,c(e)}},r.a.createElement("img",{src:b("directional_button.png")})))})),Qe=Object(s.b)((function(e){var t=e.mods,n=e.songSelect,a=e.screen;return{mods:t,selectedSong:n.song,selectedDifficulty:n.difficulty,selectedMode:n.mode,screen:a}}),(function(e){return{}}))((function(e){var t=e.selectedDifficulty,n=e.selectedMode,o=e.selectedSong,i=e.sm,s=e.mods,c=e.screen,l=e.loadingAudio,u=e.gameEngine,f=e.setGameEngine,m=Object(a.useState)(null),p=Object(d.a)(m,2),h=p[0],v=p[1],g=Object(a.useState)(!1),b=Object(d.a)(g,2),w=b[0],E=b[1],S=Object(a.useRef)(),P=Object(a.useRef)(),k=Object(a.useRef)(),C=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e})),t.current||e}({canvas:h,sm:i,selectedDifficulty:t,selectedMode:n,mods:s});Object(a.useEffect)((function(){S.current=document.querySelector("#chartArea"),v(S.current),_e.initCanvas()}),[]),Object(a.useEffect)((function(){h&&P.current&&j()}),[h,n,c]);var j=function(){if("single"===n)S.current.width=256,S.current.style.transform="none",S.current.style.position="relative",S.current.style.left=0,S.current.style.top=0;else if("double"===n){S.current.width=512;var e=P.current.getBoundingClientRect();if(e.width<512){var t=e.width/S.current.width,a=(S.current.width-e.width)/2,r=a*(7/8);S.current.style.transform="scale(".concat(t,") translate(-50%)"),S.current.style.position="absolute",S.current.style.left="-".concat(a,"px"),S.current.style.top="-".concat(r,"px")}else S.current.style.transform="none",S.current.style.position="relative",S.current.style.left=0,S.current.style.top=0}u&&u.updateLoopOnce()};Object(a.useEffect)((function(){var e={canvas:h,sm:i,selectedDifficulty:t,selectedMode:n,mods:s};if(h){var a={mode:n,difficulty:t,mods:s};Object.keys(e).forEach((function(t){if(C[t]!==e[t])if("canvas"===t);else if("sm"===t){var n=o.useSsc?"ssc":"sm",r=new Re(h,i,n,a);r.pauseTl(),f(r)}else"mods"===t?Object.keys(C.mods).forEach((function(t){var n=JSON.stringify(C.mods[t]),r=JSON.stringify(e.mods[t]);u&&n!==r&&(["turn","shuffle"].includes(t)?u.resetChart(a):u.isTlPaused()&&u.updateLoopOnce())})):u&&u.resetChart(a)}))}}),[h,i,t,n,s]);var D={song:o,difficulty:t,mode:n,mods:s};return r.a.createElement("div",{className:"view-section chartView ".concat("chart"===c.activeView?"active":"")},r.a.createElement("div",{className:"view-wrapper chartArea-container"},r.a.createElement("div",{className:"canvas-container ".concat(n),ref:P},r.a.createElement("div",{className:"canvas-wrapper"},r.a.createElement("canvas",{id:"chartArea",width:"256",height:"448"}),r.a.createElement("div",{className:"chart-loading-screen ".concat(n," ").concat(l?"loading":""," "),ref:k},o&&r.a.createElement("img",{className:"chart-loading-jacket",src:y("".concat(o.hash,".png"))}),r.a.createElement("div",{className:"chart-loading-message"},"Loading chart...")),o&&!l&&["hidden","sudden","hiddensudden"].includes(s.appearance)&&r.a.createElement(Ge,{mods:s,canvas:h}))),r.a.createElement("div",{className:"progress-container"},r.a.createElement("div",{className:"progress-wrapper"},r.a.createElement("canvas",{id:"progress"}),O.progress?r.a.createElement("div",{className:"preset-marker-wrapper",onClick:_e.jumpToPresetStart.bind(_e),onTouchStart:_e.jumpToPresetStart.bind(_e)},r.a.createElement("div",{className:"preset-marker"})):null)),r.a.createElement("div",{className:"row"},r.a.createElement(qe,{controlsDisabled:!u||l,setShareModalOpen:E})),r.a.createElement("div",{className:"row"},r.a.createElement(We,null)),r.a.createElement(ze,{modalOpen:w,setModalOpen:E,data:D})))})),Je=n(429),Ke=n(218),$e=function(e,t,n){var a="double"===n?h:p,r="double"===n?e.levels.slice(5,9):e.levels.slice(0,5);if(["Difficult","Expert","Challenge"].includes(t)){for(var o=a.length-1;o>=0;o--)if(r[o])return a[o]}else if(["Beginner","Basic"].includes(t))for(var i=0;i<=a.length-1;i++)if(r[i])return a[i]},et=function(e){var t=e.displayedSongs,n=e.onSongSelect,a=e.selectedSongOption,o=e.selectedMode,i=e.selectedDifficultyOption,s=e.selectedFilters,c=t,l=function(e){return r.a.createElement("div",{className:"songTile-wrapper",key:"songtile_".concat(e.hash),onClick:function(){return function(e){n(null,{value:e.hash})}(e)}},r.a.createElement("div",{className:"songTile ".concat(a===e.hash?"selected":"")},r.a.createElement("div",{className:"song-jacket-wrapper"},r.a.createElement("img",{className:"song-jacket",src:y("".concat(e.hash,".png")),title:e.title,alt:e.title})),r.a.createElement("div",{className:"song-level-wrapper"},function(e){var t=[];"single"===o?t=e.levels.slice(0,5):"double"===o&&(t=[null].concat(Object(E.a)(e.levels.slice(5,9))));var n=s.level,a=s.difficulty;if("all"===a&&"all"===n){var c=[null,null,null,null,null],l=p.indexOf(i);if(t[l])c[l]=t[l];else{var u=$e(e,i,o),d=p.indexOf(u);c[d]=t[d]}t=c}else t.forEach((function(e,r){if(e){var o=p[r];"all"===a?e!==n&&(t[r]=null):o!==a&&(t[r]=null)}}));return t.map((function(t,n){if(!t)return null;var a=p[n];return r.a.createElement("div",{key:"".concat(e.hash,"_").concat(a),className:"song-level ".concat(a)},t)}))}(e)),r.a.createElement("div",{className:"song-title-bar"},e.title)))};return r.a.createElement("div",{className:"songGrid"},c.map((function(e){return l(e)})))},tt={lastRequestedSong:null,lastRequestedSongLoaded:!1},nt=function(e){var t=e.option1,n=e.option2,a=e.value,o=e.disabled,i=function(t){!o&&t&&"undefined"!==typeof t.value&&e.onChange(t.value)};return r.a.createElement("div",{className:"toggleSwitch-wrapper ".concat(o?"disabled":"")},r.a.createElement("label",{className:"toggleSwitch-option1 ".concat(a===t.value?"selected":""),onClick:function(){return i(t)}},t.text),r.a.createElement("div",{className:function(){var e="toggleSwitch";return a===t.value?e+=" left":a===n.value&&(e+=" right"),e}(),onClick:function(){!o&&t&&n&&(a===t.value?e.onChange(n.value):(n.value,e.onChange(t.value)))}}),r.a.createElement("label",{className:"toggleSwitch-option2 ".concat(a===n.value?"selected":""),onClick:function(){return i(n)}},n.text))},at=[{key:"title_all",value:"all",text:"ALL"}].concat(["\u3042","\u304b","\u3055","\u305f","\u306a","\u306f","\u307e","\u3084","\u3089","\u308f","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","NUM"].map((function(e){return{key:"title_".concat(e),value:e,text:e}}))),rt=[{key:"version_all",value:"all",text:"ALL"}].concat(["DDR 1st","DDR 2ndMIX","DDR 3rdMIX","DDR 4thMIX","DDR 5thMIX","DDRMAX","DDRMAX2","DDR EXTREME","DDR SuperNOVA","DDR SuperNOVA 2","DDR X","DDR X2","DDR X3 VS 2ndMIX","DDR (2013)","DDR (2014)","DDR A","DDR A20"].map((function(e,t){return{key:"version_".concat(t),value:t,text:e}})).reverse()),ot=[{key:"level_all",value:"all",text:"ALL"}].concat([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19].map((function(e){return{key:"level_".concat(e),value:e,text:e}}))),it=[{key:"difficulty_all",value:"all",text:"ALL"}].concat(p.map((function(e){return{key:"difficulty_".concat(e),value:e,text:e}})));function st(){return(st=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ct(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var lt=r.a.createElement("path",{id:"Line_1","data-name":"Line 1",d:"M0.91,15L0.78,15A1,1,0,0,0,0,16v6a1,1,0,1,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H0.91Z"}),ut=r.a.createElement("path",{id:"Line_2","data-name":"Line 2",d:"M6.91,9L6.78,9A1,1,0,0,0,6,10V28a1,1,0,1,0,2,0s0,0,0,0V10A1,1,0,0,0,7,9H6.91Z"}),dt=r.a.createElement("path",{id:"Line_3","data-name":"Line 3",d:"M12.91,0L12.78,0A1,1,0,0,0,12,1V37a1,1,0,1,0,2,0s0,0,0,0V1a1,1,0,0,0-1-1H12.91Z"}),ft=r.a.createElement("path",{id:"Line_4","data-name":"Line 4",d:"M18.91,10l-0.12,0A1,1,0,0,0,18,11V27a1,1,0,1,0,2,0s0,0,0,0V11a1,1,0,0,0-1-1H18.91Z"}),mt=r.a.createElement("path",{id:"Line_5","data-name":"Line 5",d:"M24.91,15l-0.12,0A1,1,0,0,0,24,16v6a1,1,0,0,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H24.91Z"}),pt=r.a.createElement("path",{id:"Line_6","data-name":"Line 6",d:"M30.91,10l-0.12,0A1,1,0,0,0,30,11V27a1,1,0,1,0,2,0s0,0,0,0V11a1,1,0,0,0-1-1H30.91Z"}),ht=r.a.createElement("path",{id:"Line_7","data-name":"Line 7",d:"M36.91,0L36.78,0A1,1,0,0,0,36,1V37a1,1,0,1,0,2,0s0,0,0,0V1a1,1,0,0,0-1-1H36.91Z"}),vt=r.a.createElement("path",{id:"Line_8","data-name":"Line 8",d:"M42.91,9L42.78,9A1,1,0,0,0,42,10V28a1,1,0,1,0,2,0s0,0,0,0V10a1,1,0,0,0-1-1H42.91Z"}),gt=r.a.createElement("path",{id:"Line_9","data-name":"Line 9",d:"M48.91,15l-0.12,0A1,1,0,0,0,48,16v6a1,1,0,1,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H48.91Z"}),bt=function(e){var t=e.svgRef,n=e.title,a=ct(e,["svgRef","title"]);return r.a.createElement("svg",st({id:"audioWave","data-name":"Layer 1",viewBox:"0 0 50 38.05",ref:t},a),n?r.a.createElement("title",null,n):null,lt,ut,dt,ft,mt,pt,ht,vt,gt)},yt=r.a.forwardRef((function(e,t){return r.a.createElement(bt,st({svgRef:t},e))}));n.p;function wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Ot=le(),Et=Object(s.b)((function(e){var t=e.audio,n=e.songSelect,a=e.screen;return{previewAudio:t.previewAudio,selectedDifficulty:n.difficulty,selectedMode:n.mode,previousSong:n.song,activeView:a.activeView}}),(function(e){return{selectSong:function(t){return e(ke(t))}}}))((function(e){var t=e.simfileList,n=e.selectedDifficulty,o=e.selectedMode,i=e.previewAudio,s=Object(a.useRef)(),c=t.map((function(e){return{key:e.hash,value:e.hash,text:e.title}})),f=Object(a.useState)(null),m=Object(d.a)(f,2),v=m[0],g=m[1],b=Object(a.useState)(n),w=Object(d.a)(b,2),E=w[0],P=w[1],k=Object(a.useState)(Ot.filters||{title:"all",version:15,level:"all",difficulty:"all"}),C=Object(d.a)(k,2),j=C[0],D=C[1],L=function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},j,{},e);ue({filters:t}),D(t)},A=Object(a.useState)([]),_=Object(d.a)(A,2),N=_[0],T=_[1];Object(a.useEffect)((function(){var e=j.title,n=j.version,a=j.level,r=j.difficulty,i=t.filter((function(t){var r=t.levels.slice(0,5),i=t.levels.slice(5,9);return("all"===e||e===t.abcSort)&&("all"===n||n===parseInt(t.version))&&("all"===a&&"single"===o&&r.some((function(e){return!!e}))||"all"===a&&"double"===o&&i.some((function(e){return!!e}))||"single"===o&&t.levels.slice(0,5).includes(a)||"double"===o&&t.levels.slice(5,9).includes(a))})).filter((function(e){if("all"!==r)if("all"===a){if("single"===o)return null!==e.levels[p.indexOf(r)];if("double"===o)return null!==e.levels[h.indexOf(r)+5]}else{if("single"===o)return e.levels[p.indexOf(r)]===a;if("double"===o)return e.levels[h.indexOf(r)+5]===a}return e}));T(i),s.current.scrollTop=0}),[j,o]);var x=Object(a.useState)(null),R=Object(d.a)(x,2),I=R[0],M=R[1];Object(a.useEffect)((function(){document.body.click(),O.song?B(null,{value:O.song}):Ot.song?B(null,{value:Ot.song}):B(null,{value:"08QP8bOQ6OOdd11Dq81db1l8IdiDbod6"})}),[]),Object(a.useEffect)((function(){if(v){var e=t.find((function(e){return e.hash===v}));M(e),Ne.storeAudioSource(e)}}),[v]);var B=function(){var n=Object(u.a)(l.a.mark((function n(a,r){var i,s,c,u,d,f,m,v,b;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Ne.stopSongPreview(),I&&Ne.killImmediately(I.hash),i=r.value,g(i),s=t.find((function(e){return e.hash===i})),c=0,e.previousSong||(c=window.localStorage.getItem("progress")||0),O.song===i&&O.progress?c=O.progress/1e5:O.progress=0,n.next=10,e.onSongSelect(s,c);case 10:if(tt.lastRequestedSong===s.title){n.next=12;break}return n.abrupt("return");case 12:if(u=function(){var t,n=p.indexOf(E);t=s.levels[n]?E:$e(s,E,o),e.onDifficultySelect(t)},"all"!==j.level||"all"!==j.difficulty){n.next=17;break}u(),n.next=36;break;case 17:if("all"===j.level||"all"!==j.difficulty){n.next=35;break}if(!(d="double"===o?s.levels.slice(5,9):s.levels.slice(0,5)).includes(j.level)){n.next=32;break}f=0;case 21:if(!(f<d.length)){n.next=30;break}if(d[f]!==j.level){n.next=27;break}return m="double"===o?h:p,e.onDifficultySelect(m[f]),n.abrupt("break",30);case 27:f++,n.next=21;break;case 30:n.next=33;break;case 32:u();case 33:n.next=36;break;case 35:"all"!==j.difficulty&&"all"===j.level?(v=p.indexOf(j.difficulty),"double"===o&&(v+=4),"number"===typeof s.levels[v]?e.onDifficultySelect(j.difficulty):u()):"all"!==j.difficulty&&"all"!==j.level&&(b=p.indexOf(j.difficulty),"double"===o&&(b+=4),s.levels[b]===j.level?e.onDifficultySelect(j.difficulty):u());case 36:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();return r.a.createElement("div",{className:"view-section songView ".concat("song"===e.activeView?"active":"")},I&&r.a.createElement(Ke.a,null,r.a.createElement("title",null,I.title," - SMViewer"),r.a.createElement("meta",{property:"og:title",content:"".concat(I.title," - SMViewer")})),r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("form",{className:"songForm"},r.a.createElement("div",{className:"form-inner-wrapper"},r.a.createElement("div",{className:"selectedSong"},r.a.createElement("div",{className:"selectedSong-jacket-wrapper ".concat("playing"===i.status?"playing":"")},r.a.createElement("div",{className:"selectedSong-jacket-overlay"},r.a.createElement(yt,null)),r.a.createElement("img",{className:"selectedSong-jacket",src:y("".concat(v,".png")),alt:"Selected song",onClick:function(){Ne.currentPreview===I.hash?"playing"===i.status?Ne.stopSongPreview():Ne.playSongPreview(I):("playing"===i.status&&Ne.stopSongPreview(),Ne.playSongPreview(I))}})),r.a.createElement("div",{className:"selectedSong-info"},r.a.createElement(Je.a,{placeholder:"Choose a song",className:"song-title-dropdown",search:!0,selection:!0,value:v,onChange:B,options:c,selectOnBlur:!1,selectOnNavigation:!1}),r.a.createElement("div",{className:"song-artist"},I&&I.artist),r.a.createElement("div",{className:"song-difficulties"},function(){return I?("single"===o?t=I.levels.slice(0,5):"double"===o&&(t=I.levels.slice(5,9)),t.map((function(t,a){if(!t)return null;var i="double"===o?h[a]:p[a];return r.a.createElement("div",{className:"song-difficulty ".concat(i," ").concat(n===i?"selected":""),key:"".concat(o,"-difficulty_").concat(i),onClick:function(){return function(t){P(t),e.onDifficultySelect(t)}(i)}},r.a.createElement("div",{className:"difficulty"},i),r.a.createElement("div",{className:"level"},t))}))):null;var t}()),r.a.createElement("div",{className:"song-mode"},r.a.createElement(nt,{option1:{text:"Single",value:"single"},option2:{text:"Double",value:"double"},onChange:function(t){e.onModeSelect(t)},value:o,disabled:!I||!o||"Beginner"===n||("single"===o?!I.levels.slice(5,9).filter((function(e){return e})).length:"double"!==o||!I.levels.slice(0,5).filter((function(e){return e})).length)})),r.a.createElement("div",{className:"bpm-display-container"},r.a.createElement("div",{className:"bpm-display-label"},"BPM"),r.a.createElement("div",{className:"bpm-display-value"},function(){if(!I)return null;var e=I.displayBpm;if(e.includes(",")){var t=p.indexOf(n);"double"===o&&(t+=4),e=e.split(",")[t]}return e}())))),r.a.createElement("div",{className:"songForm-filters"},r.a.createElement("div",{className:"songForm-filters-row"},r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Title"),r.a.createElement(Je.a,{className:"title-filter-dropdown",selection:!0,value:j.title,onChange:function(e,t){return L({title:t.value})},options:at})),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Version"),r.a.createElement(Je.a,{className:"version-filter-dropdown",selection:!0,value:j.version,onChange:function(e,t){return L({version:t.value})},options:rt})),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Level"),r.a.createElement(Je.a,{className:"level-filter-dropdown",selection:!0,value:j.level,onChange:function(e,t){return L({level:t.value})},options:ot}),r.a.createElement("label",null,"By Difficulty"),r.a.createElement(Je.a,{className:"difficulty-filter-dropdown",selection:!0,value:j.difficulty,onChange:function(e,t){return L({difficulty:t.value})},options:it})))))),r.a.createElement("div",{className:"songGrid-container",ref:s},r.a.createElement(et,{displayedSongs:N,onSongSelect:B,selectedSongOption:v,selectedMode:o,selectedDifficultyOption:E,selectedFilters:j}))))})),St=n(427),Pt=n(417),kt=Object(s.b)((function(e){var t=e.mods,n=e.songSelect,a=e.screen;return{mods:t,mode:n.mode,song:n.song,difficulty:n.difficulty,activeView:a.activeView}}),(function(e){return{updateMods:function(t){return e(ce(t))}}}))((function(e){var t=e.mods,n=e.updateMods,o=e.mode,i=e.song,s=e.difficulty;Object(a.useEffect)((function(){"double"!==o||["off","mirror"].includes(t.turn)||n({turn:"off"})}),[o]);return r.a.createElement("div",{className:"view-section modsView ".concat("mods"===e.activeView?"active":"")},r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("form",{className:"modsForm"},r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Speed",i&&r.a.createElement("span",{className:"form-sublabel"},"(Effective scroll speed:"," ",r.a.createElement("strong",null,function(){if(!i)return null;var e=i.displayBpm;if(e.includes(",")){var n=p.indexOf(s);"double"===o&&(n+=4),e=e.split(",")[n]}var a=e.split("-"),c=Object(d.a)(a,2),l=c[0],u=c[1];return u?r.a.createElement("strong",null,"".concat(Math.round(l*t.speed)," - ").concat(Math.round(u*t.speed))):r.a.createElement("strong",null,Math.round(l*t.speed))}()),")")),fe.mods.speed.map((function(e){return r.a.createElement(St.a,{key:"speed_".concat(e),label:"".concat(e,"x"),name:"speed",value:e,checked:t.speed===e,onChange:function(){return n({speed:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Appearance"),fe.mods.appearance.map((function(e,a){return r.a.createElement(St.a,{key:"appearance_".concat(e),label:["Visible","Hidden+","Sudden+","Hidden+ / Sudden+","Stealth"][a],name:"appearance",value:e,checked:t.appearance===e,onChange:function(){return n({appearance:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Arrow color"),fe.mods.noteskin.map((function(e){return r.a.createElement(St.a,{key:"noteskin_".concat(e),label:w(e),name:"noteskin",value:e,checked:t.noteskin===e,onChange:function(){return n({noteskin:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Turn"),fe.mods.turn.filter((function(e){return"double"!==o||("off"===e||"mirror"===e)})).map((function(e){return r.a.createElement(St.a,{key:"turn_".concat(e),label:w(e),name:"turn",value:e,checked:t.turn===e,onChange:function(){return n({turn:e})}})}))),"shuffle"===t.turn&&r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Shuffle pattern",r.a.createElement("span",{className:"form-sublabel"},"(compare to original LDUR)")),fe.mods.shuffle.map((function(e,a){return r.a.createElement(St.a,{key:"shuffle_".concat(e),label:["LRDU","UDRL","LRUD","DURL","DLUR","DULR","RLUD","RULD"][a],name:"shuffle",value:e,checked:t.shuffle===e,onChange:function(){return n({shuffle:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Step zone"),fe.mods.stepZone.map((function(e){return r.a.createElement(St.a,{key:"stepZone_".concat(e),label:w(e),name:"stepZone",value:e,checked:t.stepZone===e,onChange:function(){return n({stepZone:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Scroll"),fe.mods.scroll.map((function(e){return r.a.createElement(St.a,{key:"scroll_".concat(e),label:w(e),name:"scroll",value:e,checked:t.scroll===e,onChange:function(){return n({scroll:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Combo display"),fe.mods.comboDisplay.map((function(e,a){return r.a.createElement(St.a,{key:"comboDisplay_".concat(e),label:["Behind arrows","In front of arrows","Hidden"][a],name:"comboDisplay",value:e,checked:t.comboDisplay===e,onChange:function(){return n({comboDisplay:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Combo font"),fe.mods.comboFont.map((function(e){return r.a.createElement(St.a,{key:"comboFont_".concat(e),label:e,name:"comboFont",value:e,checked:t.comboFont===e,onChange:function(){return n({comboFont:e})}})}))),r.a.createElement("h4",null,"Miscellaneous"),r.a.createElement("div",{className:"form-field"},r.a.createElement(Pt.a,{toggle:!0,label:"Guidelines",name:"guidelines",checked:t.guidelines,onChange:function(){return n({guidelines:!t.guidelines})}})),r.a.createElement("div",{className:"form-field"},r.a.createElement(Pt.a,{toggle:!0,label:"Color freeze heads",name:"colorFreezes",checked:t.colorFreezes,onChange:function(){return n({colorFreezes:!t.colorFreezes})}})))))}));function Ct(){return(Ct=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function jt(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Dt=r.a.createElement("style",null,"\n\t\ttspan { white-space:pre }\n\t\t.shp0 { fill: #020202 } \n\t"),Lt=r.a.createElement("path",{id:"Path 0",className:"shp0",d:"M16.49 17L1.5 32C30.16 60.67 31.81 62.01 35 61.99C37.45 61.97 39.33 61.14 41.27 59.23C43.27 57.26 44.03 55.53 44.01 53C43.98 50.32 43.09 48.61 40.24 45.73L36.5 41.97L54.5 42.03C60.51 35.97 61.98 33.52 62 32C62.02 30.41 60.66 28.14 58.27 25.76L54.5 22.03L36.5 22.03C43.09 15.39 43.98 13.68 44.01 11C44.03 8.47 43.27 6.74 41.27 4.77C39.32 2.85 37.45 2.03 34.99 2.02C31.78 2 30.15 3.32 16.49 17ZM89.49 5.79L85.58 9.58L86.03 27.5C79.22 20.74 77.75 20.03 74.61 20.01C71.58 20 70.19 20.61 68.37 22.75C66.91 24.47 66.03 26.81 66.01 29C65.99 32.19 67.33 33.84 81 47.5L96 62.5C124.67 33.84 126.01 32.19 125.99 29C125.97 26.55 125.14 24.67 123.23 22.73C121.43 20.9 119.47 19.96 117.49 19.98C115.46 19.99 113.1 21.22 110.23 23.75L105.97 27.5L106.03 9.5C99.91 3.43 97.54 2.02 95.95 2.01C94.34 2.01 91.96 3.4 89.49 5.79ZM144.5 16.76C130.41 30.65 129.54 31.73 129.78 35.01C129.94 37.22 131.03 39.51 132.77 41.27C134.74 43.27 136.47 44.03 139 44.01C141.68 43.98 143.39 43.09 146.27 40.24L150.03 36.5L149.97 54.5C156.03 60.51 158.48 61.98 160 62C161.59 62.02 163.86 60.66 166.24 58.27L169.97 54.5L169.97 36.5C176.61 43.09 178.32 43.98 181 44.01C183.53 44.03 185.26 43.27 187.23 41.27C189.14 39.33 189.97 37.45 189.99 35C190.01 31.81 188.68 30.18 175.25 16.75C167.14 8.64 160.27 2.01 159.99 2C159.71 2 152.74 8.64 144.5 16.76ZM214.48 4.8C212.27 6.96 211.65 8.41 211.81 11.05C211.97 13.52 213.09 15.57 215.76 18.27L219.5 22.03L200.89 22C195.51 27.88 194.02 30.58 194 32C193.98 33.59 195.34 35.86 197.73 38.24L201.5 41.97L219.5 41.97C212.91 48.61 212.02 50.32 211.99 53C211.97 55.53 212.73 57.26 214.73 59.23C216.67 61.14 218.55 61.97 221 61.99C224.19 62.01 225.84 60.67 239.5 47L254.5 32C225.76 3.26 224.2 1.99 220.93 2C218.38 2 216.55 2.8 214.48 4.8Z"}),At=function(e){var t=e.svgRef,n=e.title,a=jt(e,["svgRef","title"]);return r.a.createElement("svg",Ct({viewBox:"0 0 256 80",width:256,height:80,ref:t},a),n?r.a.createElement("title",null,n):null,Dt,Lt)},_t=r.a.forwardRef((function(e,t){return r.a.createElement(At,Ct({svgRef:t},e))}));n.p;function Nt(){return(Nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Tt(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var xt=r.a.createElement("path",{d:"M544.033302 516.000776V96.000564c0-17.672051-14.478655-31.998984-32.150706-31.998984s-32.150706 14.326933-32.150707 31.998984v420.061624c-54.909072 14.251072-95.809105 64.333925-95.809105 123.935554 0 59.691941 40.82056 109.836206 96.090876 124.000579a32.298816 32.298816 0 0 0-0.281771 4.006195v159.99492c0 17.672051 14.478655 31.998984 32.150707 31.998984s32.150706-14.326933 32.150706-31.998984V768.004516a32.280754 32.280754 0 0 0-0.317894-3.941171c55.389526-14.088512 96.397933-64.301413 96.397932-124.058378 0.010837-59.691941-40.809723-109.832593-96.080038-124.004191z m13.221527 169.249989a64.00158 64.00158 0 1 1 18.744945-45.256635 63.578925 63.578925 0 0 1-18.744945 45.260247zM223.678606 196.003711a32.287979 32.287979 0 0 0 0.292607-4.002582V96.000564a31.970084 31.970084 0 1 0-63.940169 0V192.001129a32.371065 32.371065 0 0 0 0.180622 4.060381c-55.270316 14.160761-96.173962 64.301413-96.173961 124.000579s40.910871 109.818143 96.181186 123.996966a32.360228 32.360228 0 0 0-0.184234 3.937558V927.999436a31.970084 31.970084 0 1 0 63.940169 0V448.000226a32.287979 32.287979 0 0 0-0.278158-3.883372c55.385914-14.088512 96.350971-64.301413 96.350971-124.054765S279.071744 210.084998 223.678606 196.003711z m13.575545 169.315013A64.00158 64.00158 0 1 1 255.999097 320.062089a63.578925 63.578925 0 0 1-18.744946 45.256635zM959.99842 320.062089c0-59.775027-41.048144-109.977091-96.45212-124.058378a32.360228 32.360228 0 0 0 0.173397-4.002582V96.000564a31.970084 31.970084 0 1 0-63.940169 0V192.001129a32.291592 32.291592 0 0 0 0.299833 4.060381c-55.270316 14.160761-96.116162 64.301413-96.116163 124.000579s40.82056 109.836206 96.090876 124.000578a32.298816 32.298816 0 0 0-0.281771 3.99897V927.999436a31.970084 31.970084 0 1 0 63.940169 0V448.061637a32.381903 32.381903 0 0 0-0.166172-3.941171c55.407588-14.084899 96.452119-64.286963 96.45212-124.058377z m-82.746526 45.253022a63.997968 63.997968 0 1 1 18.748558-45.253022 63.578925 63.578925 0 0 1-18.748558 45.253022z",fill:""}),Rt=function(e){var t=e.svgRef,n=e.title,a=Tt(e,["svgRef","title"]);return r.a.createElement("svg",Nt({className:"icon",style:{width:"1em",height:"1em",verticalAlign:"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",ref:t},a),n?r.a.createElement("title",null,n):null,xt)},It=r.a.forwardRef((function(e,t){return r.a.createElement(Rt,Nt({svgRef:t},e))}));n.p;function Mt(){return(Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Bt(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Vt=r.a.createElement("style",null,"\n\t\ttspan { white-space:pre }\n\t\t.shp0 { fill: #323638 } \n\t"),Ft=r.a.createElement("g",{id:"Layer"},r.a.createElement("path",{id:"Layer",fillRule:"evenodd",className:"shp0",d:"M92.28 85.53L84 93.71C83.8 93.9 83.55 94 83.29 94C83.04 94 82.78 93.9 82.59 93.71L65.27 76.56C64.03 75.31 64.05 73.3 65.29 72.07L70.7 66.74C71.9 65.55 73.99 65.56 75.18 66.77L92.29 84.12C92.68 84.51 92.67 85.14 92.28 85.53ZM90.16 84.81L73.76 68.17C73.53 67.95 73.24 67.82 72.92 67.82C72.61 67.82 72.32 67.94 72.1 68.16L66.7 73.49C66.24 73.95 66.23 74.69 66.69 75.15L83.29 91.59L90.16 84.81Z"}),r.a.createElement("path",{id:"Layer",fillRule:"evenodd",className:"shp0",d:"M39.31 77.77C18.42 77.77 1.42 60.77 1.42 39.88C1.42 18.99 18.42 2 39.3 2C60.19 2 77.19 18.99 77.19 39.88C77.19 60.77 60.19 77.77 39.31 77.77ZM75.19 39.88C75.19 20.1 59.09 4 39.3 4C19.52 4 3.42 20.1 3.42 39.88C3.42 59.67 19.52 75.77 39.3 75.77C59.09 75.77 75.19 59.67 75.19 39.88Z"}),r.a.createElement("path",{id:"Layer",fillRule:"evenodd",className:"shp0",d:"M57.7 25.39L57.7 54.31C57.7 58.64 54.17 62.17 49.83 62.17C45.5 62.17 41.97 58.64 41.97 54.31C41.97 49.97 45.5 46.44 49.83 46.44C52.17 46.44 54.26 47.47 55.7 49.08L55.7 25.39C55.7 25.01 55.46 24.67 55.09 24.55L34.1 17.21C33.85 17.13 33.57 17.17 33.34 17.34C33.11 17.51 32.98 17.77 32.98 18.05L32.98 48.81C32.98 53.15 29.46 56.68 25.12 56.68C20.78 56.68 17.25 53.15 17.25 48.81C17.25 44.47 20.78 40.95 25.12 40.95C27.45 40.95 29.54 41.97 30.98 43.59L30.98 18.05C30.98 17.12 31.41 16.27 32.17 15.72C32.92 15.18 33.85 15.03 34.74 15.31L55.73 22.66C56.9 23.03 57.7 24.13 57.7 25.39ZM30.98 48.81C30.98 45.58 28.35 42.95 25.12 42.95C21.88 42.95 19.25 45.58 19.25 48.81C19.25 52.05 21.88 54.68 25.12 54.68C28.35 54.68 30.98 52.05 30.98 48.81ZM55.7 54.31C55.7 51.07 53.07 48.44 49.83 48.44C46.6 48.44 43.97 51.07 43.97 54.31C43.97 57.54 46.6 60.17 49.83 60.17C53.07 60.17 55.7 57.54 55.7 54.31Z"})),Ut=function(e){var t=e.svgRef,n=e.title,a=Bt(e,["svgRef","title"]);return r.a.createElement("svg",Mt({viewBox:"0 0 94 96",width:94,height:96,ref:t},a),n?r.a.createElement("title",null,n):null,Vt,Ft)},Ht=r.a.forwardRef((function(e,t){return r.a.createElement(Ut,Mt({svgRef:t},e))})),zt=(n.p,Object(s.b)((function(e){var t=e.audio,n=e.screen;return{chartAudio:t.chartAudio,activeView:n.activeView}}),(function(e){return{stopPreviewAudio:function(){return e((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))},setActiveView:function(t){return e(function(e){return function(t){t({type:"SET_ACTIVE_VIEW",payload:e})}}(t))}}}))((function(e){var t=e.activeView,n=e.chartAudio,a=[{view:"song",icon:"music",svgIcon:Ht,text:"Song"},{view:"mods",icon:"sidebar",svgIcon:It,text:"Mods"},{view:"chart",svgIcon:_t,text:"Chart"},{view:"logView1",icon:"",text:""},{view:"3",icon:"",text:""}],o=function(e){return"chart"!==e&&"playing"===n.status};return r.a.createElement("nav",{className:"navbar"},a.map((function(a){var i=a.view,s=a.icon,c=a.text,l=a.svgIcon;return i?r.a.createElement("div",{key:"navbarItem_".concat(i),className:"navbar_item ".concat(t===i?"active":""," ").concat(o(i)?"disabled":""),onClick:function(){return function(t){"playing"!==n.status&&(Ne.stopSongPreview(),e.setActiveView(t))}(i)}},l?r.a.createElement(l,{className:"svg-icon ".concat(i)}):r.a.createElement(Ze.a,{name:s}),r.a.createElement("span",{className:"description"},c)):r.a.createElement("div",{className:"navbar_item"})})))}))),Zt=Object(s.b)((function(e){return{activeView:e.screen.activeView}}),null)((function(e){return r.a.createElement("div",{className:"view-section logView1\n    ".concat("logView1"===e.activeView?"active":"")},r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("pre",{id:"logView1"},"test debug log")))})),Xt=Object(s.b)((function(e){return{}}),(function(e){return{selectSong:function(t){return e(ke(t))},selectDifficulty:function(t){return e((n=t,function(e){e({type:"SELECT_DIFFICULTY",payload:n})}));var n},selectMode:function(t){return e((n=t,function(e){e({type:"SELECT_MODE",payload:n})}));var n},resizeScreen:function(t){return e(function(e){return function(t){t({type:"RESIZE_SCREEN",payload:e})}}(t))}}}))((function(e){var t=Object(a.useState)(!0),n=Object(d.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)([]),c=Object(d.a)(s,2),m=c[0],p=c[1],h=Object(a.useState)(null),b=Object(d.a)(h,2),y=b[0],w=b[1],O=Object(a.useState)(null),E=Object(d.a)(O,2),S=E[0],P=E[1],k=Object(a.useState)(!1),C=Object(d.a)(k,2),j=C[0],D=C[1];Object(a.useEffect)((function(){(function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:i(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),Ne.setLoadingAudio=D,window.addEventListener("resize",e.resizeScreen)}),[]);var L=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(f.a)(v()+"data/simfiles.tsv");case 3:(t=e.sent).forEach((function(e){e.levels=e.levels.split(",").map((function(e){return e?parseInt(e):null}))})),p(t),e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,o,i=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:0,console.log("MainContainer selected song",n),Ne.selectSong(n,a),e.selectSong(n),document.title="".concat(n.title," - SMViewer"),r=n.smName,"OddDoQ6dqi0QdQDDOO6qlO08d8bPbli1"===n.hash&&(r=r.replace("1",Math.floor(4*Math.random())+1)),t.prev=7,tt.lastRequestedSong=n.title,t.next=11,g("".concat(v(),"simfiles/").concat(encodeURIComponent(r),".").concat(n.useSsc?"ssc":"sm"));case 11:o=t.sent,tt.lastRequestedSong===n.title&&w(o),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(7),alert("Song ".concat(n.title," failed to load"),t.t0);case 18:case"end":return t.stop()}}),t,null,[[7,15]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"main-container"},!o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(zt,null),r.a.createElement("div",{className:"view-container"},r.a.createElement(Qe,{loadingAudio:j,sm:y,gameEngine:S,setGameEngine:P}),r.a.createElement(kt,null),r.a.createElement(Et,{simfileList:m,onSongSelect:A,onDifficultySelect:function(t){e.selectDifficulty(t)},onModeSelect:function(t){e.selectMode(t)},loadingAudio:j}),r.a.createElement(Zt,null))),r.a.createElement("div",{id:"debugLog"},r.a.createElement("div",{className:"debug-text1"}),r.a.createElement("div",{className:"debug-text2"}),r.a.createElement("div",{className:"debug-text3"}),r.a.createElement("div",{className:"debug-text4"})))}));var Yt=function(){return r.a.createElement("div",{className:"app-container"},r.a.createElement(Xt,null))};i.a.render(r.a.createElement(s.a,{store:Ae},r.a.createElement(Yt,null)),document.getElementById("root"))}},[[240,1,2]]]);
//# sourceMappingURL=main.2c7628b1.chunk.js.map