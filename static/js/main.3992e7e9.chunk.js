(this.webpackJsonpsmviewer=this.webpackJsonpsmviewer||[]).push([[0],{260:function(e,t,a){e.exports=a(451)},271:function(e,t,a){},451:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(46),o=a.n(i),s=a(115),l=a(18),c=(a(270),a(271),a(23)),u=a(24),d=a.n(u),m=a(31),f=a(14),h=a(453),p=(a(273),a(228)),v=a.n(p),g=["left","down","up","right"],b=["Beginner","Basic","Difficult","Expert","Challenge"],y=["Basic","Difficult","Expert","Challenge"],w=[1,100,110,120,130,140,150,160,170,180,190,200,300],E=function(){return window.location.search?window.location.href.slice(0,window.location.href.indexOf(window.location.search)):window.location.href},O=function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(e){return E()+"assets/"+e},S=function(e){return E()+"jackets/"+e},C=function(e){return e.slice(0,1).toUpperCase()+e.slice(1)},P=function(){if(!window.location.search)return{};var e={};try{return window.location.search.slice(1).split("&").forEach((function(t){var a=t.split("="),n=Object(f.a)(a,2),r=n[0],i=n[1];e[r]=i})),e}catch(t){return console.log("error parsing url params",t),{}}}(),j=/dance-([a-z]+)/,T=/(Beginner|Easy|Medium|Hard|Challenge|Edit)/,L={Beginner:"Beginner",Easy:"Basic",Medium:"Difficult",Hard:"Expert",Challenge:"Challenge"},A=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sm",n={},r=e.slice(0,e.indexOf("ssc"===a?"#NOTEDATA:":"#NOTES:")),i=[],o=[],s=0,l=0,c=15;/#BPMS:/i.test(r)&&(i=/#BPMS:([\s\S]*?)\s*;/i.exec(r)[1]).length&&(i=i.split(",").map((function(e){var t=e.split("="),a=Object(f.a)(t,2),n=a[0],r=a[1];return{beat:Math.round(1e3*parseFloat(n))/1e3,value:parseFloat(r)}}))),/#STOPS:/i.test(r)&&(o=/#STOPS:([\s\S]*?)\s*;/i.exec(r)[1]).length&&(o=o.split(",").map((function(e){var t=e.split("="),a=Object(f.a)(t,2),n=a[0],r=a[1];return{beat:Math.round(1e3*parseFloat(n))/1e3,value:parseFloat(r)}}))),/#OFFSET:/i.test(r)&&(s=/#OFFSET:([\s\S]*?)\s*;/i.exec(r)[1],s=parseFloat(s)),t="ssc"===a?e.slice(e.indexOf("#NOTEDATA:")).split(/#NOTEDATA:\s*;/).slice(1):e.slice(e.indexOf("#NOTES:")).split(/#NOTES:\s+/).slice(1),/#SAMPLESTART:/i.test(r)&&(l=/#SAMPLESTART:([\s\S]*?)\s*;/i.exec(e)[1],l=parseFloat(l));var u=0;return t.forEach((function(e,t){var r=j.exec(e)[1];if("single"===r||"double"===r){var d=T.exec(e)[1],m=L[d];n["".concat(r,"_").concat(m)]={difficulty:m,mode:r,bpms:i,stops:o,offset:s,sampleStart:l,sampleLength:c};var h,p=n["".concat(r,"_").concat(m)];if("ssc"===a)h=/#METER:([0-9]+);/.exec(e)[1];else{var v=new RegExp("".concat(d,":\\s+([0-9]+):"));h=parseInt(v.exec(e)[1])}p.level=h,"ssc"===a&&(/#BPMS:/i.test(e)&&(i=/#BPMS:([\s\S]*?)\s*;/i.exec(e)[1]).length&&(i=i.split(",").map((function(e){var t=e.split("="),a=Object(f.a)(t,2),n=a[0],r=a[1];return{beat:parseFloat(n),value:parseFloat(r)}})),p.bpms=i),/#STOPS:/i.test(e)&&(o=/#STOPS:([\s\S]*?)\s*;/i.exec(e)[1]).length&&(o=o.split(",").map((function(e){var t=e.split("="),a=Object(f.a)(t,2),n=a[0],r=a[1];return{beat:parseFloat(n),value:parseFloat(r)}})),p.stops=o));var g=e.slice(e.lastIndexOf(":")+1,e.lastIndexOf(";")).trim().split(",");g=g.map((function(e,t){var a=e.trim().split("\r\n").filter((function(e){return!e.startsWith("//")})),n=a.length,r=[];return a.forEach((function(e,a){if(e.split("").filter((function(e){return"0"!==e})).length){var i={};i.note=e,i.measureIdx=t,i.measureN=a,i.measureD=n,r.push(i)}})),t>=g.length-1&&u++,r})),p.chart=g}})),n.numLoadedCharts=u,window.simfiles=n,n},D=a(42),_=a(3),I=a(20),x=a(21),N=a(34),R=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]},M=function(e,t){var a=document.querySelector(".current-bpm-value");if(a){var n=t.bpmQueue;t.beatTick<4&&n.length>=2&&0===n[0].beat&&4===n[1].beat?a.textContent="":a.textContent=Math.round(e)}},B=function(e){var t=e.audio,a=e.globalParams.allArrows;if(!a.length)return 0;for(var n=t.seek(),r=0;r<a.length;r++){var i=a[r];if(i.combo&&i.timestamp>n+.07)return i.combo-1}for(var o=a.length-1;o>=0;o--){var s=a[o];if(s.combo)return s.combo}return-1},F=function(e,t,a){return a.height-(e+t)},V=function(){var e=document.getElementById("bpmReel");e&&(e.innerHTML="");var t=document.getElementById("stopReel");t&&(t.innerHTML="")},z=function(e){var t,a,n=e.arrows,r=e.freezes,i=e.shocks,o=e.chartAreaHeight,s=e.mods,l="cmod"===s.speed?"timestamp":"beatstamp";if("cmod"===s.speed){var c=o/64;c/=s.cmod/60,t=e.timeTick-1/(s.cmod/60),a=e.timeTick+c}else{var u=o/64;u/=s.speed,t=e.beatTick-1/s.speed,a=e.beatTick+u}var d={},m={};if(!n.length||n[0][l]>t)d.arrow=0;else if(n[n.length-1][l]<t)d.arrow=n.length;else for(var f=1;f<n.length;f++){var h=n[f-1],p=n[f];if(h[l]<t&&p[l]>=t){d.arrow=f;break}}if(!i.length||i[0][l]>t)d.shock=0;else if(i[i.length-1][l]<t)d.shock=i.length;else for(var v=1;v<i.length;v++)if(i[v-1][l]<t&&i[v][l]>=t){d.shock=v;break}if(["bpm","stop"].forEach((function(a){var n=e["".concat(a,"Queue")],r="cmod"===s.speed?"timestamp":"beat";if(!n.length||n[0][r]>t)d[a]=0;else if(n[n.length-1][r]<t)d[a]=n.length;else for(var i=1;i<n.length;i++)if(n[i-1][r]<t&&n[i][r]>=t){d[a]=i;break}})),!r.length||r[0][l]>t)d.freeze=0;else if(r[r.length-1][l]<t)d.freeze=r.length;else for(var g=1;g<r.length;g++)if(r[g-1][l]<t&&r[g][l]>=t){d.freeze=g;break}var b=n[d.arrow];if(d.arrow>=n.length||b[l]>a)m.arrow=d.arrow-1;else for(var y=d.arrow;y<n.length;y++){var w=n[y],E=n[y+1];if(!E){m.arrow=y;break}if(w[l]<=a&&E[l]>a){m.arrow=y;break}}var O=i[d.shock];if(d.shock>=i.length||O[l]>a)m.shock=d.shock-1;else for(var k=d.shock;k<i.length;k++){var S=i[k],C=i[k+1];if(!C||S[l]<=a&&C[l]>a){m.shock=k;break}}["bpm","stop"].forEach((function(t){var n=e["".concat(t,"Queue")],r="cmod"===s.speed?"timestamp":"beat",i=n[d[t]];if(d[t]>=n.length||i[r]>a)m[t]=d[t]-1;else for(var o=d[t];o<n.length;o++){var l=n[o],c=n[o+1];if(!c||l[r]<=a&&c[r]>a){m[t]=o;break}}}));var P="cmod"===s.speed?"holdEndTimes":"holdEndBeats",j=r[d.freeze];if(d.freeze>=r.length)m.freeze=d.freeze-1;else if(j[l]>a){if(m.freeze=d.freeze-1,j[P]){var T=Math.max.apply(Math,Object(D.a)(j[P].filter((function(e){return e}))));for(m.freeze=d.freeze;r[m.freeze][l]<T;)m.freeze++}}else for(var L=d.freeze;L<r.length;L++){var A=r[L],_=r[L+1];if(!_){m.freeze=L;break}if(A[l]<=a&&_[l]>a){if(A[P])for(var I=Math.max.apply(Math,Object(D.a)(A[P].filter((function(e){return e}))));r[L][l]<I;)L++;m.freeze=L;break}}"cmod"===s.speed?(e.timeWindowStartPtr=d,e.timeWindowEndPtr=m,e.currentTimeWindow=[t,a]):(e.beatWindowStartPtr=d,e.beatWindowEndPtr=m,e.currentBeatWindow=[t,a])},U=function(e){var t,a,n,r=e.arrows,i=e.freezes,o=e.shocks,s=e.chartAreaHeight,l=e.mods;if("cmod"===l.speed?(t=e.timeWindowStartPtr,a=e.timeWindowEndPtr,n="timestamp"):(t=e.beatWindowStartPtr,a=e.beatWindowEndPtr,n="beatstamp"),"undefined"!==typeof t&&"undefined"!==typeof a&&Object.keys(t).length&&Object.keys(a).length){var c,u;if("cmod"===l.speed){var d=s/64;d/=l.cmod/60,c=e.timeTick-1/(l.cmod/60),u=e.timeTick+d,e.currentTimeWindow=[c,u]}else{var m=s/64;m/=l.speed,c=e.beatTick-1/l.speed,u=e.beatTick+m,e.currentBeatWindow=[c,u]}if(t.arrow!==r.length){-1===a.arrow&&r[0][n]<=u&&(a.arrow=0),o.length&&-1===a.shock&&o[0][n]<=u&&(a.shock=0),["bpm","stop"].forEach((function(t){var n=e["".concat(t,"Queue")],r="cmod"===l.speed?"timestamp":"beat";n.length&&-1===a[t]&&n[0][r]<=u&&(a[t]=0)}));for(var f=r[t.arrow];f[n]<c;){if(t.arrow++,t.arrow>=r.length)return;f=r[t.arrow]}for(var h=o[t.shock];h&&h[n]<c;)t.shock++,h=o[t.shock];["bpm","stop"].forEach((function(a){for(var n=e["".concat(a,"Queue")],r="cmod"===l.speed?"timestamp":"beat",i=n[t[a]];i&&i[r]<c;)t[a]++,i=n[t[a]]}));for(var p=i[t.freeze];p&&p[n]<c;)t.freeze++,p=i[t.freeze];r[a.arrow];for(var v=r[a.arrow+1];v&&v[n]<=u;)a.arrow++,r[a.arrow],v=r[a.arrow+1];o[a.shock];for(var g=o[a.shock+1];g&&g[n]<=u;)a.shock++,o[a.shock],g=o[a.shock+1];["bpm","stop"].forEach((function(t){for(var n=e["".concat(t,"Queue")],r="cmod"===l.speed?"timestamp":"beat",i=(n[a[t]],n[a[t]+1]);i&&i[r]<=u;)a[t]++,n[a[t]],i=n[a[t]+1]}));for(var b=i[a.freeze],y=i[a.freeze+1];y&&y[n]<=u;)a.freeze++,b=i[a.freeze],y=i[a.freeze+1];if(b)for(var w="cmod"===l.speed?"holdEndTimes":"holdEndBeats",E=Math.max.apply(Math,Object(D.a)(b[w].filter((function(e){return e}))));i[a.freeze][n]<E;)a.freeze++;"cmod"===l.speed?(e.timeWindowStartPtr=t,e.timeWindowEndPtr=a):(e.beatWindowStartPtr=t,e.beatWindowEndPtr=a)}}},H={};g.forEach((function(e){H["rainbow_".concat(e)]=new Image,H["rainbow_".concat(e)].src=k("rainbow_".concat(e,".png")),H["note_".concat(e)]=new Image,H["note_".concat(e)].src=k("note_".concat(e,".png")),H["vivid_".concat(e)]=new Image,H["vivid_".concat(e)].src=k("vivid_".concat(e,".png")),H["flat_".concat(e)]=new Image,H["flat_".concat(e)].src=k("vivid_".concat(e,".png"))}));["freeze_head","tap_explosion","freeze_tail_active","freeze_tail_inactive","freeze_body_active","freeze_body_inactive"].forEach((function(e){H[e]=new Image,H[e].src=k("".concat(e,".png"))}));var W=function(){function e(t){Object(I.a)(this,e);var a=t.key;this.key=a,this.note=t.note,this.measureIdx=t.measureIdx,this.measureN=t.measureN,this.measureD=t.measureD,this.beatstamp=t.beatstamp}return Object(x.a)(e,[{key:"currentBeatPosition",value:function(e){return this.beatstamp-e}},{key:"currentTimePosition",value:function(e){return this.timestamp-e}},{key:"renderFreezeBody",value:function(e,t,a,n){var r,i,o,s,l,c=t.beatTick,u=t.timeTick,d=e.getContext("2d"),m=n.mods,f=n.staticAttrs,h=m.speed,p=m.cmod,v=m.scroll,b=m.appearance,y=e.height,w=g[a%4],E=f?32:64,O=f?32:64;if("3"===this.note[a]){r=H.freeze_tail_inactive,i=(a%4+("reverse"===v?4:0))*E,o=0,s=a*E,l="cmod"===h?this.currentTimePosition(u)*O*(p/60):this.currentBeatPosition(c)*O*h;var k,S=H.freeze_body_inactive;k="cmod"===h?(this.holdEndTimes[a]-this.holdStartTimes[a])*O*(p/60)-O/2:(this.holdEndBeats[a]-this.holdStartBeats[a])*O*h-O/2;var C=Math.floor(k/128),P=k%128,j=P,T=l-(k+O/2),L=!1;T<=0&&(P+=T,T=0,r=H.freeze_tail_active,S=H.freeze_body_active,l>0&&(L=!0)),T>-P&&T<y&&"stealth"!==b&&d.drawImage(S,i,"reverse"===v?0:128-P,E,P,s,"reverse"===v?F(T+O/2,P,e):T+O/2,E,P);for(var A=1;A<=C;A++){var D=128,_=0,I=l-(k+O/2-j-128*(A-1));I<0&&I>-128&&(D+=I,_-=I,I=0),I>-D&&I<y&&"stealth"!==b&&d.drawImage(S,i,"reverse"===v?0:_,E,D,s,"reverse"===v?F(I+O/2,D,e):I+O/2,E,D)}var x,N=O,R=l;if((x="cmod"===h?(this.holdEndTimes[a]-this.holdStartTimes[a])*O*(p/60):(this.holdEndBeats[a]-this.holdStartBeats[a])*O*h)<O/2){o+=O/2-x,l+=O/2-x,N=x+O/2}if(l<O/2&&l>0&&(o+=O/2-l,l=O/2),R>0&&R<y&&"stealth"!==b&&d.drawImage(r,i,"reverse"===v?0:o,E,"reverse"===v?O-o:N,s,"reverse"===v?F(R,O,e):l,E,"reverse"===v?O-o:N),L){var M=H.freeze_head;d.drawImage(M,g.indexOf(w)*E,2*O,E,O,a*E,"reverse"===v?F(0,O,e):0,E,O)}}}},{key:"renderArrow",value:function(e,t,a,n){var r=t.beatTick,i=t.timeTick,o=e.getContext("2d"),s=n.mods,l=n.staticAttrs,c=s.speed,u=s.cmod,d=s.noteskin,m=s.colorFreezes,f=s.scroll,h=s.appearance,p=0;l&&(p=-1);var v=e.height;if("0"!==this.note[a]&&"stealth"!==h){var b,y,w,E,O,k=g[a%4],S=l?32:64,C=l?32:64;if("1"===this.note[a]||"2"===this.note[a]&&m){if(b=H["".concat(d,"_").concat(k)],this.note.includes("2")&&!m)b=H.freeze_head,y=g.indexOf(k)*S,w=0;else if("rainbow"===d){y=(Math.floor(4*r)+3)%8*S;var P=this.measureD/4,j=this.measureN%P;0===j?w=0:0<j&&j<=P/4?w=1:P/4<j&&j<=P/2?w=2:P/2<j&&j<=3*P/4?w=3:3*P/4<j&&j<P&&(w=0),w*=C}else if("note"===d){y=(Math.floor(4*r)+3)%8*S;var T=this.measureN/this.measureD;w=[0,.25,.5,.75].includes(T)?0:[1/8,3/8,5/8,7/8].includes(T)?1:[1/16,3/16,5/16,7/16,9/16,.6875,.8125,.9375].includes(T)?3:2,w*=C}else if("vivid"===d){y=Math.floor(4*r)%4*S;var L=this.measureD/4,A=this.measureN%L;0===A?w=0:0<A&&A<=L/4?w=1:L/4<A&&A<=L/2?w=2:L/2<A&&A<=3*L/4?w=3:3*L/4<A&&A<L&&(w=0),w=(w+Math.floor(r)%4)%4*C}else"flat"===d&&(b=H["vivid_".concat(k)],y=Math.floor(4*r)%4*S,w=Math.floor(r)%4*C);E=a*S,l&&(E+=l.columnIdx*(4*S*2)+2*S),"cmod"===c?O=this.currentTimePosition(i)*C*(u/60):(O=this.currentBeatPosition(r)*C*c,l&&(O%=l.columnHeight)),(O=O+.5|0)>p&&O<v&&o.drawImage(b,y,w,S,C,E,"reverse"===f?F(O,C,e):O,S,C)}else"2"===this.note[a]&&(b=H.freeze_head,y=g.indexOf(k)*S,w=0,E=a*S,(O=(O="cmod"===c?this.currentTimePosition(i)*C*(u/60):this.currentBeatPosition(r)*C*c)+.5|0)>p&&O<v&&o.drawImage(b,y,w,S,C,E,"reverse"===f?F(O,C,e):O,S,C))}}}]),e}(),X={};g.forEach((function(e){X["shock_".concat(e)]=new Image,X["shock_".concat(e)].src=k("shock_".concat(e,".png"))}));var Z=function(){function e(t){Object(I.a)(this,e);var a=t.key;this.key=a,this.note=t.note,this.beatstamp=t.beatstamp}return Object(x.a)(e,[{key:"currentBeatPosition",value:function(e){return this.beatstamp-e}},{key:"currentTimePosition",value:function(e){return this.timestamp-e}},{key:"render",value:function(e,t,a,n){var r=a.beatTick,i=a.timeTick,o=e.getContext("2d"),s=n.mods,l=s.speed,c=s.cmod,u=s.scroll;if("stealth"!==s.appearance){var d=e.height;t=Math.floor(t/3)%8;for(var m=0;m<this.note.length;m++)if("M"===this.note[m]){var f=g[m%4],h=X["shock_".concat(f)],p=t%4*64,v=64*Math.floor(t/4),b=64*m,y=void 0;(y="cmod"===l?64*this.currentTimePosition(i)*(c/60):64*this.currentBeatPosition(r)*l)>-64&&y<d&&o.drawImage(h,p,v,64,64,b,"reverse"===u?F(y,64,e):y,64,64)}}}}]),e}(),Y={};g.forEach((function(e){Y[e]=new Image,Y[e].src=k("".concat(e,"_tap_flash.png")),Y[e]=new Image,Y[e].src=k("".concat(e,"_tap_flash.png"))}));var Q={};g.forEach((function(e){Q[e]=new Image,Q[e].src=k("".concat(e,"_tap_receptor.png")),Q[e]=new Image,Q[e].src=k("".concat(e,"_tap_receptor.png"))}));var q=function(){function e(t){Object(I.a)(this,e)}return Object(x.a)(e,[{key:"render",value:function(e,t,a){var n=t.beatTick,r=e.getContext("2d"),i=a.mode,o=a.mods.scroll,s=n%1>0&&n%1<.25;g.forEach((function(t,a){r.drawImage(s?Y[t]:Q[t],0,0,64,64,64*a,"reverse"===o?F(0,64,e):0,64,64),"double"===i&&r.drawImage(s?Y[t]:Q[t],0,0,64,64,64*(a+4),"reverse"===o?F(0,64,e):0,64,64)}))}}]),e}(),G=function(){function e(t){Object(I.a)(this,e),this.finalBeat=t}return Object(x.a)(e,[{key:"render",value:function(e,t,a){var n=t.beatTick,r=(t.timeTick,a.mods),i=r.speed,o=r.scroll;r.cmod;if(r.guidelines&&"cmod"!==i){var s=e.getContext("2d");s.strokeStyle="#fff";for(var l=e.height,c=0;c<=this.finalBeat;c++){var u=64*(c-n)*i+32,d=c%4===0?2:1;(u=u+.5|0)>0&&u<l&&("reverse"===o&&(u=F(u,0,e)),s.beginPath(),s.moveTo(0,u),s.lineTo(e.width,u),s.lineWidth=d,s.stroke())}}}}]),e}(),J=new Image;J.src=k("tap_explosion.png");var K=function(){function e(t){var a=this;Object(I.a)(this,e),this.frame=-1,this.directions=[],t.note.forEach((function(e,t){"1"!==e&&"2"!==e&&"3"!==e||a.directions.push(t)}))}return Object(x.a)(e,[{key:"render",value:function(e,t){var a=this,n=e.getContext("2d"),r=t.mods.scroll;this.directions.forEach((function(t){if(!(a.frame<0||a.frame>=12)){var i=64*t;n.save(),n.globalAlpha=1-Math.pow(a.frame/12,3),n.drawImage(J,0,0,64,64,i-a.frame,"reverse"===r?F(0+a.frame,64,e):0-a.frame,64+2*a.frame,64+2*a.frame),n.restore()}}))}}]),e}(),$={};["A20","A"].forEach((function(e){$[e]={num:new Image,combo:new Image},$[e].num.src=k("combo_numbers_".concat(e,".png")),$[e].combo.src=k("combo_".concat(e,".png"))})),$.A20.coords={1:{combo:{destX:104,destY:195,width:124.5,height:41},num:{destX:[51],destY:170,width:63,height:70}},2:{combo:{destX:114,destY:195,width:124.5,height:41},num:{destX:[17,61],destY:170,width:63,height:70}},3:{combo:{destX:134,destY:195,width:124.5,height:41},num:{destX:[-7,37,81],destY:170,width:63,height:70}},4:{combo:{destX:134,destY:195,width:124.5,height:41},num:{destX:[-51,-7,37,81],destY:170,width:63,height:70}}},$.A.coords={1:{combo:{destX:104,destY:195,width:124.5,height:41},num:{destX:[51],destY:170,width:63,height:70}},2:{combo:{destX:114,destY:195,width:124.5,height:41},num:{destX:[17,61],destY:170,width:63,height:70}},3:{combo:{destX:134,destY:195,width:124.5,height:41},num:{destX:[-7,37,81],destY:170,width:63,height:70}},4:{combo:{destX:134,destY:195,width:124.5,height:41},num:{destX:[-51,-7,37,81],destY:170,width:63,height:70}}};var ee=function(){function e(t){Object(I.a)(this,e)}return Object(x.a)(e,[{key:"render",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0,n=e.getContext("2d");if(!(t<4)){var r=a.mods,i=a.mode,o=r.comboFont,s=o,l=(t=t.toString()).length,c=$[s].combo,u=$[s].num,d=$[s].coords[l].combo.destX+("double"===i?128:0),m=$[s].coords[l].combo.destY,f=$[s].coords[l].combo.width,h=$[s].coords[l].combo.height;n.drawImage(c,0,0,c.width,c.height,d,m,f,h);for(var p=0;p<l;p++){var v=t[p],g=u.width/4,b=u.height/4,y=v%4,w=Math.floor(v/4),E=y*g,O=w*b,k=$[s].coords[l].num.destX[p]+("double"===i?128:0),S=$[s].coords[l].num.destY,C=$[s].coords[l].num.width,P=$[s].coords[l].num.height;n.drawImage(u,E,O,g,b,k,S,C,P)}}}}]),e}(),te=new Image;te.src=k("bpm_stop_values.png");var ae=function(){function e(){Object(I.a)(this,e)}return Object(x.a)(e,[{key:"renderBpm",value:function(e,t,a,n){var r=a.beatTick,i=a.timeTick,o=n.mods,s=e.getContext("2d"),l=ne(t,{beatTick:r,timeTick:i},o,e),c=e.height,u=l-10;u=u+.5|0;var d=t.value.toString(),m=d.length;if(u>-19&&u<c)for(var f=e.width-2,h=m-1;h>=0;h--){var p=d[h],v=void 0,g=void 0;"."===p?(v=93,g=3,f-=3):(v=9*parseInt(p),g=9,f-=9),s.drawImage(te,v,0,g,19,f,u,g,19)}}},{key:"renderStop",value:function(e,t,a,n){var r=a.beatTick,i=a.timeTick,o=n.mods,s=e.getContext("2d"),l=ne(t,{beatTick:r,timeTick:i},o,e),c=e.height,u=l-10,d=t.value.toString(),m=d.length;if(u>-19&&u<c)for(var f=2,h=0;h<m;h++){var p=d[h],v=void 0,g=void 0;"."===p?(v=93,g=3):(v=9*parseInt(p),g=9),s.drawImage(te,v,19,g,19,f,u,g,19),f+="."===p?3:9}}}]),e}(),ne=function(e,t,a,n){var r,i=t.beatTick,o=t.timeTick;"cmod"===a.speed?r=64*(e.timestamp-o)*(a.cmod/60):r=64*(e.beat-i)*a.speed;return r+=32,"reverse"===a.scroll&&(r=F(r,0,{height:n.clientHeight})),r},re=ae,ie={};ie.upper=new Image,ie.upper.src=k("upper_lanecover.png"),ie.lower=new Image,ie.lower.src=k("lower_lanecover.png");var oe=["hidden","sudden","hiddensudden"],se=function(){function e(t){Object(I.a)(this,e)}return Object(x.a)(e,[{key:"render",value:function(e,t){var a=e.getContext("2d"),n=t.mods,r=t.mode,i=n.appearance,o=n.scroll,s=n.laneCoverHeight[oe.indexOf(i)];if(i.includes("hidden")&&"normal"===o||i.includes("sudden")&&"reverse"===o){var l=ie.upper;a.drawImage(l,0,F(s,0,e),l.width,s,0,0,l.width,s),"double"===r&&a.drawImage(l,0,F(s,0,e),l.width,s,256,0,l.width,s)}if(i.includes("sudden")&&"normal"===o||i.includes("hidden")&&"reverse"===o){var c=ie.lower;a.drawImage(c,0,0,c.width,s,0,F(s,0,e),c.width,s),"double"===r&&a.drawImage(c,0,0,c.width,s,256,F(s,0,e),c.width,s)}}}]),e}(),le=a(157),ce=a(56),ue=a(229),de=function(e){return function(t){t({type:"SET_CHART_AUDIO_STATUS",payload:e})}},me={chartAudio:{status:"stopped",progress:0},previewAudio:{status:"stopped"}},fe={activeBpm:null,combo:0},he=function(e){return function(t){t({type:"UPDATE_MODS",payload:e})}},pe=function(){try{var e=window.localStorage.getItem("userSettings");return e?JSON.parse(e):{}}catch(t){return console.error(t),{}}},ve=function(e){var t=window.localStorage.getItem("userSettings");try{t=t?JSON.parse(t):{}}catch(a){console.error(a)}Object.keys(e).forEach((function(a){t[a]=e[a]})),window.localStorage.setItem("userSettings",JSON.stringify(t))},ge=function(){return window.localStorage.getItem("progress")||0},be=function(e){window.localStorage.setItem("progress",e)},ye={difficulty:["Beginner","Basic","Difficult","Expert","Challenge"],mode:["single","double"],mods:{speed:[.25,.5,.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.5,5,5.5,6,6.5,7,7.5,8],appearance:["visible","hidden","sudden","hiddensudden","stealth"],turn:["off","mirror","left","right","shuffle"],shuffle:[1,2,3,4,5,6,7,8],stepZone:["on","off"],scroll:["normal","reverse"],noteskin:["rainbow","note","vivid","flat"],comboDisplay:["behind","inFront","hidden"],comboFont:["A20","A"]}},we={difficulty:"Expert",mode:"single",mods:{speed:2.5,cmod:550,appearance:"visible",laneCoverHeight:[8,8,8],laneCoverVisible:!0,turn:"off",shuffle:1,stepZone:"on",scroll:"normal",noteskin:"note",guidelines:!0,comboDisplay:"behind",comboFont:"A20",colorFreezes:!1,globalOffset:.07,bpmStopDisplay:!1}};!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=pe();if(["song","difficulty","mode"].forEach((function(e){t[e]&&(we[e]=t[e])})),t.mods&&Object.keys(we.mods).forEach((function(e){"undefined"!==typeof t.mods[e]&&(we.mods[e]=t.mods[e])})),e.difficulty){var a={b:"Beginner",B:"Basic",D:"Difficult",E:"Expert",C:"Challenge"};Object.keys(a).includes(e.difficulty[0])&&(we.difficulty=a[e.difficulty[0]]),"S"===e.difficulty[1]?we.mode="single":"D"===e.difficulty[1]&&(we.mode="double")}if(e.speed){var n=parseFloat("".concat(e.speed[0],".").concat(e.speed.slice(1)));ye.mods.speed.includes(n)&&(we.mods.speed=n)}if(e.turn){var r=e.turn.toLowerCase();ye.mods.turn.includes(r)&&(we.mods.turn=r)}}(P);var Ee=we.mods,Oe=pe(),ke={innerWidth:window.innerWidth,innerHeight:window.innerHeight,activeView:Oe.activeView||"song"},Se=a(249),Ce={lastRequestedSong:null,lastRequestedSongLoaded:!1},Pe=function(){return function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Se.a)(E()+"data/simfiles.tsv");case 3:(a=e.sent).forEach((function(e){e.levels=e.levels.split(",").map((function(e){return e?parseInt(e):null})),e.missingDifficulties?e.missingDifficulties=e.missingDifficulties.split(",").map((function(e){return parseInt(e)})):e.missingDifficulties=[]})),t({type:"GET_SIMFILE_LIST",payload:a}),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},je=function(e){return function(){var t=Object(m.a)(d.a.mark((function t(a){var n,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.smName,"OddDoQ6dqi0QdQDDOO6qlO08d8bPbli1"===e.hash&&(n=n.replace("1",Math.floor(4*Math.random())+1)),t.prev=2,Ce.lastRequestedSong=e.title,t.next=6,O("".concat(E(),"simfiles/").concat(encodeURIComponent(n),".").concat(e.useSsc?"ssc":"sm"));case 6:r=t.sent,Ce.lastRequestedSong===e.title&&a({type:"LOAD_SIMFILE",payload:r}),t.next=14;break;case 10:throw t.prev=10,t.t0=t.catch(2),alert("Song ".concat(e.title," failed to load"),t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()},Te={simfileList:[],sm:null},Le=function(e){return function(t){t({type:"SELECT_SONG",payload:e})}},Ae={difficulty:we.difficulty,mode:we.mode},De=Object(ce.c)({audio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CHART_AUDIO_STATUS":var a=Object(_.a)(Object(_.a)({},e.chartAudio),{},{status:t.payload});return Object(_.a)(Object(_.a)({},e),{},{chartAudio:a});case"PLAY_CHART_AUDIO":var n=Object(_.a)(Object(_.a)({},e.chartAudio),{},{status:"playing"});return Object(_.a)(Object(_.a)({},e),{},{chartAudio:n});case"PAUSE_CHART_AUDIO":var r=Object(_.a)(Object(_.a)({},e.chartAudio),{},{status:"paused"});return Object(_.a)(Object(_.a)({},e),{},{chartAudio:r});case"STOP_CHART_AUDIO":var i=Object(_.a)(Object(_.a)({},e.chartAudio),{},{status:"stopped"});return Object(_.a)(Object(_.a)({},e),{},{chartAudio:i});case"SET_PREVIEW_AUDIO_STATUS":var o=Object(_.a)(Object(_.a)({},e.previewAudio),{},{status:t.payload});return Object(_.a)(Object(_.a)({},e),{},{previewAudio:o});case"PLAY_PREVIEW_AUDIO":var s=Object(_.a)(Object(_.a)({},e.previewAudio),{},{status:"playing"});return Object(_.a)(Object(_.a)({},e),{},{previewAudio:s});case"STOP_PREVIEW_AUDIO":var l=Object(_.a)(Object(_.a)({},e.previewAudio),{},{status:"stopped"});return Object(_.a)(Object(_.a)({},e),{},{previewAudio:l});case"SET_CHART_PROGRESS":var c=Object(_.a)(Object(_.a)({},e.chartAudio),{},{progress:t.payload});return Object(_.a)(Object(_.a)({},e),{},{chartAudio:c});default:return e}},chart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_ACTIVE_BPM_DISPLAY":var a=Math.round(t.payload);return Object(_.a)(Object(_.a)({},e),{},{activeBpm:a});case"SET_COMBO":return Object(_.a)(Object(_.a)({},e),{},{combo:t.payload});default:return e}},mods:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_MODS":var a=t.payload,n=Object(_.a)(Object(_.a)({},e),a);return ve({mods:n}),n;case"UPDATE_LANE_COVER_HEIGHT":var r=t.payload,i=r.diff,o=r.canvasHeight,s=Object(D.a)(e.laneCoverHeight),l=0,c=o;"hiddensudden"===e.appearance&&(c/=2);for(var u=0;u<s.length;u++){s[u]+=i[u];var d=s[u];d<l?s[u]=l:d>c&&(s[u]=c)}var m=Object(_.a)(Object(_.a)({},e),{},{laneCoverHeight:s});return ve({mods:m}),m;default:return e}},screen:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESIZE_SCREEN":var a=t.payload.target,n=a.innerWidth,r=a.innerHeight,i={innerWidth:n,innerHeight:r};return Object(_.a)(Object(_.a)({},e),i);case"SET_ACTIVE_VIEW":var o=t.payload;return ve({activeView:o}),Object(_.a)(Object(_.a)({},e),{},{activeView:o});default:return e}},simfiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_SIMFILE_LIST":var a=t.payload;return Object(_.a)(Object(_.a)({},e),{},{simfileList:a});case"LOAD_SIMFILE":var n=t.payload;return Object(_.a)(Object(_.a)({},e),{},{sm:n});default:return e}},songSelect:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_SONG":var a=t.payload;return ve({song:a.hash}),Object(_.a)(Object(_.a)({},e),{},{song:a});case"SELECT_DIFFICULTY":var n=t.payload;return ve({difficulty:n}),Object(_.a)(Object(_.a)({},e),{},{difficulty:n});case"SELECT_MODE":var r=t.payload;return ve({mode:r}),Object(_.a)(Object(_.a)({},e),{},{mode:r});default:return e}}}),_e=Object(ce.e)(De,Object(ce.d)(Object(ce.a)(ue.a),window.devToolsExtension?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e})),Ie=new(function(){function e(){Object(I.a)(this,e),this.mouseDown=!1,this.currentProgress=0,this.presetStart=0,P.progress&&(this.presetStart=P.progress/1e5,this.currentProgress=this.presetStart)}return Object(x.a)(e,[{key:"initCanvas",value:function(){var e=this;this.canvas=document.querySelector("#progress"),this.presetMarker=document.querySelector("#progress + .preset-marker-wrapper"),this.drawBackground(),this.canvas.addEventListener("touchstart",(function(t){t.preventDefault(),e.jumpToProgress(t.touches[0])})),this.canvas.addEventListener("touchmove",(function(t){t.preventDefault(),e.jumpToProgress(t.touches[0])})),this.canvas.addEventListener("mousedown",(function(t){t.preventDefault(),e.jumpToProgress(t),e.mouseDown=!0})),this.canvas.addEventListener("mousemove",(function(t){t.preventDefault(),e.mouseDown&&e.jumpToProgress(t)})),this.canvas.addEventListener("mouseup",(function(t){t.preventDefault(),e.mouseDown=!1})),this.setPresetMarker(),window.addEventListener("resize",(function(t){e.setPresetMarker()}))}},{key:"setPresetMarker",value:function(){if(this.presetStart&&this.presetMarker){var e=this.canvas.offsetWidth;this.presetPosition=e*this.presetStart,this.presetMarker.style.left="".concat(this.presetPosition,"px")}}},{key:"setProgress",value:function(e){this.currentProgress=e}},{key:"getProgress",value:function(){return this.currentProgress}},{key:"jumpToProgress",value:function(e,t){var a;if(t)a=t;else{var n=this.canvas.getBoundingClientRect(),r=n.width;a=(e.clientX-n.x)/r}a<0||a>1||(this.setProgress(a),xe.seekProgress(a))}},{key:"jumpToPresetStart",value:function(e){this.jumpToProgress(e,this.presetStart),e.stopPropagation()}},{key:"drawBackground",value:function(){var e=this.canvas.getContext("2d");e.fillStyle="#d7e2ed",e.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"render",value:function(e){if(!isNaN(e)){this.setProgress(e),this.drawBackground();var t=this.canvas.getContext("2d");t.fillStyle="#627c92",t.fillRect(0,0,this.canvas.width*e,this.canvas.height)}}}]),e}()),xe=new(function(){function e(){Object(I.a)(this,e),this.sources={song:{},preview:{}},this.currentSong=null,this.currentPreview=null,this.currentSongId=null,this.currentPreviewId=null,this.previewFadeTimeout=null,this.updateTimeline=this.updateTimeline.bind(this),this.updateProgress=this.updateProgress.bind(this),this.audioResyncFrames=0}return Object(x.a)(e,[{key:"getCurrentSong",value:function(){return this.sources.song[this.currentSong]}},{key:"getCurrentPreview",value:function(){return this.sources.preview[this.currentPreview]}},{key:"getCurrentTime",value:function(){return this.getCurrentSong().audio.seek()}},{key:"storeAudioSource",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.sources.song[e.hash]){this.setLoadingAudio(!0);var n=this.sources.song[e.hash]={title:e.title};n.audio=new le.Howl({src:"https://dl.dropboxusercontent.com/s/".concat(e.dAudioUrl),format:["mp3"],html5:!0,onload:function(){t.setLoadingAudio(!1),t.seekProgress(a)},onloaderror:function(e,t,a){alert("".concat(e,";;; ").concat(t,";;; ").concat(a))},onplay:function(){n.tl.play(),t.resync(),N.a.ticker.add(t.updateProgress),t.startAnimationLoop(),_e.dispatch((function(e){e({type:"PLAY_CHART_AUDIO"})}))},onpause:function(){n.tl.pause(),N.a.ticker.remove(t.updateTimeline),N.a.ticker.remove(t.updateProgress),t.stopAnimationLoop(),_e.dispatch((function(e){e({type:"PAUSE_CHART_AUDIO"})}))},onseek:function(){},onstop:function(){n.tl&&n.tl.restart().pause(),N.a.ticker.remove(t.updateTimeline),N.a.ticker.remove(t.updateProgress),t.stopAnimationLoop(),_e.dispatch((function(e){e({type:"STOP_CHART_AUDIO"})}))},onend:function(e){n.tl&&n.tl.pause(),N.a.ticker.remove(t.updateTimeline),N.a.ticker.remove(t.updateProgress),t.stopAnimationLoop(),_e.dispatch((function(e){e({type:"STOP_CHART_AUDIO"})}))}})}}},{key:"storePreviewSource",value:function(e,t){var a=this,n=this.sources.preview[e.hash]={title:e.title};n.audio=new le.Howl({src:"https://dl.dropboxusercontent.com/s/".concat(e.dAudioUrl),format:["mp3"],html5:!0,sprite:{sample:[parseFloat(1e3*(t.sampleStart-.07)),parseFloat(1e3*(t.sampleLength-.07))]},onload:function(){},onplay:function(){n.audio.volume(1);a.previewFadeTimeout=setTimeout((function(){n.audio.fade(1,0,2e3)}),1e3*t.sampleLength-2e3),_e.dispatch((function(e){e({type:"PLAY_PREVIEW_AUDIO"})}))},onstop:function(){clearTimeout(a.previewFadeTimeout),a.currentPreviewId=null,_e.dispatch((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))},onend:function(){clearTimeout(a.previewFadeTimeout),a.currentPreviewId=null,_e.dispatch((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))}})}},{key:"selectSong",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.currentSong&&this.getCurrentSong().audio.stop(this.currentSongId),this.storeAudioSource(e,t),this.currentSong=e.hash}},{key:"resync",value:function(){this.audioReloadFrames=0,this.audioResyncFrames=10,N.a.ticker.add(this.updateTimeline)}},{key:"updateTimeline",value:function(){var e=this.getCurrentSong();if(e.tl&&e.globalParams){var t=!1;try{var a=this.getCurrentTime();if("number"===typeof a){t=!0;var n=_e.getState().mods.globalOffset;e.tl.seek(a+n+e.globalParams.offset),this.updateProgressOnce(),"playing"===this.getChartAudioStatus()&&e.tl.play(),this.audioResyncFrames--}else e.tl.pause(),this.audioReloadFrames++}catch(s){console.log(s)}if(t&&this.audioResyncFrames<=0){var r=function(e){for(var t=e.beatTick,a=e.bpmQueue,n=0,r=0;r<a.length;r++){var i=a[r];if(i.beat>t)return n;n=i.value}return n}(e.globalParams);M(r,e.globalParams);var i=B(e),o=document.querySelector("#combo-temp .combo-num");o&&(o.textContent=i),N.a.ticker.remove(this.updateTimeline)}}}},{key:"seekTime",value:function(e){this.getCurrentSong().audio.seek(e),this.resync()}},{key:"goBack",value:function(e){this.seekTime(this.getCurrentTime()-.001*e)}},{key:"goForward",value:function(e){this.seekTime(this.getCurrentTime()+.001*e)}},{key:"seekProgress",value:function(e){var t=this.getCurrentSong().audio.duration();this.seekTime(e*t)}},{key:"updateProgress",value:function(e,t,a){var n=this.getCurrentSong();if(n&&n.tl){if(t>60){var r=this.getCurrentTime();if(console.log("frame skip","deltaTime:",t,"currentTime:",r),"number"===typeof r){var i=_e.getState().mods.globalOffset;n.tl.seek(r+i+n.globalParams.offset)}else console.log("audio unstable after frame skip, resyncing"),this.resync()}if(a%15===0){var o=performance.now(),s=n.audio,l=s.seek()/s.duration();performance.now();o=performance.now();n.tl.progress(),performance.now();o=performance.now(),be(l),Ie.render(l),performance.now()}}}},{key:"updateProgressOnce",value:function(){this.updateProgress(null,null,0);var e=this.getCurrentSong(),t=B(e);R("FC: ".concat(function(e){var t=e.globalParams.allArrows;if(!t.length)return 0;for(var a=t.length-1;a>=0;a--){var n=t[a];if(n.combo)return n.combo}return 0}(e))),e.globalParams.combo=t,z(e.globalParams),this.updateAnimationLoopOnce()}},{key:"setTimeline",value:function(e){this.getCurrentSong().tl=e}},{key:"setGlobalParams",value:function(e){this.getCurrentSong().globalParams=e}},{key:"play",value:function(){if("pending"!==this.getChartAudioStatus()){var e=this.getCurrentSong();this.currentSongId=e.audio.play(),R("last played: ".concat(e.title),2),_e.dispatch(de("pending"))}}},{key:"pause",value:function(){this.getCurrentSong().audio.pause(this.currentSongId);var e=this.getCurrentSong().audio,t=e.seek()/e.duration();be(t)}},{key:"stop",value:function(){var e=this;this.getCurrentSong()&&(this.getCurrentSong().audio.stop(this.currentSongId),this.stopAnimationLoop(),setTimeout((function(){return e.seekTime(0)})),this.currentSongId=null)}},{key:"killImmediately",value:function(e){var t=this.sources.song[e];t&&(t.tl&&this.sources.song[e].tl.kill(),this.stop()),_e.dispatch(de("stopped"))}},{key:"isPlaying",value:function(){return this.getCurrentSong()&&this.getCurrentSong().audio.playing(this.currentSongId)}},{key:"isPaused",value:function(){return this.getCurrentSong()&&!this.getCurrentSong().audio.playing(this.currentSongId)}},{key:"playAssistTick",value:function(){this.sources.assistTick.audio.play()}},{key:"playSongPreview",value:function(e){if("pending"!==this.getPreviewAudioStatus()){this.currentPreview&&this.getCurrentPreview().audio.stop(this.currentPreviewId),this.currentPreview=e.hash;var t,a=this.getCurrentPreview().audio;this.currentPreviewId=a.play("sample"),_e.dispatch((t="pending",function(e){e({type:"SET_PREVIEW_AUDIO_STATUS",payload:t})}))}}},{key:"stopSongPreview",value:function(){this.currentPreview&&this.getCurrentPreview().audio.stop(this.currentPreviewId)}},{key:"isPreviewPlaying",value:function(){return this.getCurrentPreview()&&this.getCurrentPreview().audio.playing(this.currentPreviewId)}},{key:"getChartAudioStatus",value:function(){return _e.getState().audio.chartAudio.status}},{key:"getPreviewAudioStatus",value:function(){return _e.getState().audio.previewAudio.status}}]),e}()),Ne=function(){function e(t,a,n){Object(I.a)(this,e),this.canvas=t,this.c=t.getContext("2d"),this.simfiles=a,this.tl=N.a.timeline(),this.eventList=[],this.arrows=[],this.shocks=[],this.freezes=[],this.allArrows=[],this.mainLoopRequestRef=null,this.bpmReel=document.getElementById("bpmReel"),this.stopReel=document.getElementById("stopReel"),this.drawBackground(),this.globalParams={beatTick:0,timeTick:0,frame:0,combo:0,bpmQueue:[],targetFlashes:{},lastEntity:null,finalBeat:0,chartAreaHeight:t.height},xe.startAnimationLoop=this.startLoop.bind(this),xe.stopAnimationLoop=this.stopLoop.bind(this),xe.updateAnimationLoopOnce=this.updateLoopOnce.bind(this),this.resetChart(n)}return Object(x.a)(e,[{key:"resetChart",value:function(e){var t=e.mode,a=e.difficulty,n=e.mods,r=_e.getState(),i=r.audio,o=r.songSelect;this.tl&&this.tl.kill(),this.tl=N.a.timeline(),this.eventList.length=0,this.arrows.length=0,this.freezes.length=0,this.shocks.length=0,this.allArrows.length=0,this.globalParams.beatTick=0,this.globalParams.timeTick=0,this.globalParams.frame=0,this.globalParams.combo=0,this.globalParams.bpmQueue=[],this.globalParams.stopQueue=[],this.globalParams.arrows=this.arrows,this.globalParams.freezes=this.freezes,this.globalParams.shocks=this.shocks,this.globalParams.allArrows=this.allArrows,this.globalParams.beatWindowStartPtr={},this.globalParams.beatWindowEndPtr={},this.globalParams.timeWindowStartPtr={},this.globalParams.timeWindowEndPtr={},this.globalParams.targetFlashes={},this.globalParams.mods=n,xe.setGlobalParams(this.globalParams),window.globalParams=this.globalParams;var s=this.simfiles["".concat(t,"_").concat(a)];s&&(!function(e){var t=e.chart,a="".concat(e.mode," ").concat(e.difficulty," ").concat(e.level,"\n\n");!function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}(a+=t.map((function(e){if(!e.length)return"[    ]\n";for(var t="[",a=e[0].measureD,n=function(n){var r=e.find((function(e){return e.measureN==n}));n>0&&(t+=" "),t+=r?r.note:"0000",n<a-1&&(t+="\n")},r=0;r<a;r++)n(r);return t+="] (".concat(a," ticks)\n")})).join("\n"),1)}(s),this.globalParams.offset=s.offset,this.generateEventList(s),this.generateArrows(s,n),this.generateTimestamps(),this.initTimeline(n),this.restartTl(),"playing"!==i.chartAudio.status&&this.pauseTl(),xe.storePreviewSource(o.song,s),xe.resync())}},{key:"startLoop",value:function(){this.mainLoopRequestRef=window.requestAnimationFrame(this.mainLoop.bind(this))}},{key:"stopLoop",value:function(){window.cancelAnimationFrame(this.mainLoopRequestRef)}},{key:"updateLoopOnce",value:function(){this.clearBpmAndStopDisplay(),window.requestAnimationFrame(this.mainLoop.bind(this,!1))}},{key:"updateExternalGlobalParams",value:function(e){for(var t in e)this.globalParams[t]=e[t];z(this.globalParams)}},{key:"generateEventList",value:function(e){for(var t=e.bpms,a=e.stops,n=[],r=0,i=0,o=t[0].value;r<t.length&&i<a.length;){var s=t[r],l=a[i];l.beat<=s.beat?(n.push(Object(_.a)(Object(_.a)({},l),{},{bpm:o,type:"stop"})),i++):(n.push(Object(_.a)(Object(_.a)({},s),{},{type:"bpm"})),o=s.value,r++)}for(;r<t.length;)n.push(Object(_.a)(Object(_.a)({},t[r]),{},{type:"bpm"})),r++;for(;i<a.length;)n.push(Object(_.a)(Object(_.a)({},a[i]),{},{bpm:o,type:"stop"})),i++;n[0].timestamp=0,this.globalParams.bpmQueue=[n[0]];for(var c=1;c<n.length;c++){var u=n[c-1],d=n[c],m=n[c-1].timestamp,f=(d.beat-u.beat)/("bpm"===u.type?u.value:u.bpm)*60;"stop"===u.type&&(f+=u.value);var h=m+f;d.timestamp=h,"bpm"===d.type?this.globalParams.bpmQueue.push(d):"stop"===d.type&&this.globalParams.stopQueue.push(d)}return this.eventList=n,n}},{key:"generateArrows",value:function(e,t){var a=this,n=e.chart,r=_e.getState().songSelect.mode;if(Array.isArray(n[0])){var i=[];n.forEach((function(e){i.push.apply(i,Object(D.a)(e))})),n=i}(n=function(e,t,a){var n=t.turn,r=t.shuffle,i={off:"LDUR",mirror:"RUDL",left:"ULRD",right:"DRLU",shuffle1:"LRDU",shuffle2:"UDRL",shuffle3:"LRUD",shuffle4:"DURL",shuffle5:"DLUR",shuffle6:"DULR",shuffle7:"RLUD",shuffle8:"RULD"},o=n;return"shuffle"===n&&(o+=r),"single"===a?e.map((function(e){var t=e.note,a=i[o].split("").map((function(e){return t[i.off.indexOf(e)]}));return Object(_.a)(Object(_.a)({},e),{},{note:a})})):"double"===a?e.map((function(e){var t=e.note.split("");return"mirror"===n&&(t=t.reverse()),Object(_.a)(Object(_.a)({},e),{},{note:t})})):void 0}(n,t,r)).forEach((function(e,t){var a=e.measureIdx,n=e.measureN,r=e.measureD;e.beatstamp=4*(a+n/r),e.beatstamp=Math.floor(1e3*e.beatstamp)/1e3})),n.forEach((function(e,t){if("M"===e.note[0]||"M"===e.note[4]){var n=new Z(Object(_.a)({key:t},e));a.shocks.push(n),a.allArrows.push(n)}if(e.note.includes("1")||e.note.includes("2")||e.note.includes("3")){var r=new W(Object(_.a)({key:t},e));a.arrows.push(r),a.allArrows.push(r),(e.note.includes("2")||e.note.includes("3"))&&a.freezes.push(r)}})),this.stepZone=new q,this.comboDisplay=new ee,this.laneCover=new se}},{key:"generateTimestamps",value:function(){var e=this,t=this.arrows[this.arrows.length-1],a=this.eventList[this.eventList.length-1];if(t&&a){var n=t.beatstamp,r=a.beat;r>n?(this.globalParams.finalBeat=r,this.globalParams.lastEntity=a):(this.globalParams.finalBeat=n,this.globalParams.lastEntity=t)}else t?(this.globalParams.finalBeat=t.beatstamp,this.globalParams.lastEntity=t):a&&(this.globalParams.finalBeat=a.beat,this.globalParams.lastEntity=a);this.globalParams.finalBeat+=8;var i=this.globalParams.bpmQueue;this.comboArrows=[];var o=-1,s=0,l=-1,c=null,u=null,d=0,m=0;this.allArrows.forEach((function(t,a){for(;o<i.length-1&&i[o+1].beat<t.beatstamp;){o++;var n=i[o];c=n.value,d=0;for(var r=s;r<e.eventList.length;r++){var f=e.eventList[r];if(f.beat===n.beat&&"bpm"===f.type){s=r;var h=e.eventList[r+1];h&&"stop"===h.type?(l=r+1,u=e.eventList[l]):u=null;break}}}for(;u&&u.beat<t.beatstamp;){d+=u.value;var p=e.eventList[l+1];p&&"stop"===p.type?l++:l=-1,u=e.eventList[l]}var v=i[o].beat,g=i[o].timestamp+(t.beatstamp-v)*(60/c)+d;t.timestamp=g,t.note.includes("1")||t.note.includes("2")||t.note.includes("M")?(m++,t.combo=m,e.comboArrows.push(t)):t.note.includes("3")})),this.allArrows.forEach((function(t){for(var a=function(a){if("3"!==t.note[a])return"continue";for(var n=[],r=t.key-1;r>=0;r--){if(e.allArrows[r].holdStartBeats||(e.allArrows[r].holdStartBeats=[],e.allArrows[r].holdEndBeats=[],e.allArrows[r].holdStartTimes=[],e.allArrows[r].holdEndTimes=[]),n.push(e.allArrows[r]),"2"===e.allArrows[r].note[a])if("break"===function(){var i=e.allArrows[r],o=t;return o.holdStartBeats||(o.holdStartBeats=[],o.holdEndBeats=[],o.holdStartTimes=[],o.holdEndTimes=[]),n.push(o),n.forEach((function(e){e.holdStartBeats[a]=i.beatstamp,e.holdEndBeats[a]=o.beatstamp,e.holdStartTimes[a]=i.timestamp,e.holdEndTimes[a]=o.timestamp})),"break"}())break}},n=0;n<t.note.length;n++)a(n)}))}},{key:"initTimeline",value:function(e){var t=this;this.allArrows.forEach((function(e){e.note.includes("1")||e.note.includes("2")||e.note.includes("M")?t.tl.set(t.globalParams,{onStart:function(){t.globalParams.combo=e.combo,e instanceof W&&(t.globalParams.targetFlashes[e.beatstamp]=new K(e))}},e.timestamp-.008):e.note.includes("3")&&t.tl.set(t.globalParams,{onStart:function(){t.globalParams.targetFlashes[e.beatstamp]=new K(e)}},e.timestamp-.008)})),this.tl=this.tl.set({},{},0),this.tl=this.tl.to(this.globalParams,{timeTick:this.globalParams.lastEntity.timestamp+1,duration:this.globalParams.lastEntity.timestamp+1,ease:"none"},">"),this.tl=this.tl.set({},{},0);for(var a,n=0,r=function(e){var r=t.eventList[e],i=t.eventList[e+1],o="stop"===r.type?r.value:0;if("bpm"===r.type?a=r.value:"stop"===r.type&&(a=r.bpm),i){var s=i.beat-r.beat,l=s/a*60;t.tl=t.tl.to(t.globalParams,{beatTick:n+s,duration:l,ease:"none",onStart:function(){"bpm"===r.type&&M(r.value,t.globalParams)}},">".concat(o)),n+=s}else t.tl=t.tl.to(t.globalParams,{beatTick:t.globalParams.finalBeat,duration:(t.globalParams.finalBeat-n)/a*60,ease:"none",onStart:function(){"bpm"===r.type&&M(r.value,t.globalParams)}},">".concat(o))},i=0;i<this.eventList.length;i++)r(i);this.guidelines=new G(this.globalParams.finalBeat),this.bpmAndStopDisplay=new re,xe.setTimeline(this.tl),this.updateLoopOnce()}},{key:"mainLoop",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.killed){performance.now(),this.drawBackground(),performance.now();var a=_e.getState(),n=a.songSelect,r=a.mods,i=n.mode;(r.cmod<100||r.cmod>1e3)&&(r.cmod=550);var o,s,l=this.globalParams,c=l.beatTick,u=l.timeTick;if(this.stepZone&&"off"!==r.stepZone&&(performance.now(),this.stepZone.render(this.canvas,{beatTick:c},{mode:i,mods:r}),performance.now()),this.guidelines&&(performance.now(),this.guidelines.render(this.canvas,{beatTick:c,timeTick:u},{mods:r}),performance.now()),"behind"===r.comboDisplay&&this.comboDisplay.render(this.canvas,this.globalParams.combo,{mode:i,mods:r}),U(this.globalParams),"cmod"===r.speed?(o=this.globalParams.timeWindowStartPtr,s=this.globalParams.timeWindowEndPtr):(o=this.globalParams.beatWindowStartPtr,s=this.globalParams.beatWindowEndPtr),this.bpmReel||(this.bpmReel=document.getElementById("bpmReel"),this.bpmReel.height=this.canvas.height,this.bpmReel.width=this.bpmReel.clientWidth),this.stopReel||(this.stopReel=document.getElementById("stopReel"),this.stopReel.height=this.canvas.height,this.stopReel.width=this.stopReel.clientWidth),r.bpmStopDisplay){(o.bpm<=s.bpm||o.stop<=s.stop)&&this.clearBpmAndStopDisplay();for(var d=o.bpm;d<=s.bpm;d++){var m=this.globalParams.bpmQueue[d];this.bpmAndStopDisplay.renderBpm(this.bpmReel,m,{beatTick:c,timeTick:u},{mods:r})}for(var f=o.stop;f<=s.stop;f++){var h=this.globalParams.stopQueue[f];this.bpmAndStopDisplay.renderStop(this.stopReel,h,{beatTick:c,timeTick:u},{mods:r})}}for(var p="double"===i?[2,6]:[2],v="double"===i?[0,1,3,4,5,7]:[0,1,3],g=s.shock;g>=o.shock;g--){var b=this.globalParams.shocks[g];b.render(this.canvas,this.globalParams.frame,{beatTick:c,timeTick:u},{mods:r})}for(var y=function(t){var a=e.globalParams.freezes[t];v.forEach((function(t){a.renderFreezeBody(e.canvas,{beatTick:c,timeTick:u},t,{mods:r})}))},w=s.freeze;w>=o.freeze;w--)y(w);for(var E=function(t){var a=e.globalParams.freezes[t];p.forEach((function(t){a.renderFreezeBody(e.canvas,{beatTick:c,timeTick:u},t,{mods:r})}))},O=o.freeze;O<=s.freeze;O++)E(O);for(var k=function(t){var a=e.globalParams.arrows[t];v.forEach((function(t){a.renderArrow(e.canvas,{beatTick:c,timeTick:u},t,{mods:r})}))},S=s.arrow;S>=o.arrow;S--)k(S);for(var C=function(t){var a=e.globalParams.arrows[t];p.forEach((function(t){a.renderArrow(e.canvas,{beatTick:c,timeTick:u},t,{mods:r})}))},P=o.arrow;P<=s.arrow;P++)C(P);for(var j in"inFront"===r.comboDisplay&&this.comboDisplay.render(this.canvas,this.globalParams.combo,{mode:i,mods:r}),["hidden","sudden","hiddensudden"].includes(r.appearance)&&r.laneCoverVisible&&this.laneCover.render(this.canvas,{mode:i,mods:r}),performance.now(),this.globalParams.targetFlashes){var T=this.globalParams.targetFlashes[j];T.frame++,T.frame>12?delete this.globalParams.targetFlashes[j]:T.render(this.canvas,{mods:r})}performance.now(),this.globalParams.frame++,t&&(this.mainLoopRequestRef=window.requestAnimationFrame(this.mainLoop.bind(this)))}}},{key:"drawBackground",value:function(){this.c.fillStyle="black",this.c.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"clearBpmAndStopDisplay",value:function(){if(this.bpmReel){var e=this.bpmReel.getContext("2d");e.fillStyle="black",e.fillRect(0,0,this.bpmReel.width,this.bpmReel.height)}if(this.stopReel){var t=this.stopReel.getContext("2d");t.fillStyle="black",t.fillRect(0,0,this.stopReel.width,this.stopReel.height)}}},{key:"restartTl",value:function(){this.tl.restart()}},{key:"pauseTl",value:function(){this.tl.pause()}},{key:"isTlPaused",value:function(){return this.tl.paused()}}]),e}(),Re=a(463),Me=a(461),Be=a(230),Fe=a.n(Be),Ve={Beginner:"b",Basic:"B",Difficult:"D",Expert:"E",Challenge:"C"},ze={single:"S",double:"D"},Ue=function(e){var t=e.modalOpen,a=e.setModalOpen,i=e.data,o=i.song,s=i.difficulty,l=i.mode,c=i.mods,u=Object(n.useRef)(),d=Object(n.useState)(""),m=Object(f.a)(d,2),p=m[0],v=m[1];if(Object(n.useEffect)((function(){!1===t&&v("")}),[t]),!o)return null;u.current=function(){var e=Ie.getProgress(),t={song:o.hash,difficulty:Ve[s]+ze[l]+"P",turn:"off"!==c.turn?c.turn:"",speed:c.speed.toString().replace(".",""),progress:parseInt(1e5*e)},a=Object.keys(t).map((function(e){return null===t[e]||"undefined"===typeof t[e]?null:"".concat(e,"=").concat(t[e])})).filter((function(e){return null!==e})).join("&");return E()+"?"+a}();return r.a.createElement(Re.a,{className:"shareModal",size:"fullscreen",open:t,onClose:function(){return a(!1)}},r.a.createElement(Re.a.Header,null,"Share link to chart"),r.a.createElement(Re.a.Content,null,r.a.createElement(Me.a,{type:"text",className:"share-url-input",value:u.current,action:!0},r.a.createElement("input",null),r.a.createElement(h.a,{onClick:function(){Fe()(u.current),v("Copied link to clipboard")}},"Copy")),r.a.createElement("p",null,p)))},He=a(63),We=function(e){var t=Object(n.useRef)(),a=Object(n.useRef)(),i=Object(n.useRef)(),o=Object(n.useRef)(),s=Object(_.a)({},e);delete s.onClick,Object(n.useEffect)((function(){var e=t.current.ref.current;e.removeEventListener("mousedown",i.current,!1),e.removeEventListener("mouseup",o.current,!1),e.removeEventListener("mouseleave",o.current,!1),e.removeEventListener("touchstart",i.current,!1),e.removeEventListener("touchend",o.current,!1),i.current=l,o.current=c,e.addEventListener("mousedown",i.current,!1),e.addEventListener("mouseup",o.current,!1),e.addEventListener("mouseleave",o.current,!1),e.addEventListener("touchstart",i.current,!1),e.addEventListener("touchend",o.current,!1)}),[e.onClick]);var l=function(t){t.preventDefault(),e.onClick&&e.onClick(t),a.current=requestAnimationFrame(u.bind(null,t))},c=function(e){e.preventDefault(),cancelAnimationFrame(a.current)},u=function t(n){e.onClick&&e.onClick(n),a.current=requestAnimationFrame(t.bind(null,n))};return r.a.createElement(h.a,Object.assign({},s,{ref:t}),e.children)},Xe=Object(l.b)((function(e){return{audio:e.audio.chartAudio}}),null)((function(e){var t=e.audio,a=e.controlsDisabled,n=e.setShareModalOpen;return r.a.createElement("div",{className:"play-controls"},r.a.createElement(We,{onClick:function(){return xe.goBack(20)},className:"play-control"},r.a.createElement(He.a,{name:"backward"})),r.a.createElement(h.a,{onClick:function(){a||("playing"===e.audio.status?xe.pause():xe.play())},disabled:a,className:"play-control"},r.a.createElement(He.a,{name:"playing"===t.status?"pause":"play"})),r.a.createElement(h.a,{onClick:function(){a||xe.stop()},className:"play-control"},r.a.createElement(He.a,{name:"stop"})),r.a.createElement(We,{onClick:function(){return xe.goForward(20)},className:"play-control"},r.a.createElement(He.a,{name:"forward"})),r.a.createElement(h.a,{onClick:function(){return n(!0)},className:"play-control share-btn",disabled:"playing"===t.status},r.a.createElement(He.a,{name:"share square"})))})),Ze=Object(l.b)((function(e){var t=e.songSelect;return{selectedSong:t.song,selectedDifficulty:t.difficulty,selectedMode:t.mode}}),null)((function(e){var t=e.selectedSong,a=e.selectedDifficulty,n=e.selectedMode;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"song-info-row"},r.a.createElement("div",{className:"song-information"},t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"song-title"},t.title),r.a.createElement("div",{className:"song-artist"},t.artist))),r.a.createElement("div",{className:"level-information"},t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"song-difficulty"},a),r.a.createElement("div",{className:"song-level"},t.levels["double"===n?y.indexOf(a)+5:b.indexOf(a)])))))})),Ye=document.createElement("canvas"),Qe=Ye.getContext("2d"),qe=new Image;qe.src=k("static_arrows.png");var Ge=new Image;Ge.src=k("static_freeze_tails_1.png");var Je=new Image;Je.src=k("static_freeze_body_1.png");var Ke=function(){function e(t){Object(I.a)(this,e),this.key=t.key,this.note=t.note,this.measureIdx=t.measureIdx,this.measureN=t.measureN,this.measureD=t.measureD,this.beatstamp=t.beatstamp,this.holdStartBeats=t.holdStartBeats,this.holdEndBeats=t.holdEndBeats,this.combo=t.combo}return Object(x.a)(e,[{key:"currentBeatPosition",value:function(e){return this.beatstamp-e}},{key:"renderFreezeBody",value:function(e,t,a,n){var r=t.beatTick,i=e.getContext("2d"),o=n.mods,s=n.columnIdx,l=n.columnHeight,c=o.speed;e.height;if("3"===this.note[a]){var u,d,m,f;g[a%4];u=a%4*32,d=0,m=32*a,m+=256*s+64,f=32*this.currentBeatPosition(r)*c;var h=32*(this.holdEndBeats[a]-this.holdStartBeats[a])*c-16,p=Math.floor(h/64),v=h%64,b=v,y=f-(h+16);y<=0&&(v+=y,y=0),i.drawImage(Je,0,64-v,32,v,m,(y+16)%l,32,v);for(var w=1;w<=p;w++){var E=64,O=0,k=f-(h+16-b-64*(w-1));k<0&&k>-64&&(E+=k,O-=k,k=0),i.drawImage(Je,0,O,32,E,m,(k+16)%l,32,E)}var S=32,C=32*(this.holdEndBeats[a]-this.holdStartBeats[a])*c;if(C<16){d+=16-C,f+=16-C,S=C+16}f<16&&f>-1&&(d+=16-f,f=16),i.drawImage(Ge,u,d,32,S,m,f%l,32,S)}}},{key:"renderArrow",value:function(e,t,a,n){var r=t.beatTick,i=e.getContext("2d"),o=n.mods,s=n.columnIdx,l=n.columnHeight,c=o.speed;e.height;if("1"===this.note[a]||"2"===this.note[a]){var u,d,m,f,h=g[a%4];u=32*g.indexOf(h);var p=this.measureN/this.measureD;d=[0,.25,.5,.75].includes(p)?0:[1/8,3/8,5/8,7/8].includes(p)?1:[1/16,3/16,5/16,7/16,9/16,.6875,.8125,.9375].includes(p)?3:2,d*=32,m=32*a,m+=256*s+64,f=32*this.currentBeatPosition(r)*c,f%=l,i.drawImage(qe,u,d,32,32,m,f,32,32)}}}]),e}(),$e=function(){function e(t){Object(I.a)(this,e),this.finalBeat=t}return Object(x.a)(e,[{key:"render",value:function(e,t,a){var n=t.beatTick,r=a.mods,i=a.columnIdx,o=a.columnWidth,s=a.measuresPerColumn,l=r.speed;if(r.guidelines){var c=e.getContext("2d");c.strokeStyle="#fff";for(var u=e.height,d=i*o+64,m=0;m<=4*s;m++){if(4*s*i+m>=this.finalBeat)return;var f=32*(m-n)*l+16,h=m%4===0?2:1;(f=f+.5|0)>0&&f<u&&(c.beginPath(),c.moveTo(d,f),c.lineTo(d+o/2,f),c.lineWidth=h,c.stroke())}}}}]),e}(),et=Object(l.b)((function(e){var t=e.mods,a=e.songSelect,n=e.screen,r=e.simfiles,i=a.song,o=a.difficulty,s=a.mode;return{mods:t,sm:r.sm,song:i,difficulty:o,mode:s,screen:n}}),(function(e){return{}}))((function(e){var t=e.modalOpen,a=e.setModalOpen,i=e.gameEngine,o=Object(n.useRef)(null),s=Object(n.useState)(1),l=Object(f.a)(s,2),c=l[0],u=l[1],d=Object(n.useState)(1),m=Object(f.a)(d,2),h=m[0],p=m[1];Object(n.useEffect)((function(){var e=o.current;if(e){var t=e.getContext("2d");console.log(i.globalParams);var a=i.globalParams,n=a.shocks,r=a.frame,s=i.globalParams.arrows.map((function(e){return new Ke(e)})),l=i.globalParams.freezes.map((function(e){return new Ke(e)})),c=i.globalParams.mods;c=JSON.parse(JSON.stringify(c));var d={beatTick:0,timeTick:0};c.speed=1;var m=c.speed,f=i.globalParams.finalBeat/4,h=128*m*8;u(h+=32);var v=Math.ceil(f/8),g=256*v;p(g),t.fillStyle="black",t.fillRect(0,0,g,h);for(var b=0;b<v;b++){var y=256*b+64;t.fillStyle="black",t.fillRect(y,0,128,h),new $e(i.globalParams.finalBeat).render(e,d,{mods:c,columnIdx:b,columnWidth:256,measuresPerColumn:8})}for(var w=0;w<n.length;w++){var E=n[w];E.render(e,r,d,{mods:c,staticAttrs:{columnIdx:Math.floor(E.measureIdx/8),columnHeight:128*m*8}})}for(var O=function(t){var a=l[t];[0,1,2,3].forEach((function(t){a.renderFreezeBody(e,d,t,{mods:c,columnIdx:Math.floor(a.measureIdx/8),columnHeight:128*m*8})}))},k=0;k<l.length;k++)O(k);for(var S=function(t){var a=s[t];[0,1,2,3].forEach((function(t){a.renderArrow(e,d,t,{mods:c,columnIdx:Math.floor(a.measureIdx/8),columnHeight:128*m*8})}))},C=0;C<s.length;C++)S(C);!function(e,t){var a=e.width,n=e.height;Ye.width=a,Ye.height=n,Qe.drawImage(e,0,0),e.width*=t,e.height*=t,e.getContext("2d").drawImage(Ye,0,0,a,n,0,0,a*t,n*t)}(e,.5)}}),[t,c,h]);var v=function(e){for(var t=i.globalParams.allArrows,a=0;a<t.length;a++){var n=t[a];if(n.beatstamp>e)return a-1>=0?t[a-1].timestamp:n.timestamp}return t[t.length-1].timestamp},g=function(){a(!1)};return r.a.createElement(Re.a,{className:"staticModal",open:t,onOpen:function(){a(!0)},onClose:g},r.a.createElement("div",{className:"staticChart-container"},r.a.createElement("canvas",{id:"staticChart",ref:o,height:c,width:h,onClick:function(e){var t=o.current.getBoundingClientRect(),a=32+t.x;if(!(e.clientX<a)){if(!((e.clientX-a)%128>64)){var n=Math.floor((e.clientX-a)/128),r=8+t.y;if(!(e.clientY<r)){var i=e.clientY-r,s=Math.floor(i/16);if(!(s>=32)){var l=v(8*n*4+s);xe.seekTime(l),g()}}}}}})))})),tt=Object(l.b)(null,(function(e){return{updateMods:function(t){return e(he(t))},updateLaneCoverHeight:function(t){return e((a=t,function(e){e({type:"UPDATE_LANE_COVER_HEIGHT",payload:a})}));var a}}}))((function(e){var t=e.canvas,a=e.mods,i=e.updateMods,o=e.updateLaneCoverHeight,s=Object(n.useRef)(),l=function(e){if((38===e.keyCode||40===e.keyCode)&&(e.preventDefault(),["hidden","sudden","hiddensudden"].includes(a.appearance))){var n=[0,0,0],r="reverse"===a.scroll?-1:1;if(38===e.keyCode)switch(a.appearance){case"hidden":n[0]-=4*r;break;case"sudden":n[1]+=4*r;break;case"hiddensudden":n[2]+=4}else if(40===e.keyCode)switch(a.appearance){case"hidden":n[0]+=4*r;break;case"sudden":n[1]-=4*r;break;case"hiddensudden":n[2]-=4}o({diff:n,canvasHeight:t.height})}};return Object(n.useEffect)((function(){document.removeEventListener("keydown",s.current),s.current=l,document.addEventListener("keydown",s.current)}),[a.appearance,a.scroll,a.laneCoverHeight,t]),r.a.createElement("div",{className:"cab-buttons-container"},r.a.createElement(We,{className:"directional-button",onClick:function(e){e.keyCode=38,l(e)}},r.a.createElement("img",{src:k("directional_button.png")})),r.a.createElement(h.a,{className:"center-button",onClick:function(e){!function(e){e.preventDefault();var t=a.laneCoverVisible;i({laneCoverVisible:!t})}(e)}},r.a.createElement("img",{src:k("center_button.png")})),r.a.createElement(We,{className:"directional-button",onClick:function(e){e.keyCode=40,l(e)}},r.a.createElement("img",{src:k("directional_button.png")})))})),at=Object(l.b)((function(e){return{mods:e.mods,songSelect:e.songSelect}}),null)((function(e){e.mods,e.songSelect;return r.a.createElement("div",{className:"bpm-display"},r.a.createElement("canvas",{id:"bpmReel"}),r.a.createElement("div",{className:"current-bpm-container "},r.a.createElement("div",{className:"current-bpm-wrapper"},r.a.createElement("div",{className:"current-bpm-header"},"BPM"),r.a.createElement("div",{className:"current-bpm-value"}))))})),nt=Object(l.b)((function(e){return{mods:e.mods,songSelect:e.songSelect}}),null)((function(e){e.mods,e.songSelect;return r.a.createElement("div",{className:"stop-display"},r.a.createElement("canvas",{id:"stopReel"}))})),rt=Object(l.b)((function(e){var t=e.mods,a=e.songSelect,n=e.screen,r=e.simfiles;return{mods:t,selectedSong:a.song,selectedDifficulty:a.difficulty,selectedMode:a.mode,screen:n,sm:r.sm}}),(function(e){return{}}))((function(e){var t=e.selectedDifficulty,a=e.selectedMode,i=e.selectedSong,o=e.sm,s=e.mods,l=e.screen,c=e.loadingAudio,u=e.gameEngine,d=e.setGameEngine,m=Object(n.useState)(null),p=Object(f.a)(m,2),v=p[0],g=p[1],b=Object(n.useState)(!1),y=Object(f.a)(b,2),w=y[0],E=y[1],O=Object(n.useRef)(),k=Object(n.useRef)(),C=Object(n.useRef)(),j=Object(n.useState)(!1),T=Object(f.a)(j,2),L=T[0],D=T[1],_=function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e})),t.current||e}({canvas:v,sm:o,selectedDifficulty:t,selectedMode:a,mods:s});Object(n.useEffect)((function(){O.current=document.querySelector("#chartArea"),g(O.current),Ie.initCanvas()}),[]),Object(n.useEffect)((function(){v&&k.current&&I()}),[v,a,l]);var I=function(){if("single"===a)O.current.width=256,O.current.style.transform="none",O.current.style.left=0,O.current.style.top=0,O.current.style.position="static",setTimeout((function(){O.current.style.position="relative"}));else if("double"===a){O.current.width=512;var e=k.current.getBoundingClientRect();if(e.width<512){var t=e.width/O.current.width,n=(O.current.width-e.width)/2,r=n*(7/8);O.current.style.transform="scale(".concat(t,") translate(-50%)"),O.current.style.position="absolute",O.current.style.left="-".concat(n,"px"),O.current.style.top="-".concat(r,"px")}else O.current.style.transform="none",O.current.style.left=0,O.current.style.top=0,O.current.style.position="static",setTimeout((function(){O.current.style.position="relative"}))}u&&u.updateLoopOnce()};Object(n.useEffect)((function(){var e={canvas:v,sm:o,selectedDifficulty:t,selectedMode:a,mods:s};if(v){var n={mode:a,difficulty:t,mods:s};Object.keys(e).forEach((function(t){if(_[t]!==e[t])if("canvas"===t);else if("sm"===t){if(u&&(u.killed=!0),!o)return;var a=i.useSsc?"ssc":"sm",r=(i.levels.filter((function(e){return e})).length,A(o,a)),s=new Ne(v,r,n);s.pauseTl(),d(s)}else"mods"===t?Object.keys(_.mods).forEach((function(t){var a=JSON.stringify(_.mods[t]),r=JSON.stringify(e.mods[t]);u&&a!==r&&("bpmStopDisplay"===t&&(u.bpmReel=e.mods[t]?document.getElementById("bpmReel"):null,u.stopReel=e.mods[t]?document.getElementById("stopReel"):null),["turn","shuffle"].includes(t)?u.resetChart(n):u.isTlPaused()&&u.updateLoopOnce())})):u&&u.resetChart(n)})),u&&u.updateExternalGlobalParams({mods:s})}}),[v,o,t,a,s]);var x={song:i,difficulty:t,mode:a,mods:s};return r.a.createElement("div",{className:"view-section chartView ".concat("chart"===l.activeView?"active":"")},r.a.createElement("div",{className:"view-wrapper chartArea-container"},r.a.createElement("div",{className:"canvas-container ".concat(a," ").concat(s.scroll),ref:k},r.a.createElement("div",{className:"chartArea-wrapper"},u&&r.a.createElement(at,{bpmQueue:u.globalParams.bpmQueue}),u&&r.a.createElement(nt,{stopQueue:u.globalParams.stopQueue}),r.a.createElement("div",{className:"canvas-wrapper"},r.a.createElement("canvas",{id:"chartArea",width:"256",height:"448"}),r.a.createElement("div",{className:"chart-loading-screen ".concat(a," ").concat(c?"loading":""," "),ref:C},i&&r.a.createElement("img",{className:"chart-loading-jacket",src:S("".concat(i.hash,".png"))}),r.a.createElement("div",{className:"chart-loading-message"},"Loading chart...")),i&&!c&&["hidden","sudden","hiddensudden"].includes(s.appearance)&&r.a.createElement(tt,{mods:s,canvas:v})))),r.a.createElement("div",{className:"progress-container"},r.a.createElement("div",{className:"progress-wrapper"},r.a.createElement("canvas",{id:"progress"}),P.progress?r.a.createElement("div",{className:"preset-marker-wrapper",onClick:Ie.jumpToPresetStart.bind(Ie),onTouchStart:Ie.jumpToPresetStart.bind(Ie)},r.a.createElement("div",{className:"preset-marker"})):null)),r.a.createElement("div",{className:"row"},r.a.createElement(Xe,{controlsDisabled:!u||c,setShareModalOpen:E})),r.a.createElement("div",{className:"row song-info-area"},r.a.createElement(Ze,null),i&&r.a.createElement("div",null,r.a.createElement(h.a,{className:"view-static-btn",onClick:function(){return D(!0)}},"View static chart"))),r.a.createElement(Ue,{modalOpen:w,setModalOpen:E,data:x}),u&&r.a.createElement(et,{modalOpen:L,setModalOpen:D,gameEngine:u})))})),it=a(464),ot=a(122),st=a.n(ot),lt=function(e){var t=e.selectedSongOption,a=e.onSongSelect,n=e.simfileOptions;return r.a.createElement(it.a,{placeholder:"Choose a song",className:"song-title-search",search:function(e,t){var a=new RegExp(st()(t),"i");return e.filter((function(e){return a.test(e.text)||a.test(e.description)}))},selection:!0,value:t,onChange:function(e,t){return a(t.value)},options:n,selectOnBlur:!1,selectOnNavigation:!1})},ct=function(e,t,a){var n="double"===a?y:b,r="double"===a?e.levels.slice(5,9):e.levels.slice(0,5);if(["Difficult","Expert","Challenge"].includes(t)){for(var i=n.length-1;i>=0;i--)if(r[i]&&!e.missingDifficulties.includes("double"===a?i+5:i))return n[i]}else if(["Beginner","Basic"].includes(t))for(var o=0;o<=n.length-1;o++)if(r[o]&&!e.missingDifficulties.includes("double"===a?o+5:o))return n[o]},ut=function(e){var t=e.displayedSongs,a=e.onSongSelect,n=e.selectedSongOption,i=e.selectedMode,o=e.selectedDifficultyOption,s=e.selectedFilters,l=e.isChartAvailable,c=t;e.gameEngine&&e.gameEngine.simfiles&&e.gameEngine.simfiles;var u=function(e){return function(e){var t=[];"single"===i?t=e.levels.slice(0,5):"double"===i&&(t=[null].concat(Object(D.a)(e.levels.slice(5,9))));var a=s.level,n=s.difficulty;if("all"===n&&"all"===a){var r=[null,null,null,null,null],l=b.indexOf(o);if(t[l])r[l]=t[l];else{var c=ct(e,o,i),u=b.indexOf(c);r[u]=t[u]}t=r}else t.forEach((function(e,r){if(e){var i=b[r];"all"===n?e!==a&&(t[r]=null):i!==n&&(t[r]=null)}}));return t}(e).map((function(t,a){if(!t)return null;var n=b[a];return r.a.createElement("div",{key:"".concat(e.hash,"_").concat(n),className:"song-level ".concat(n)},t)}))},d=function(e){return r.a.createElement("div",{className:"songTile-wrapper ".concat(l(e)?"":"unavailable"),key:"songtile_".concat(e.hash),onClick:function(){return function(e){a(e.hash)}(e)}},r.a.createElement("div",{className:"songTile ".concat(n===e.hash?"selected":""," ")},r.a.createElement("div",{className:"song-jacket-wrapper"},r.a.createElement("img",{className:"song-jacket",src:S("".concat(e.hash,".png")),title:e.title,alt:e.title})),r.a.createElement("div",{className:"song-level-wrapper"},u(e)),r.a.createElement("div",{className:"song-title-bar"},e.title)))};return r.a.createElement("div",{className:"songGrid"},c.map((function(e){return d(e)})))},dt=function(e){var t=e.option1,a=e.option2,n=e.value,i=e.disabled,o=function(t){!i&&t&&"undefined"!==typeof t.value&&e.onChange(t.value)};return r.a.createElement("div",{className:"toggleSwitch-wrapper ".concat(i?"disabled":"")},r.a.createElement("label",{className:"toggleSwitch-option1 ".concat(n===t.value?"selected":""),onClick:function(){return o(t)}},t.text),r.a.createElement("div",{className:function(){var e="toggleSwitch";return n===t.value?e+=" left":n===a.value&&(e+=" right"),e}(),onClick:function(){!i&&t&&a&&(n===t.value?e.onChange(a.value):(a.value,e.onChange(t.value)))}}),r.a.createElement("label",{className:"toggleSwitch-option2 ".concat(n===a.value?"selected":""),onClick:function(){return o(a)}},a.text))},mt=[{key:"title_all",value:"all",text:"ALL"}].concat(["\u3042","\u304b","\u3055","\u305f","\u306a","\u306f","\u307e","\u3084","\u3089","\u308f","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","NUM"].map((function(e){return{key:"title_".concat(e),value:e,text:e}}))),ft=[{key:"version_all",value:"all",text:"ALL"}].concat(["DDR 1st","DDR 2ndMIX","DDR 3rdMIX","DDR 4thMIX","DDR 5thMIX","DDRMAX","DDRMAX2","DDR EXTREME","DDR SuperNOVA","DDR SuperNOVA 2","DDR X","DDR X2","DDR X3 VS 2ndMIX","DDR (2013)","DDR (2014)","DDR A","DDR A20","DDR A20 PLUS"].map((function(e,t){return{key:"version_".concat(t),value:t,text:e}})).reverse()),ht=[{key:"level_all",value:"all",text:"ALL"}].concat([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19].map((function(e){return{key:"level_".concat(e),value:e,text:e}}))),pt=[{key:"difficulty_all",value:"all",text:"ALL"}].concat(b.map((function(e){return{key:"difficulty_".concat(e),value:e,text:e}}))),vt=[{key:"bpm_all",value:"all",text:"ALL"}].concat(w.map((function(e){return{key:"bpm_".concat(e),value:e,text:1===e?"~ 100":"".concat(e," ~")}})));function gt(){return(gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function bt(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var yt=r.a.createElement("path",{id:"Line_1","data-name":"Line 1",d:"M0.91,15L0.78,15A1,1,0,0,0,0,16v6a1,1,0,1,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H0.91Z"}),wt=r.a.createElement("path",{id:"Line_2","data-name":"Line 2",d:"M6.91,9L6.78,9A1,1,0,0,0,6,10V28a1,1,0,1,0,2,0s0,0,0,0V10A1,1,0,0,0,7,9H6.91Z"}),Et=r.a.createElement("path",{id:"Line_3","data-name":"Line 3",d:"M12.91,0L12.78,0A1,1,0,0,0,12,1V37a1,1,0,1,0,2,0s0,0,0,0V1a1,1,0,0,0-1-1H12.91Z"}),Ot=r.a.createElement("path",{id:"Line_4","data-name":"Line 4",d:"M18.91,10l-0.12,0A1,1,0,0,0,18,11V27a1,1,0,1,0,2,0s0,0,0,0V11a1,1,0,0,0-1-1H18.91Z"}),kt=r.a.createElement("path",{id:"Line_5","data-name":"Line 5",d:"M24.91,15l-0.12,0A1,1,0,0,0,24,16v6a1,1,0,0,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H24.91Z"}),St=r.a.createElement("path",{id:"Line_6","data-name":"Line 6",d:"M30.91,10l-0.12,0A1,1,0,0,0,30,11V27a1,1,0,1,0,2,0s0,0,0,0V11a1,1,0,0,0-1-1H30.91Z"}),Ct=r.a.createElement("path",{id:"Line_7","data-name":"Line 7",d:"M36.91,0L36.78,0A1,1,0,0,0,36,1V37a1,1,0,1,0,2,0s0,0,0,0V1a1,1,0,0,0-1-1H36.91Z"}),Pt=r.a.createElement("path",{id:"Line_8","data-name":"Line 8",d:"M42.91,9L42.78,9A1,1,0,0,0,42,10V28a1,1,0,1,0,2,0s0,0,0,0V10a1,1,0,0,0-1-1H42.91Z"}),jt=r.a.createElement("path",{id:"Line_9","data-name":"Line 9",d:"M48.91,15l-0.12,0A1,1,0,0,0,48,16v6a1,1,0,1,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H48.91Z"}),Tt=function(e){var t=e.svgRef,a=e.title,n=bt(e,["svgRef","title"]);return r.a.createElement("svg",gt({id:"audioWave","data-name":"Layer 1",viewBox:"0 0 50 38.05",ref:t},n),a?r.a.createElement("title",null,a):null,yt,wt,Et,Ot,kt,St,Ct,Pt,jt)},Lt=r.a.forwardRef((function(e,t){return r.a.createElement(Tt,gt({svgRef:t},e))})),At=(a.p,pe()),Dt=Object(l.b)((function(e){var t=e.audio,a=e.songSelect,n=e.screen,r=e.simfiles;return{previewAudio:t.previewAudio,simfileList:r.simfileList,selectedDifficulty:a.difficulty,selectedMode:a.mode,previousSong:a.song,activeView:n.activeView}}),(function(e){return{selectSong:function(t){return e(Le(t))}}}))((function(e){var t=e.simfileList,a=e.selectedDifficulty,i=e.selectedMode,o=e.previewAudio,s=Object(n.useRef)(),l=t.map((function(e){return{key:e.hash,value:e.hash,text:e.title,description:e.smName}})),c=Object(n.useState)(""),u=Object(f.a)(c,2),h=u[0],p=u[1],v=Object(n.useState)(a),g=Object(f.a)(v,2),E=g[0],O=g[1],k=Object(n.useState)(!0),C=Object(f.a)(k,2),j=(C[0],C[1]),T=Object(n.useState)(At.filters||{title:"all",version:16,level:"all",difficulty:"all",bpm:"all"}),L=Object(f.a)(T,2),A=L[0],D=L[1],I=function(e){var t=Object(_.a)(Object(_.a)({},A),e);ve({filters:t}),D(t)},x=Object(n.useState)([]),N=Object(f.a)(x,2),R=N[0],M=N[1];Object(n.useEffect)((function(){var e=A.title,a=A.version,n=A.level,r=A.difficulty,o=A.bpm,l=t.filter((function(t){var r=t.levels.slice(0,5),s=t.levels.slice(5,9);return("all"===e||e===t.abcSort)&&("all"===a||a===parseInt(t.version))&&("all"===o||function(e,t,a){if(e.displayBpm.includes(","))return!1;var n,r=e.displayBpm.split("-"),i=parseInt(r[r.length-1]),o=w.indexOf(t);return n=o+1>=w.length?1/0:w[o+1],t<=i&&i<n}(t,o))&&("all"===n&&"single"===i&&r.some((function(e){return!!e}))||"all"===n&&"double"===i&&s.some((function(e){return!!e}))||"single"===i&&t.levels.slice(0,5).includes(n)||"double"===i&&t.levels.slice(5,9).includes(n))})).filter((function(e){if("all"!==r)if("all"===n){if("single"===i)return null!==e.levels[b.indexOf(r)];if("double"===i)return null!==e.levels[y.indexOf(r)+5]}else{if("single"===i)return e.levels[b.indexOf(r)]===n;if("double"===i)return e.levels[y.indexOf(r)+5]===n}return e})).sort((function(e,t){if("all"!==o){var a=e.displayBpm.split("-"),n=parseInt(a[a.length-1]),r=t.displayBpm.split("-"),i=parseInt(r[r.length-1]);return n>i?1:n<i?-1:0}return 0}));M(l),s.current.scrollTop=0}),[A,i]);var B=Object(n.useState)(null),F=Object(f.a)(B,2),z=F[0],U=F[1];Object(n.useEffect)((function(){document.body.click(),P.song?W(P.song,{preserveShareUrl:!0}):At.song?W(At.song):W("99OQb9b0IQ98P6IQdPOiqi8q16o16iqP"),j(!1)}),[]),Object(n.useEffect)((function(){if(h){var e=t.find((function(e){return e.hash===h}));U(e),xe.storeAudioSource(e)}}),[h]);var H=function(t){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,r=b.indexOf(E);"double"===n&&(r+=4),a=t.levels[r]&&!t.missingDifficulties.includes(r)?E:ct(t,E,n),e.onDifficultySelect(a)},W=function(){var a=Object(m.a)(d.a.mark((function a(n){var r,o,s,l,c,u,m,f,h=arguments;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=h.length>1&&void 0!==h[1]?h[1]:{},xe.stopSongPreview(),z&&(xe.killImmediately(z.hash),V()),p(n),o=t.find((function(e){return e.hash===n})),s=0,e.previousSong||(s=ge()),P.song===n&&P.progress?s=P.progress/1e5:P.progress=0,a.next=10,e.onSongSelect(o,s);case 10:if(Ce.lastRequestedSong===o.title){a.next=12;break}return a.abrupt("return");case 12:if("all"!==A.level||"all"!==A.difficulty){a.next=16;break}H(o),a.next=35;break;case 16:if("all"===A.level||"all"!==A.difficulty){a.next=34;break}if(!(l="double"===i?o.levels.slice(5,9):o.levels.slice(0,5)).includes(A.level)){a.next=31;break}c=0;case 20:if(!(c<l.length)){a.next=29;break}if(l[c]!==A.level){a.next=26;break}return u="double"===i?y:b,e.onDifficultySelect(u[c]),a.abrupt("break",29);case 26:c++,a.next=20;break;case 29:a.next=32;break;case 31:H(o);case 32:a.next=35;break;case 34:"all"!==A.difficulty&&"all"===A.level?(m=b.indexOf(A.difficulty),"double"===i&&(m+=4),"number"===typeof o.levels[m]?e.onDifficultySelect(A.difficulty):H(o)):"all"!==A.difficulty&&"all"!==A.level&&(f=b.indexOf(A.difficulty),"double"===i&&(f+=4),o.levels[f]===A.level?e.onDifficultySelect(A.difficulty):H(o));case 35:r.preserveShareUrl||window.history.pushState(null,null,".");case 36:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,a=b.indexOf(E);return"double"===t&&(a+=4),!e.missingDifficulties.includes(a)};return r.a.createElement("div",{className:"view-section songView ".concat("song"===e.activeView?"active":"")},r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("form",{className:"songForm"},r.a.createElement("div",{className:"form-inner-wrapper"},r.a.createElement("div",{className:"selectedSong"},r.a.createElement("div",{className:"selectedSong-jacket-wrapper ".concat("playing"===o.status?"playing":"")},r.a.createElement("div",{className:"selectedSong-jacket-overlay"},r.a.createElement(Lt,null)),r.a.createElement("img",{className:"selectedSong-jacket",src:S("".concat(h,".png")),alt:"Selected song",onClick:function(){xe.currentPreview===z.hash?"playing"===o.status?xe.stopSongPreview():xe.playSongPreview(z):("playing"===o.status&&xe.stopSongPreview(),xe.playSongPreview(z))}})),r.a.createElement("div",{className:"selectedSong-info"},r.a.createElement(lt,{selectedSongOption:h,onSongSelect:W,simfileOptions:l}),r.a.createElement("div",{className:"song-artist"},z&&z.artist),r.a.createElement("div",{className:"song-difficulties"},function(){if(!z)return null;var t,n={};return e.gameEngine&&e.gameEngine.simfiles&&(n=e.gameEngine.simfiles),"single"===i?t=z.levels.slice(0,5):"double"===i&&(t=z.levels.slice(5,9)),t.map((function(t,o){if(!t)return null;var s="double"===i?y[o]:b[o],l=n.hasOwnProperty("".concat(i,"_").concat(s));return r.a.createElement("div",{className:"song-difficulty ".concat(s," ").concat(a===s?"selected":""," ").concat(l?"":"unavailable"),key:"".concat(i,"-difficulty_").concat(s),onClick:function(){return function(t){O(t),e.onDifficultySelect(t)}(s)},title:l?null:"Chart currently unavailable."},r.a.createElement("div",{className:"difficulty"},s),r.a.createElement("div",{className:"level"},t))}))}()),r.a.createElement("div",{className:"song-mode"},r.a.createElement(dt,{option1:{text:"Single",value:"single"},option2:{text:"Double",value:"double"},onChange:function(t){X(z,t)||H(z,t),e.onModeSelect(t)},value:i,disabled:!z||!i||"Beginner"===a||("single"===i?!z.levels.slice(5,9).filter((function(e){return e})).length:"double"!==i||!z.levels.slice(0,5).filter((function(e){return e})).length)})),r.a.createElement("div",{className:"bpm-display-container"},r.a.createElement("div",{className:"bpm-display-label"},"BPM"),r.a.createElement("div",{className:"bpm-display-value"},function(){if(!z)return null;var e=z.displayBpm;if(e.includes(",")){var t=b.indexOf(a);"double"===i&&(t+=4),e=e.split(",")[t]}return e}())))),r.a.createElement("div",{className:"songForm-filters"},r.a.createElement("div",{className:"songForm-filters-row"},r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Title"),r.a.createElement(it.a,{className:"title-filter-dropdown",selection:!0,value:A.title,onChange:function(e,t){return I({title:t.value})},options:mt,upward:!1}),r.a.createElement("label",null,"By BPM Range"),r.a.createElement(it.a,{className:"bpm-filter-dropdown",selection:!0,value:A.bpm,onChange:function(e,t){I({bpm:t.value})},options:vt,upward:!1})),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Version"),r.a.createElement(it.a,{className:"version-filter-dropdown",selection:!0,value:A.version,onChange:function(e,t){return I({version:t.value})},options:ft,upward:!1})),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Level"),r.a.createElement(it.a,{className:"level-filter-dropdown",selection:!0,value:A.level,onChange:function(e,t){return I({level:t.value})},options:ht,upward:!1}),r.a.createElement("label",null,"By Difficulty"),r.a.createElement(it.a,{className:"difficulty-filter-dropdown",selection:!0,value:A.difficulty,onChange:function(e,t){return I({difficulty:t.value})},options:pt,upward:!1})))))),r.a.createElement("div",{className:"songGrid-container",ref:s},r.a.createElement(ut,{displayedSongs:R,onSongSelect:W,selectedSongOption:h,selectedMode:i,selectedDifficultyOption:E,selectedFilters:A,isChartAvailable:X,gameEngine:e.gameEngine}))))})),_t=a(462),It=a(452),xt=Object(l.b)((function(e){var t=e.mods,a=e.songSelect,n=e.screen;return{mods:t,mode:a.mode,song:a.song,difficulty:a.difficulty,activeView:n.activeView}}),(function(e){return{updateMods:function(t){return e(he(t))}}}))((function(e){var t=e.mods,a=e.updateMods,i=e.mode,o=e.song,s=e.difficulty;Object(n.useEffect)((function(){a({turn:"off"})}),[i,o,s]);return r.a.createElement("div",{className:"view-section modsView ".concat("mods"===e.activeView?"active":"")},r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("form",{className:"modsForm"},r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Speed",o&&r.a.createElement("span",{className:"form-sublabel"},"(Effective scroll speed:"," ",r.a.createElement("strong",null,function(){if(!o)return null;var e;if("cmod"===t.speed)return e=t.cmod<100||t.cmod>1e3?550:t.cmod,r.a.createElement("strong",null,e);if((e=o.displayBpm).includes(",")){var a=b.indexOf(s);"double"===i&&(a+=4),e=e.split(",")[a]}var n=e.split("-"),l=Object(f.a)(n,2),c=l[0],u=l[1];return u?r.a.createElement("strong",null,"".concat(Math.round(c*t.speed)," - ").concat(Math.round(u*t.speed))):r.a.createElement("strong",null,Math.round(c*t.speed))}()),")")),ye.mods.speed.map((function(e){return r.a.createElement(_t.a,{key:"speed_".concat(e),label:"".concat(e,"x"),name:"speed",value:e,checked:t.speed===e,onChange:function(){return a({speed:e})}})})),r.a.createElement("div",null,r.a.createElement(_t.a,{key:"speed_cmod",label:"Cmod",name:"speed",value:"cmod",checked:"cmod"===t.speed,onChange:function(){return a({speed:"cmod"})}}),r.a.createElement(Me.a,{type:"number",disabled:"cmod"!==t.speed,min:100,max:1e3,name:"cmod",value:t.cmod,onChange:function(e,t){return a({cmod:t.value})},onBlur:function(e){var t=e.target.value;(!t||parseInt(t)<100||parseInt(t)>1e3)&&a({cmod:550})}})),r.a.createElement("small",null,"(Valid range: 100-1000; default: ",550,")")),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Appearance"),ye.mods.appearance.map((function(e,n){return r.a.createElement(_t.a,{key:"appearance_".concat(e),label:["Visible","Hidden+","Sudden+","Hidden+ / Sudden+","Stealth"][n],name:"appearance",value:e,checked:t.appearance===e,onChange:function(){return a({appearance:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Arrow color"),ye.mods.noteskin.map((function(e){return r.a.createElement(_t.a,{key:"noteskin_".concat(e),label:C(e),name:"noteskin",value:e,checked:t.noteskin===e,onChange:function(){return a({noteskin:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Turn"),ye.mods.turn.filter((function(e){return"double"!==i||("off"===e||"mirror"===e)})).map((function(e){return r.a.createElement(_t.a,{key:"turn_".concat(e),label:C(e),name:"turn",value:e,checked:t.turn===e,onChange:function(){return a({turn:e})}})}))),"shuffle"===t.turn&&r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Shuffle pattern",r.a.createElement("span",{className:"form-sublabel"},"(compare to original LDUR)")),ye.mods.shuffle.map((function(e,n){return r.a.createElement(_t.a,{key:"shuffle_".concat(e),label:["LRDU","UDRL","LRUD","DURL","DLUR","DULR","RLUD","RULD"][n],name:"shuffle",value:e,checked:t.shuffle===e,onChange:function(){return a({shuffle:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Step zone"),ye.mods.stepZone.map((function(e){return r.a.createElement(_t.a,{key:"stepZone_".concat(e),label:C(e),name:"stepZone",value:e,checked:t.stepZone===e,onChange:function(){return a({stepZone:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Scroll"),ye.mods.scroll.map((function(e){return r.a.createElement(_t.a,{key:"scroll_".concat(e),label:C(e),name:"scroll",value:e,checked:t.scroll===e,onChange:function(){return a({scroll:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Combo display"),ye.mods.comboDisplay.map((function(e,n){return r.a.createElement(_t.a,{key:"comboDisplay_".concat(e),label:["Behind arrows","In front of arrows","Hidden"][n],name:"comboDisplay",value:e,checked:t.comboDisplay===e,onChange:function(){return a({comboDisplay:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Combo font"),ye.mods.comboFont.map((function(e){return r.a.createElement(_t.a,{key:"comboFont_".concat(e),label:e,name:"comboFont",value:e,checked:t.comboFont===e,onChange:function(){return a({comboFont:e})}})}))),r.a.createElement("h4",null,"Miscellaneous"),r.a.createElement("div",{className:"form-field"},r.a.createElement(It.a,{toggle:!0,label:"Guidelines",name:"guidelines",checked:t.guidelines,onChange:function(){return a({guidelines:!t.guidelines})}})),r.a.createElement("div",{className:"form-field"},r.a.createElement(It.a,{toggle:!0,label:"Color freeze heads",name:"colorFreezes",checked:t.colorFreezes,onChange:function(){return a({colorFreezes:!t.colorFreezes})}})),r.a.createElement("div",{className:"form-field"},r.a.createElement(It.a,{toggle:!0,label:"Scrolling BPM/stop values",name:"bpmStopDisplay",checked:t.bpmStopDisplay,onChange:function(){return a({bpmStopDisplay:!t.bpmStopDisplay})}})),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Global offset"),r.a.createElement(Me.a,{type:"range",name:"globalOffset",min:"-0.20",max:"0.20",step:"0.01",value:t.globalOffset,onChange:function(e,t){return a({globalOffset:parseFloat(t.value)})}}),r.a.createElement("span",null,t.globalOffset)))))}));function Nt(){return(Nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Rt(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Mt=r.a.createElement("style",null,"\n\t\ttspan { white-space:pre }\n\t\t.shp0 { fill: #020202 } \n\t"),Bt=r.a.createElement("path",{id:"Path 0",className:"shp0",d:"M16.49 17L1.5 32C30.16 60.67 31.81 62.01 35 61.99C37.45 61.97 39.33 61.14 41.27 59.23C43.27 57.26 44.03 55.53 44.01 53C43.98 50.32 43.09 48.61 40.24 45.73L36.5 41.97L54.5 42.03C60.51 35.97 61.98 33.52 62 32C62.02 30.41 60.66 28.14 58.27 25.76L54.5 22.03L36.5 22.03C43.09 15.39 43.98 13.68 44.01 11C44.03 8.47 43.27 6.74 41.27 4.77C39.32 2.85 37.45 2.03 34.99 2.02C31.78 2 30.15 3.32 16.49 17ZM89.49 5.79L85.58 9.58L86.03 27.5C79.22 20.74 77.75 20.03 74.61 20.01C71.58 20 70.19 20.61 68.37 22.75C66.91 24.47 66.03 26.81 66.01 29C65.99 32.19 67.33 33.84 81 47.5L96 62.5C124.67 33.84 126.01 32.19 125.99 29C125.97 26.55 125.14 24.67 123.23 22.73C121.43 20.9 119.47 19.96 117.49 19.98C115.46 19.99 113.1 21.22 110.23 23.75L105.97 27.5L106.03 9.5C99.91 3.43 97.54 2.02 95.95 2.01C94.34 2.01 91.96 3.4 89.49 5.79ZM144.5 16.76C130.41 30.65 129.54 31.73 129.78 35.01C129.94 37.22 131.03 39.51 132.77 41.27C134.74 43.27 136.47 44.03 139 44.01C141.68 43.98 143.39 43.09 146.27 40.24L150.03 36.5L149.97 54.5C156.03 60.51 158.48 61.98 160 62C161.59 62.02 163.86 60.66 166.24 58.27L169.97 54.5L169.97 36.5C176.61 43.09 178.32 43.98 181 44.01C183.53 44.03 185.26 43.27 187.23 41.27C189.14 39.33 189.97 37.45 189.99 35C190.01 31.81 188.68 30.18 175.25 16.75C167.14 8.64 160.27 2.01 159.99 2C159.71 2 152.74 8.64 144.5 16.76ZM214.48 4.8C212.27 6.96 211.65 8.41 211.81 11.05C211.97 13.52 213.09 15.57 215.76 18.27L219.5 22.03L200.89 22C195.51 27.88 194.02 30.58 194 32C193.98 33.59 195.34 35.86 197.73 38.24L201.5 41.97L219.5 41.97C212.91 48.61 212.02 50.32 211.99 53C211.97 55.53 212.73 57.26 214.73 59.23C216.67 61.14 218.55 61.97 221 61.99C224.19 62.01 225.84 60.67 239.5 47L254.5 32C225.76 3.26 224.2 1.99 220.93 2C218.38 2 216.55 2.8 214.48 4.8Z"}),Ft=function(e){var t=e.svgRef,a=e.title,n=Rt(e,["svgRef","title"]);return r.a.createElement("svg",Nt({viewBox:"0 0 256 80",width:256,height:80,ref:t},n),a?r.a.createElement("title",null,a):null,Mt,Bt)},Vt=r.a.forwardRef((function(e,t){return r.a.createElement(Ft,Nt({svgRef:t},e))}));a.p;function zt(){return(zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Ut(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Ht=r.a.createElement("path",{d:"M544.033302 516.000776V96.000564c0-17.672051-14.478655-31.998984-32.150706-31.998984s-32.150706 14.326933-32.150707 31.998984v420.061624c-54.909072 14.251072-95.809105 64.333925-95.809105 123.935554 0 59.691941 40.82056 109.836206 96.090876 124.000579a32.298816 32.298816 0 0 0-0.281771 4.006195v159.99492c0 17.672051 14.478655 31.998984 32.150707 31.998984s32.150706-14.326933 32.150706-31.998984V768.004516a32.280754 32.280754 0 0 0-0.317894-3.941171c55.389526-14.088512 96.397933-64.301413 96.397932-124.058378 0.010837-59.691941-40.809723-109.832593-96.080038-124.004191z m13.221527 169.249989a64.00158 64.00158 0 1 1 18.744945-45.256635 63.578925 63.578925 0 0 1-18.744945 45.260247zM223.678606 196.003711a32.287979 32.287979 0 0 0 0.292607-4.002582V96.000564a31.970084 31.970084 0 1 0-63.940169 0V192.001129a32.371065 32.371065 0 0 0 0.180622 4.060381c-55.270316 14.160761-96.173962 64.301413-96.173961 124.000579s40.910871 109.818143 96.181186 123.996966a32.360228 32.360228 0 0 0-0.184234 3.937558V927.999436a31.970084 31.970084 0 1 0 63.940169 0V448.000226a32.287979 32.287979 0 0 0-0.278158-3.883372c55.385914-14.088512 96.350971-64.301413 96.350971-124.054765S279.071744 210.084998 223.678606 196.003711z m13.575545 169.315013A64.00158 64.00158 0 1 1 255.999097 320.062089a63.578925 63.578925 0 0 1-18.744946 45.256635zM959.99842 320.062089c0-59.775027-41.048144-109.977091-96.45212-124.058378a32.360228 32.360228 0 0 0 0.173397-4.002582V96.000564a31.970084 31.970084 0 1 0-63.940169 0V192.001129a32.291592 32.291592 0 0 0 0.299833 4.060381c-55.270316 14.160761-96.116162 64.301413-96.116163 124.000579s40.82056 109.836206 96.090876 124.000578a32.298816 32.298816 0 0 0-0.281771 3.99897V927.999436a31.970084 31.970084 0 1 0 63.940169 0V448.061637a32.381903 32.381903 0 0 0-0.166172-3.941171c55.407588-14.084899 96.452119-64.286963 96.45212-124.058377z m-82.746526 45.253022a63.997968 63.997968 0 1 1 18.748558-45.253022 63.578925 63.578925 0 0 1-18.748558 45.253022z",fill:""}),Wt=function(e){var t=e.svgRef,a=e.title,n=Ut(e,["svgRef","title"]);return r.a.createElement("svg",zt({className:"icon",style:{width:"1em",height:"1em",verticalAlign:"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",ref:t},n),a?r.a.createElement("title",null,a):null,Ht)},Xt=r.a.forwardRef((function(e,t){return r.a.createElement(Wt,zt({svgRef:t},e))}));a.p;function Zt(){return(Zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Yt(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var Qt=r.a.createElement("style",null,"\n\t\ttspan { white-space:pre }\n\t\t.shp0 { fill: #323638 } \n\t"),qt=r.a.createElement("g",{id:"Layer"},r.a.createElement("path",{id:"Layer",fillRule:"evenodd",className:"shp0",d:"M92.28 85.53L84 93.71C83.8 93.9 83.55 94 83.29 94C83.04 94 82.78 93.9 82.59 93.71L65.27 76.56C64.03 75.31 64.05 73.3 65.29 72.07L70.7 66.74C71.9 65.55 73.99 65.56 75.18 66.77L92.29 84.12C92.68 84.51 92.67 85.14 92.28 85.53ZM90.16 84.81L73.76 68.17C73.53 67.95 73.24 67.82 72.92 67.82C72.61 67.82 72.32 67.94 72.1 68.16L66.7 73.49C66.24 73.95 66.23 74.69 66.69 75.15L83.29 91.59L90.16 84.81Z"}),r.a.createElement("path",{id:"Layer",fillRule:"evenodd",className:"shp0",d:"M39.31 77.77C18.42 77.77 1.42 60.77 1.42 39.88C1.42 18.99 18.42 2 39.3 2C60.19 2 77.19 18.99 77.19 39.88C77.19 60.77 60.19 77.77 39.31 77.77ZM75.19 39.88C75.19 20.1 59.09 4 39.3 4C19.52 4 3.42 20.1 3.42 39.88C3.42 59.67 19.52 75.77 39.3 75.77C59.09 75.77 75.19 59.67 75.19 39.88Z"}),r.a.createElement("path",{id:"Layer",fillRule:"evenodd",className:"shp0",d:"M57.7 25.39L57.7 54.31C57.7 58.64 54.17 62.17 49.83 62.17C45.5 62.17 41.97 58.64 41.97 54.31C41.97 49.97 45.5 46.44 49.83 46.44C52.17 46.44 54.26 47.47 55.7 49.08L55.7 25.39C55.7 25.01 55.46 24.67 55.09 24.55L34.1 17.21C33.85 17.13 33.57 17.17 33.34 17.34C33.11 17.51 32.98 17.77 32.98 18.05L32.98 48.81C32.98 53.15 29.46 56.68 25.12 56.68C20.78 56.68 17.25 53.15 17.25 48.81C17.25 44.47 20.78 40.95 25.12 40.95C27.45 40.95 29.54 41.97 30.98 43.59L30.98 18.05C30.98 17.12 31.41 16.27 32.17 15.72C32.92 15.18 33.85 15.03 34.74 15.31L55.73 22.66C56.9 23.03 57.7 24.13 57.7 25.39ZM30.98 48.81C30.98 45.58 28.35 42.95 25.12 42.95C21.88 42.95 19.25 45.58 19.25 48.81C19.25 52.05 21.88 54.68 25.12 54.68C28.35 54.68 30.98 52.05 30.98 48.81ZM55.7 54.31C55.7 51.07 53.07 48.44 49.83 48.44C46.6 48.44 43.97 51.07 43.97 54.31C43.97 57.54 46.6 60.17 49.83 60.17C53.07 60.17 55.7 57.54 55.7 54.31Z"})),Gt=function(e){var t=e.svgRef,a=e.title,n=Yt(e,["svgRef","title"]);return r.a.createElement("svg",Zt({viewBox:"0 0 94 96",width:94,height:96,ref:t},n),a?r.a.createElement("title",null,a):null,Qt,qt)},Jt=r.a.forwardRef((function(e,t){return r.a.createElement(Gt,Zt({svgRef:t},e))})),Kt=(a.p,Object(l.b)((function(e){var t=e.audio,a=e.screen;return{chartAudio:t.chartAudio,activeView:a.activeView}}),(function(e){return{stopPreviewAudio:function(){return e((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))},setActiveView:function(t){return e(function(e){return function(t){t({type:"SET_ACTIVE_VIEW",payload:e})}}(t))}}}))((function(e){var t=e.activeView,a=e.chartAudio,n=[{view:"song",icon:"music",svgIcon:Jt,text:"Song"},{view:"mods",icon:"sidebar",svgIcon:Xt,text:"Mods"},{view:"chart",svgIcon:Vt,text:"Chart"},{view:"",icon:"",text:""},{view:"3",icon:"",text:""}],i=function(e){return"chart"!==e&&"playing"===a.status};return r.a.createElement("nav",{className:"navbar"},n.map((function(n,o){var s=n.view,l=n.icon,c=n.text,u=n.svgIcon;return s?r.a.createElement("div",{key:"navbarItem_".concat(o),className:"navbar_item ".concat(t===s?"active":""," ").concat(i(s)?"disabled":""),onClick:function(){return function(t){"playing"!==a.status&&(xe.stopSongPreview(),e.setActiveView(t))}(s)}},u?r.a.createElement(u,{className:"svg-icon ".concat(s)}):r.a.createElement(He.a,{name:l}),r.a.createElement("span",{className:"description"},c)):r.a.createElement("div",{key:"navbarItem_".concat(o),className:"navbar_item"})})))}))),$t=(Object(l.b)((function(e){return{activeView:e.screen.activeView}}),null)((function(e){return r.a.createElement("div",{className:"view-section logView1\n    ".concat("logView1"===e.activeView?"active":"")},r.a.createElement("div",{className:"view-wrapper"},r.a.createElement("pre",{id:"logView1"},"test debug log")))})),Object(l.b)((function(e){return{}}),(function(e){return{selectSong:function(t){return e(Le(t))},selectDifficulty:function(t){return e((a=t,function(e){e({type:"SELECT_DIFFICULTY",payload:a})}));var a},selectMode:function(t){return e((a=t,function(e){e({type:"SELECT_MODE",payload:a})}));var a},resizeScreen:function(t){return e(function(e){return function(t){t({type:"RESIZE_SCREEN",payload:e})}}(t))},getSimfileList:function(){return e(Pe())},loadSimfile:function(t){return e(je(t))}}}))((function(e){var t=Object(n.useState)(!0),a=Object(f.a)(t,2),i=a[0],o=a[1],s=Object(n.useState)(null),l=Object(f.a)(s,2),c=l[0],u=(l[1],Object(n.useState)(null)),h=Object(f.a)(u,2),p=h[0],v=h[1],g=Object(n.useState)(!1),b=Object(f.a)(g,2),y=b[0],w=b[1];Object(n.useEffect)((function(){(function(){var e=Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:o(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),xe.setLoadingAudio=w,window.addEventListener("resize",e.resizeScreen)}),[]);var E=function(){var t=Object(m.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getSimfileList();case 3:t.next=9;break;case 5:return t.prev=5,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return",null);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),O=function(){var t=Object(m.a)(d.a.mark((function t(a){var n,r=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=r.length>1&&void 0!==r[1]?r[1]:0,xe.selectSong(a,n),e.selectSong(a),document.title="".concat(a.title," - SMViewer"),e.loadSimfile(a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"main-container"},!i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Kt,null),r.a.createElement("div",{className:"view-container"},r.a.createElement(rt,{loadingAudio:y,sm:c,gameEngine:p,setGameEngine:v}),r.a.createElement(xt,null),r.a.createElement(Dt,{onSongSelect:O,onDifficultySelect:function(t){e.selectDifficulty(t)},onModeSelect:function(t){e.selectMode(t)},loadingAudio:y,location:e.location,gameEngine:p}),!1)),!1)}))),ea=a(117),ta=Object(l.b)((function(e){var t=e.simfiles,a=e.songSelect,n=t.sm;return{simfileList:t.simfileList,sm:n,song:a.song,difficulty:a.difficulty,mode:a.mode}}),(function(e){return{getSimfileList:function(){return e(Pe())},loadSimfile:function(t){return e(je(t))}}}))((function(e){var t=Object(n.useState)(null),a=Object(f.a)(t,2),i=(a[0],a[1],Object(n.useState)(!0)),o=Object(f.a)(i,2);o[0],o[1];return console.log("StaticViewContainer props",e),Object(n.useEffect)((function(){(function(){var t=Object(m.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.simfileList.length){t.next=4;break}return console.log("loading simfileList"),t.next=4,e.getSimfileList();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(n.useEffect)((function(){var t=e.location.search.slice(1).split("&").map((function(e){var t=e.split("="),a=Object(f.a)(t,2),n=a[0],r=a[1];return Object(ea.a)({},n,r)}));console.log(t)}),[e.location.search]),r.a.createElement("div",null,"cool")}));var aa=Object(c.f)((function(){return r.a.createElement("div",{className:"app-container"},r.a.createElement(c.c,null,r.a.createElement(c.a,{exact:!0,path:"/",render:function(e){return r.a.createElement($t,e)}}),r.a.createElement(c.a,{exact:!0,path:"/static",render:function(e){return r.a.createElement(ta,e)}})))}));o.a.render(r.a.createElement(l.a,{store:_e},r.a.createElement(s.a,{basename:"/smviewer"},r.a.createElement(aa,null))),document.getElementById("root"))}},[[260,1,2]]]);
//# sourceMappingURL=main.3992e7e9.chunk.js.map