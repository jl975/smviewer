(this.webpackJsonpsmplayer=this.webpackJsonpsmplayer||[]).push([[0],{236:function(e,t,n){e.exports=n(411)},247:function(e,t,n){},250:function(e,t,n){},411:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(36),o=n.n(i),s=n(30),c=(n(246),n(247),n(22)),l=n.n(c),u=n(47),f=n(16),d=n(225),h=n(54),m=n(413),p=(n(249),n(250),["left","down","up","right"]),v=["Beginner","Basic","Difficult","Expert","Challenge"],g=n(107),b=n(23),y=n(24),O=n(25),w=n(32),E=function(){return window.location.search?window.location.href.slice(0,window.location.href.indexOf(window.location.search)):window.location.href},k=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{mode:"cors"});case 2:return n=e.sent,a=n.body.getReader(),r=new TextDecoder("utf-8"),e.next=7,a.read();case 7:return i=e.sent,e.abrupt("return",r.decode(i.value));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e){return E()+"assets/"+e},j=function(e){return E()+"jackets/"+e},_=function(e){return e.slice(0,1).toUpperCase()+e.slice(1)},S=function(){if(!window.location.search)return{};var e={};try{return window.location.search.slice(1).split("&").forEach((function(t){var n=t.split("="),a=Object(f.a)(n,2),r=a[0],i=a[1];e[r]=i})),e}catch(t){return console.log("error parsing url params",t),{}}}(),A={};p.forEach((function(e){A["rainbow_".concat(e)]=new Image,A["rainbow_".concat(e)].src=P("rainbow_".concat(e,".png")),A["note_".concat(e)]=new Image,A["note_".concat(e)].src=P("note_".concat(e,".png")),A["vivid_".concat(e)]=new Image,A["vivid_".concat(e)].src=P("vivid_".concat(e,".png")),A["flat_".concat(e)]=new Image,A["flat_".concat(e)].src=P("vivid_".concat(e,".png")),A["freeze_tail_active_".concat(e)]=new Image,A["freeze_tail_active_".concat(e)].src=P("freeze_tail_active_".concat(e,".png")),A["freeze_tail_inactive_".concat(e)]=new Image,A["freeze_tail_inactive_".concat(e)].src=P("freeze_tail_inactive_".concat(e,".png")),A["freeze_body_active_".concat(e)]=new Image,A["freeze_body_active_".concat(e)].src=P("freeze_body_active_".concat(e,".png")),A["freeze_body_inactive_".concat(e)]=new Image,A["freeze_body_inactive_".concat(e)].src=P("freeze_body_inactive_".concat(e,".png")),A["shock_".concat(e)]=new Image,A["shock_".concat(e)].src=P("shock_".concat(e,".png"))}));["freeze_head","tap_explosion"].forEach((function(e){A[e]=new Image,A[e].src=P("".concat(e,".png"))}));var D=function(){function e(t){Object(y.a)(this,e);var n=t.key,a=t.mods,r=a.speed,i=a.noteskin,o=a.colorFreezes;this.key=n,this.speed=r,this.note=t.note,this.noteskin=i,this.measureIdx=t.measureIdx,this.measureN=t.measureN,this.measureD=t.measureD,this.colorFreezes=o,this.originalBeatPosition=t.originalBeatPosition,this.holdBeats=t.holdBeats||null,this.hitFrame=0,this.previousBeatPosition=null}return Object(O.a)(e,[{key:"reset",value:function(){this.hitFrame=0}},{key:"currentBeatPosition",value:function(e){return this.originalBeatPosition-e}},{key:"render",value:function(e,t){for(var n=e.getContext("2d"),a=e.height,r=0;r<this.note.length;r++)if("0"!==this.note[r]){var i=void 0,o=void 0,s=void 0,c=void 0,l=void 0,u=p[r];if("1"===this.note[r]||"2"===this.note[r]&&this.colorFreezes){if(i=A["".concat(this.noteskin,"_").concat(u)],this.note.includes("2")&&!this.colorFreezes)i=A.freeze_head,o=64*p.indexOf(u),s=0;else if("rainbow"===this.noteskin){o=Math.floor(4*t)%8*64;var f=this.measureD/4,d=this.measureN%f;0===d?s=0:0<d&&d<=f/4?s=1:f/4<d&&d<=f/2?s=2:f/2<d&&d<=3*f/4?s=3:3*f/4<d&&d<f&&(s=0),s*=64}else if("note"===this.noteskin){o=Math.floor(4*t)%8*64;var h=this.measureN/this.measureD;s=[0,.25,.5,.75].includes(h)?0:[1/8,3/8,5/8,7/8].includes(h)?1:[1/16,3/16,5/16,7/16,9/16,.6875,.8125,.9375].includes(h)?3:2,s*=64}else if("vivid"===this.noteskin){o=Math.floor(4*t)%4*64;var m=this.measureD/4,v=this.measureN%m;0===v?s=0:0<v&&v<=m/4?s=1:m/4<v&&v<=m/2?s=2:m/2<v&&v<=3*m/4?s=3:3*m/4<v&&v<m&&(s=0),s=(s+Math.floor(t)%4)%4*64}else"flat"===this.noteskin&&(i=A["vivid_".concat(u)],o=Math.floor(4*t)%4*64,s=Math.floor(t)%4*64);c=64*p.indexOf(u),(l=64*this.currentBeatPosition(t)*this.speed)>0&&l<a&&n.drawImage(i,o,s,64,64,c,l,64,64),l<=0?this.hitFrame<=12&&(n.save(),n.globalAlpha=1-Math.pow(this.hitFrame/12,3),n.drawImage(A.tap_explosion,0,0,64,64,c-2-this.hitFrame,-2-this.hitFrame,68+2*this.hitFrame,68+2*this.hitFrame),n.restore(),this.hitFrame++):this.hitFrame=0}else if("2"===this.note[r])i=A.freeze_head,o=64*p.indexOf(u),s=0,c=64*p.indexOf(u),(l=64*this.currentBeatPosition(t)*this.speed)>0&&l<a&&n.drawImage(i,o,s,64,64,c,l,64,64),l<=0?this.hitFrame<=12&&(n.save(),n.globalAlpha=1-Math.pow(this.hitFrame/12,3),n.drawImage(A.tap_explosion,0,0,64,64,c-this.hitFrame,0-this.hitFrame,64+2*this.hitFrame,64+2*this.hitFrame),n.restore(),this.hitFrame++):this.hitFrame=0;else if("3"===this.note[r]){i=A["freeze_tail_inactive_".concat(u)],o=0,s=0,c=64*p.indexOf(u),l=64*this.currentBeatPosition(t)*this.speed;var g=A["freeze_body_inactive_".concat(u)],b=64*this.holdBeats[r]*this.speed-32,y=Math.floor(b/128),O=b%128,w=O,E=l-(b+32),k=!1;E<=0&&(O+=E,E=0,i=A["freeze_tail_active_".concat(u)],g=A["freeze_body_active_".concat(u)],l>=0&&(k=!0)),E>-O&&E<a&&n.drawImage(g,0,128-O,64,O,c,E+32,64,O);for(var P=1;P<=y;P++){var j=128,_=0,S=l-(b+32-w-128*(P-1));S<0&&S>-128&&(j+=S,_-=S,S=0),S>-j&&S<a&&n.drawImage(g,0,_,64,j,c,S+32,64,j)}var D=64;if(64*this.holdBeats[r]*this.speed<32){var L=64*this.holdBeats[r]*this.speed;s+=32-L,l+=32-L,D=64-L}if(l<32&&l>0&&(s+=32-l,l=32),l>0&&l<a&&n.drawImage(i,o,s,64,D,c,l,64,D),k){var C=A.freeze_head;this.hitFrame<=12&&n.drawImage(C,64*p.indexOf(u),128,64,64,64*p.indexOf(u),0,64,64)}l<=0?this.hitFrame<=12&&(n.save(),n.globalAlpha=1-Math.pow(this.hitFrame/12,3),n.drawImage(A.tap_explosion,0,0,64,64,c-this.hitFrame,0-this.hitFrame,64+2*this.hitFrame,64+2*this.hitFrame),n.restore(),this.hitFrame++):this.hitFrame=0}this.previousBeatPosition=this.currentBeatPosition(t)}}}]),e}(),L={};p.forEach((function(e){L["shock_".concat(e)]=new Image,L["shock_".concat(e)].src=P("shock_".concat(e,".png"))}));var C=function(){function e(t){Object(y.a)(this,e);var n=t.key,a=t.mods,r=a.speed,i=a.noteskin;this.key=n,this.speed=r,this.note=t.note,this.noteskin=i,this.originalBeatPosition=t.originalBeatPosition}return Object(O.a)(e,[{key:"currentBeatPosition",value:function(e){return this.originalBeatPosition-e}},{key:"render",value:function(e,t,n){var a=e.getContext("2d"),r=e.height;t=Math.floor(t/3)%8;for(var i=0;i<this.note.length;i++){var o=p[i],s=L["shock_".concat(o)],c=t%4*64,l=64*Math.floor(t/4),u=64*p.indexOf(o),f=64*this.currentBeatPosition(n)*this.speed;f>-64&&f<r&&a.drawImage(s,c,l,64,64,u,f,64,64)}}}]),e}(),N={};p.forEach((function(e){N[e]=new Image,N[e].src=P("".concat(e,"_tap_flash.png")),N[e]=new Image,N[e].src=P("".concat(e,"_tap_flash.png"))}));var x={};p.forEach((function(e){x[e]=new Image,x[e].src=P("".concat(e,"_tap_receptor.png")),x[e]=new Image,x[e].src=P("".concat(e,"_tap_receptor.png"))}));var I=function(){function e(){Object(y.a)(this,e)}return Object(O.a)(e,[{key:"render",value:function(e,t){var n=e.getContext("2d"),a=t%1>0&&t%1<.25;p.forEach((function(e,t){n.drawImage(a?N[e]:x[e],0,0,64,64,64*t,0,64,64)}))}}]),e}(),T=function(){function e(t){Object(y.a)(this,e);var n=t.mods,a=n.speed,r=n.guidelines;this.speed=a,this.finalBeat=t.finalBeat,this.showGuidelines=r}return Object(O.a)(e,[{key:"render",value:function(e,t){if(this.showGuidelines)for(var n=e.getContext("2d"),a=e.height,r=0;r<=this.finalBeat;r++){var i=64*(r-t)*this.speed+32,o=r%4===0?2:.8;i>0&&i<a&&(n.beginPath(),n.moveTo(0,i),n.lineTo(e.width,i),n.lineWidth=o,n.strokeStyle="#fff",n.stroke())}}}]),e}(),B=/dance-([a-z]+)/,R=/(Beginner|Easy|Medium|Hard|Challenge|Edit)/,F={Beginner:"Beginner",Easy:"Basic",Medium:"Difficult",Hard:"Expert",Challenge:"Challenge"},M=function(e){var t={},n="";/#BPMS:/i.test(e)&&(n=(n=/#BPMS:([\s\S]*?)\s*;/i.exec(e)[1]).length?n.split(",").map((function(e){var t=e.split("="),n=Object(f.a)(t,2),a=n[0],r=n[1];return{beat:parseFloat(a),value:parseFloat(r)}})):[]);var a="";return/#STOPS:/i.test(e)&&(a=(a=/#STOPS:([\s\S]*?)\s*;/i.exec(e)[1]).length?a.split(",").map((function(e){var t=e.split("="),n=Object(f.a)(t,2),a=n[0],r=n[1];return{beat:parseFloat(a),value:parseFloat(r)}})):[]),e.slice(e.indexOf("#NOTES:")).split(/#NOTES:\s+/).slice(1).forEach((function(e){var r=B.exec(e)[1],i=R.exec(e)[1],o=F[i];t["".concat(r,"_").concat(o)]={difficulty:o,mode:r,bpms:n,stops:a};var s=t["".concat(r,"_").concat(o)],c=new RegExp("".concat(i,":\\s+([0-9]+):")),l=parseInt(c.exec(e)[1]);s.level=l;var u=e.slice(e.lastIndexOf(":")+1,e.lastIndexOf(";")).trim().split(",").map((function(e,t){var n=e.trim().split("\r\n").filter((function(e){return!e.startsWith("//")})),a=n.length,r=[];return n.forEach((function(e,n){if(e.split("").filter((function(e){return"0"!==e})).length){var i={};i.note=e,i.measureIdx=t,i.measureN=n,i.measureD=a,r.push(i)}})),r}));s.chart=u})),t};function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var U=function(e,t){var n=t.turn,a=t.shuffle,r={off:"LDUR",mirror:"RUDL",left:"ULRD",right:"DRLU",shuffle1:"LRDU",shuffle2:"UDRL",shuffle3:"LRUD",shuffle4:"DURL",shuffle5:"DLUR",shuffle6:"DULR",shuffle7:"RLUD",shuffle8:"RULD"},i=n;return"shuffle"===n&&(i+=a),e.map((function(e){var t=e.note;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{note:r[i].split("").map((function(e){return t[r.off.indexOf(e)]}))})}))},z=n(108),H=n(46),G=n(204);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q={chartAudio:{status:"stopped",progress:0},previewAudio:{status:"stopped"}},Z=function(e){return function(t){t({type:"CHANGE_ACTIVE_BPM_DISPLAY",payload:e})}},W=function(e){return function(t){t({type:"SET_COMBO",payload:e})}};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K={activeBpm:null,bpmChangeQueue:[],combo:0},$={difficulty:["Beginner","Basic","Difficult","Expert","Challenge"],mods:{speed:[.25,.5,.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.5,5,5.5,6,6.5,7,7.5,8],turn:["off","mirror","left","right","shuffle"],shuffle:[1,2,3,4,5,6,7,8],noteskin:["rainbow","note","vivid","flat"]}},ee={difficulty:"Expert",mods:{speed:3,turn:"off",shuffle:1,noteskin:"note",guidelines:!0,colorFreezes:!1}};if(S.difficulty){var te={b:"Beginner",B:"Basic",D:"Difficult",E:"Expert",C:"Challenge"};Object.keys(te).includes(S.difficulty[0])&&(ee.difficulty=te[S.difficulty[0]])}if(S.speed){var ne=parseFloat("".concat(S.speed[0],".").concat(S.speed.slice(1)));$.mods.speed.includes(ne)&&(ee.mods.speed=ne)}if(S.turn){var ae=S.turn.toLowerCase();$.mods.turn.includes(ae)&&(ee.mods.turn=ae)}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe=ee.mods,se={},ce=Object(H.c)({audio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PLAY_CHART_AUDIO":var n=q({},e.chartAudio,{status:"playing"});return q({},e,{chartAudio:n});case"PAUSE_CHART_AUDIO":var a=q({},e.chartAudio,{status:"paused"});return q({},e,{chartAudio:a});case"STOP_CHART_AUDIO":var r=q({},e.chartAudio,{status:"stopped"});return q({},e,{chartAudio:r});case"PLAY_PREVIEW_AUDIO":var i=q({},e.previewAudio,{status:"playing"});return q({},e,{previewAudio:i});case"STOP_PREVIEW_AUDIO":var o=q({},e.previewAudio,{status:"stopped"});return q({},e,{previewAudio:o});case"SET_CHART_PROGRESS":var s=q({},e.chartAudio,{progress:t.payload});return q({},e,{chartAudio:s});default:return e}},chart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BPM_CHANGE_QUEUE":return J({},e,{bpmChangeQueue:Object(g.a)(t.payload)});case"CHANGE_ACTIVE_BPM_DISPLAY":var n=Math.round(t.payload);return J({},e,{activeBpm:n});case"SET_COMBO":return J({},e,{combo:t.payload});default:return e}},mods:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_MODS":var n=t.payload;return ie({},e,{},n);default:return e}},songSelect:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),le=Object(H.e)(ce,Object(H.d)(Object(H.a)(G.a),window.devToolsExtension?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e})),ue=new(function(){function e(){Object(y.a)(this,e),this.sources={song:{},preview:{},assistTick:{audio:new z.Howl({src:P("sounds/assist_tick.wav")})}},this.currentSong=null,this.currentPreview=null,this.currentSongId=null,this.currentPreviewId=null,this.activeView=null,this.previewFadeTimeout=null,this.updateTimeline=this.updateTimeline.bind(this),this.updateProgress=this.updateProgress.bind(this),this.audioResyncFrames=0}return Object(O.a)(e,[{key:"getCurrentSong",value:function(){return this.sources.song[this.currentSong]}},{key:"getCurrentPreview",value:function(){return this.sources.preview[this.currentPreview]}},{key:"getCurrentTime",value:function(){return this.getCurrentSong().audio.seek()}},{key:"storeAudioSource",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.sources.song[e.hash]||(this.setLoadingAudio(!0),this.sources.song[e.hash]={title:e.title},this.sources.song[e.hash].audio=new z.Howl({src:"https://dl.dropboxusercontent.com/s/".concat(e.dAudioUrl),format:["mp3"],html5:!0,onload:function(){t.setLoadingAudio(!1),t.seekProgress(n)},onloaderror:function(e,t,n){alert("".concat(e,";;; ").concat(t,";;; ").concat(n))},onplay:function(){t.getCurrentSong().tl.play(),t.resync(),w.a.ticker.add(t.updateProgress),t.startAnimationLoop(),le.dispatch((function(e){e({type:"PLAY_CHART_AUDIO"})}))},onpause:function(){t.getCurrentSong().tl.pause(),w.a.ticker.remove(t.updateTimeline),w.a.ticker.remove(t.updateProgress),t.stopAnimationLoop(),le.dispatch((function(e){e({type:"PAUSE_CHART_AUDIO"})}))},onseek:function(){},onstop:function(){t.getCurrentSong().tl&&t.getCurrentSong().tl.restart().pause(),w.a.ticker.remove(t.updateTimeline),w.a.ticker.remove(t.updateProgress),t.stopAnimationLoop(),le.dispatch((function(e){e({type:"STOP_CHART_AUDIO"})}))},onend:function(e){w.a.ticker.remove(t.updateTimeline),t.stopAnimationLoop(),le.dispatch((function(e){e({type:"STOP_CHART_AUDIO"})}))}}),this.sources.preview[e.hash]={title:e.title},this.sources.preview[e.hash].audio=new z.Howl({src:"https://dl.dropboxusercontent.com/s/".concat(e.dAudioUrl),format:["mp3"],html5:!0,sprite:{sample:[parseFloat(1e3*(e.sampleStart-.12)),parseFloat(1e3*e.sampleLength)]},onplay:function(){le.dispatch((function(e){e({type:"PLAY_PREVIEW_AUDIO"})}))},onstop:function(){clearTimeout(t.previewFadeTimeout),t.currentPreviewId=null,le.dispatch((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))},onend:function(){clearTimeout(t.previewFadeTimeout),t.currentPreviewId=null,le.dispatch((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))}}))}},{key:"selectSong",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.currentSong&&this.getCurrentSong().audio.stop(this.currentSongId),this.storeAudioSource(e,t),this.currentSong=e.hash}},{key:"resync",value:function(){this.audioResyncFrames=10,w.a.ticker.add(this.updateTimeline),this.updateProgressOnce()}},{key:"updateTimeline",value:function(){if(this.getCurrentSong().tl.seek(this.getCurrentTime()+.07),this.audioResyncFrames--,this.audioResyncFrames<=0){var e=function(e){for(var t=e.beatTick,n=e.bpmChangeQueue,a=0,r=0;r<n.length;r++){var i=n[r];if(i.beat>t)return a;a=i.value}return a}(this.getCurrentSong().globalParams);le.dispatch(Z(e));var t=function(e){var t=e.audio,n=e.globalParams.arrows;if(!n.length)return 0;for(var a=0;a<n.length;a++){var r=n[a];if(r.timestamp>t.seek()+.07)return r.combo-1}return n[n.length-1].combo}(this.getCurrentSong());le.dispatch(W(t)),w.a.ticker.remove(this.updateTimeline)}}},{key:"seekTime",value:function(e){this.getCurrentSong().audio.seek(e),this.resync()}},{key:"goBack",value:function(e){this.seekTime(this.getCurrentTime()-.001*e)}},{key:"goForward",value:function(e){this.seekTime(this.getCurrentTime()+.001*e)}},{key:"seekProgress",value:function(e){this.seekTime(e*this.getCurrentSong().audio.duration())}},{key:"updateProgress",value:function(e,t,n){if(n%15===0){var a=this.getCurrentSong().audio,r=a.seek()/a.duration();le.dispatch(function(e){return function(t){t({type:"SET_CHART_PROGRESS",payload:e})}}(r))}}},{key:"updateProgressOnce",value:function(){this.updateProgress(null,null,0),this.updateAnimationLoopOnce()}},{key:"setTimeline",value:function(e){this.getCurrentSong().tl=e}},{key:"setGlobalParams",value:function(e){this.getCurrentSong().globalParams=e}},{key:"play",value:function(){this.currentSongId=this.getCurrentSong().audio.play()}},{key:"pause",value:function(){this.getCurrentSong().audio.pause(this.currentSongId)}},{key:"stop",value:function(){this.getCurrentSong().audio.stop(this.currentSongId),this.seekTime(0),this.currentSongId=null}},{key:"isPlaying",value:function(){return this.getCurrentSong()&&this.getCurrentSong().audio.playing(this.currentSongId)}},{key:"isPaused",value:function(){return this.getCurrentSong()&&!this.getCurrentSong().audio.playing(this.currentSongId)}},{key:"playAssistTick",value:function(){this.sources.assistTick.audio.play()}},{key:"playSongPreview",value:function(e){var t=this;this.currentPreview&&this.getCurrentPreview().audio.stop(this.currentPreviewId),this.storeAudioSource(e),this.currentPreview=e.hash;var n=this.getCurrentPreview().audio;this.currentPreviewId=n.play("sample"),n.on("play",(function(){var n=t.getCurrentPreview().audio;n.fade(0,1,200),t.previewFadeTimeout=setTimeout((function(){n.fade(1,0,2e3)}),1e3*e.sampleLength-2e3)}))}},{key:"stopSongPreview",value:function(){this.currentPreview&&this.getCurrentPreview().audio.stop(this.currentPreviewId)}},{key:"isPreviewPlaying",value:function(){return this.getCurrentPreview()&&this.getCurrentPreview().audio.playing(this.currentPreviewId)}}]),e}());function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=function(){function e(t,n){Object(y.a)(this,e);this.canvas=t,this.c=t.getContext("2d"),this.tl=w.a.timeline(),this.sm=n,this.simfiles={},this.eventList=[],this.arrows=[],this.shockArrows=[],this.allArrows=[],this.mainLoopRequestRef=null,this.drawBackground(),this.globalParams={beatTick:0,frame:0,combo:0,bpmChangeQueue:[],arrows:this.allArrows},this.sm&&(this.simfiles=M(this.sm)),ue.startAnimationLoop=this.startLoop.bind(this),ue.stopAnimationLoop=this.stopLoop.bind(this),ue.updateAnimationLoopOnce=this.updateLoopOnce.bind(this)}return Object(O.a)(e,[{key:"startLoop",value:function(){this.mainLoopRequestRef=window.requestAnimationFrame(this.mainLoop.bind(this))}},{key:"stopLoop",value:function(){window.cancelAnimationFrame(this.mainLoopRequestRef)}},{key:"updateLoopOnce",value:function(){window.requestAnimationFrame(this.mainLoop.bind(this,!1))}},{key:"generateEventList",value:function(e){for(var t=e.bpms,n=e.stops,a=[],r=0,i=0,o=t[0].value;r<t.length&&i<n.length;){var s=t[r],c=n[i];c.beat<=s.beat?(a.push(de({},c,{bpm:o,type:"stop"})),i++):(a.push(de({},s,{type:"bpm"})),o=s.value,r++)}for(;r<t.length;)a.push(de({},t[r],{type:"bpm"})),r++;for(;i<n.length;)a.push(de({},n[i],{bpm:o,type:"stop"})),i++;a[0].timestamp=0,this.globalParams.bpmChangeQueue=[a[0]];for(var l=1;l<a.length;l++){var u=a[l-1],f=a[l],d=a[l-1].timestamp,h=(f.beat-u.beat)/("bpm"===u.type?u.value:u.bpm)*60;"stop"===u.type&&(h+=u.value);var m=d+h;f.timestamp=m,"bpm"===f.type&&this.globalParams.bpmChangeQueue.push(f)}return this.eventList=a,a}},{key:"generateArrows",value:function(e,t){var n=this,a=e.chart;if(Array.isArray(a[0])){var r=[];a.forEach((function(e){r.push.apply(r,Object(g.a)(e))})),a=r}(a=U(a,t)).forEach((function(e,t){var n=e.measureIdx,r=e.measureN,i=e.measureD;e.currentBeatPosition=4*(n+r/i),e.originalBeatPosition=e.currentBeatPosition;for(var o=0;o<e.note.length;o++)if("3"===e.note[o])for(var s=t-1;s>=0;s--)if("2"===a[s].note[o]){a[s].holdBeats||(a[s].holdBeats=[]),e.holdBeats||(e.holdBeats=[]),a[s].holdBeats[o]=e.currentBeatPosition-a[s].currentBeatPosition,e.holdBeats[o]=e.currentBeatPosition-a[s].currentBeatPosition;break}})),a.forEach((function(e,a){if("M"===e.note[0]||"M"===e.note[4]){var r=new C(de({key:a},e,{mods:t}));n.shockArrows.push(r),n.allArrows.push(r)}else{var i=new D(de({key:a},e,{mods:t}));n.arrows.push(i),n.allArrows.push(i)}})),this.stepZone=new I}},{key:"initTimeline",value:function(e){var t,n=this;this.resetArrows();var a=0,r=this.arrows[this.arrows.length-1],i=this.eventList[this.eventList.length-1],o=0;r&&i?o=Math.max(r.originalBeatPosition,i.beat):r?o=r.originalBeatPosition:i&&(o=i.beat),o+=8;for(var s=function(e){var r=n.eventList[e],i=n.eventList[e+1],s="stop"===r.type?r.value:0;if("bpm"===r.type?t=r.value:"stop"===r.type&&(t=r.bpm),i){var c=i.beat-r.beat,l=c/t*60;n.tl=n.tl.to(n.globalParams,{beatTick:a+c,duration:l,ease:"none",onStart:function(){"bpm"===r.type&&le.dispatch(Z(r.value))}},"+=".concat(s)),a+=c}else n.tl=n.tl.to(n.globalParams,{beatTick:o,duration:(o-a)/t*60,ease:"none",onStart:function(){"bpm"===r.type&&le.dispatch(Z(r.value))}},"+=".concat(s))},c=0;c<this.eventList.length;c++)s(c);var l=this.globalParams.bpmChangeQueue,u=-1,f=0,d=-1,h=null,m=null,p=0,v=0;this.allArrows.forEach((function(e,t){if(!(e instanceof D)||e.note.includes("1")||e.note.includes("2")){for(;u<l.length-1&&l[u+1].beat<e.originalBeatPosition;){u++;var a=l[u];h=a.value,p=0;for(var r=f;r<n.eventList.length;r++){var i=n.eventList[r];if(i.beat===a.beat&&"bpm"===i.type){f=r;var o=n.eventList[r+1];o&&"stop"===o.type&&(d=r+1,m=n.eventList[d]);break}}}for(;m&&m.beat<e.originalBeatPosition;){p+=m.value;var s=n.eventList[d+1];s&&"stop"===s.type?d++:d=-1,m=n.eventList[d]}var c=l[u].beat,g=l[u].timestamp+(e.originalBeatPosition-c)*(60/h)+p;v++,e.combo=v,e.timestamp=g,n.tl.set(n.globalParams,{combo:e.combo,onStart:function(){le.dispatch(W(e.combo))}},g)}})),this.guidelines=new T({mods:e,finalBeat:o}),ue.setTimeline(this.tl),ue.setGlobalParams(this.globalParams),this.updateLoopOnce()}},{key:"resetArrows",value:function(){this.arrows.forEach((function(e){return e.reset()}))}},{key:"mainLoop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.drawBackground(),this.stepZone&&this.stepZone.render(this.canvas,this.globalParams.beatTick),this.guidelines&&this.guidelines.render(this.canvas,this.globalParams.beatTick);for(var t=this.shockArrows.length-1;t>=0;t--){var n=this.shockArrows[t];n.render(this.canvas,this.globalParams.frame,this.globalParams.beatTick)}for(var a=this.arrows.length-1;a>=0;a--){var r=this.arrows[a];r.render(this.canvas,this.globalParams.beatTick)}this.globalParams.frame++,e&&(this.mainLoopRequestRef=window.requestAnimationFrame(this.mainLoop.bind(this)))}},{key:"drawBackground",value:function(){this.c.fillStyle="black",this.c.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"toggleTl",value:function(){this.tl.paused()?(console.log("tl.play()"),this.tl.play()):(console.log("tl.pause()"),this.tl.pause())}},{key:"restartTl",value:function(){this.tl.restart().pause(),this.resetArrows()}},{key:"pauseTl",value:function(){this.tl.pause()}}]),e}(),me=function(e){var t=Object(a.useRef)(),n=e.progress;e.gameEngine;Object(a.useEffect)((function(){t.current.addEventListener("touchstart",(function(e){i(e.touches[0])})),t.current.addEventListener("touchmove",(function(e){i(e.touches[0])})),t.current.addEventListener("touchend",(function(e){}))}),[]);var i=function(e){var n=t.current.offsetWidth,a=(e.clientX-t.current.offsetLeft)/n;a<0||a>1||ue.seekProgress(a)};return r.a.createElement("div",{id:"progress-bar",ref:t},r.a.createElement("div",{className:"progress-value",style:{width:"".concat(100*n,"%")}}))},pe=function(e){var t=Object(a.useRef)(),n=Object(a.useRef)();Object(a.useEffect)((function(){var e=t.current.ref.current;e.addEventListener("mousedown",i,!1),e.addEventListener("mouseup",o,!1),e.addEventListener("mouseleave",o,!1),e.addEventListener("touchstart",i,!1),e.addEventListener("touchend",o,!1)}),[]);var i=function(t){t.preventDefault(),e.onClick&&e.onClick(),n.current=requestAnimationFrame(s)},o=function(e){cancelAnimationFrame(n.current)},s=function t(){e.onClick&&e.onClick(),n.current=requestAnimationFrame(t)};return r.a.createElement(m.a,Object.assign({},e,{ref:t}),e.children)},ve=n(423),ge=n(421),be=n(208),ye=n.n(be),Oe={Beginner:"b",Basic:"B",Difficult:"D",Expert:"E",Challenge:"C"},we=function(e){var t=e.modalOpen,n=e.setModalOpen,i=e.data,o=i.song,s=i.difficulty,c=i.mods,l=i.progress,u=Object(a.useRef)(),d=Object(a.useState)(""),h=Object(f.a)(d,2),p=h[0],v=h[1];if(Object(a.useEffect)((function(){!1===t&&v("")}),[t]),!o)return null;u.current=function(){var e={song:o.hash,difficulty:Oe[s]+"SP",turn:"off"!==c.turn?c.turn:"",speed:c.speed.toString().replace(".",""),progress:parseInt(1e5*l)},t=Object.keys(e).map((function(t){return null===e[t]||"undefined"===typeof e[t]?null:"".concat(t,"=").concat(e[t])})).filter((function(e){return null!==e})).join("&");return E()+"?"+t}();return r.a.createElement(ve.a,{className:"shareModal",size:"fullscreen",open:t,onClose:function(){return n(!1)}},r.a.createElement(ve.a.Header,null,"Share link to chart"),r.a.createElement(ve.a.Content,null,r.a.createElement(ge.a,{type:"text",className:"share-url-input",value:u.current,action:!0},r.a.createElement("input",null),r.a.createElement(m.a,{onClick:function(){ye()(u.current),v("Copied link to clipboard")}},"Copy")),r.a.createElement("p",null,p)))},Ee=Object(s.b)((function(e){var t=e.audio,n=e.chart,a=e.mods;return{audio:t.chartAudio,chart:n,mods:a}}),(function(e){return{}}))((function(e){var t=e.selectedDifficulty,n=e.selectedSong,i=e.sm,o=e.chart,s=e.mods,c=(e.selectedAudio,e.loadingAudio),l=e.gameEngine,u=e.setGameEngine,d=Object(a.useState)(null),p=Object(f.a)(d,2),g=p[0],b=p[1],y=Object(a.useState)(!1),O=Object(f.a)(y,2),w=O[0],E=O[1];Object(a.useEffect)((function(){if(!c){var e=document.querySelector("#chartArea");b(e)}}),[c]),Object(a.useEffect)((function(){if(g){var e=new he(g,i);if(t){var n=e.simfiles["single_".concat(t)];n&&(e.generateEventList(n),e.generateArrows(n,s),e.initTimeline(s),e.restartTl(),ue.resync()),u(e)}}}),[g,i,t,s]);var k={song:n,difficulty:t,mods:s,progress:e.audio.progress};return r.a.createElement("div",{className:"canvas-container"},c&&r.a.createElement("div",null,"Loading audio..."),!c&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"canvas-wrapper"},r.a.createElement("canvas",{id:"chartArea",width:"256",height:"448"}),r.a.createElement("div",{className:"combo-temp"},r.a.createElement("div",null,"Combo"),r.a.createElement("div",{className:"combo-num"},o.combo))),r.a.createElement("div",{className:"progress-container"},r.a.createElement(me,{progress:e.audio.progress,gameEngine:l}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"play-controls"},r.a.createElement(pe,{onClick:function(){return ue.goBack(20)},className:"play-control"},r.a.createElement(h.a,{name:"backward"})),r.a.createElement(m.a,{onClick:function(){l&&("playing"===e.audio.status?ue.pause():ue.play())},disabled:!(l&&!c),className:"play-control"},r.a.createElement(h.a,{name:"playing"===e.audio.status?"pause":"play"})),r.a.createElement(m.a,{onClick:function(){l&&ue.stop()},className:"play-control"},r.a.createElement(h.a,{name:"stop"})),r.a.createElement(pe,{onClick:function(){return ue.goForward(20)},className:"play-control"},r.a.createElement(h.a,{name:"forward"})),r.a.createElement(m.a,{onClick:function(){return E(!0)},className:"play-control share-btn",disabled:"playing"===e.audio.status},r.a.createElement(h.a,{name:"share square"})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"song-information"},n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"song-title"},n.title),r.a.createElement("div",{className:"song-artist"},n.artist))),r.a.createElement("div",{className:"bpm-information"},r.a.createElement("div",{className:"bpm-header"},"BPM"),r.a.createElement("div",{className:"bpm-value"},o.activeBpm)),r.a.createElement("div",{className:"level-information"},n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"song-difficulty"},t),r.a.createElement("div",{className:"song-level"},n.levels[v.indexOf(t)])))),r.a.createElement(we,{modalOpen:w,setModalOpen:E,data:k}))})),ke=n(424),Pe=function(e){var t=e.displayedSongs,n=e.onSongSelect,a=e.selectedSongOption,i=t,o=function(e){return r.a.createElement("div",{className:"songTile-wrapper",key:"songtile_".concat(e.hash),onClick:function(){return function(e){n(null,{value:e.hash})}(e)}},r.a.createElement("div",{className:"songTile ".concat(a===e.hash?"selected":"")},r.a.createElement("div",{className:"song-jacket-wrapper"},r.a.createElement("img",{className:"song-jacket",src:j("".concat(e.hash,".png")),title:e.title,alt:e.title})),r.a.createElement("div",{className:"song-title-bar"},e.title)))};return r.a.createElement("div",{className:"songGrid"},i.map((function(e){return o(e)})))};function je(){return(je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _e(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Se=r.a.createElement("path",{id:"Line_1","data-name":"Line 1",d:"M0.91,15L0.78,15A1,1,0,0,0,0,16v6a1,1,0,1,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H0.91Z"}),Ae=r.a.createElement("path",{id:"Line_2","data-name":"Line 2",d:"M6.91,9L6.78,9A1,1,0,0,0,6,10V28a1,1,0,1,0,2,0s0,0,0,0V10A1,1,0,0,0,7,9H6.91Z"}),De=r.a.createElement("path",{id:"Line_3","data-name":"Line 3",d:"M12.91,0L12.78,0A1,1,0,0,0,12,1V37a1,1,0,1,0,2,0s0,0,0,0V1a1,1,0,0,0-1-1H12.91Z"}),Le=r.a.createElement("path",{id:"Line_4","data-name":"Line 4",d:"M18.91,10l-0.12,0A1,1,0,0,0,18,11V27a1,1,0,1,0,2,0s0,0,0,0V11a1,1,0,0,0-1-1H18.91Z"}),Ce=r.a.createElement("path",{id:"Line_5","data-name":"Line 5",d:"M24.91,15l-0.12,0A1,1,0,0,0,24,16v6a1,1,0,0,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H24.91Z"}),Ne=r.a.createElement("path",{id:"Line_6","data-name":"Line 6",d:"M30.91,10l-0.12,0A1,1,0,0,0,30,11V27a1,1,0,1,0,2,0s0,0,0,0V11a1,1,0,0,0-1-1H30.91Z"}),xe=r.a.createElement("path",{id:"Line_7","data-name":"Line 7",d:"M36.91,0L36.78,0A1,1,0,0,0,36,1V37a1,1,0,1,0,2,0s0,0,0,0V1a1,1,0,0,0-1-1H36.91Z"}),Ie=r.a.createElement("path",{id:"Line_8","data-name":"Line 8",d:"M42.91,9L42.78,9A1,1,0,0,0,42,10V28a1,1,0,1,0,2,0s0,0,0,0V10a1,1,0,0,0-1-1H42.91Z"}),Te=r.a.createElement("path",{id:"Line_9","data-name":"Line 9",d:"M48.91,15l-0.12,0A1,1,0,0,0,48,16v6a1,1,0,1,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H48.91Z"}),Be=function(e){var t=e.svgRef,n=e.title,a=_e(e,["svgRef","title"]);return r.a.createElement("svg",je({id:"audioWave","data-name":"Layer 1",viewBox:"0 0 50 38.05",ref:t},a),n?r.a.createElement("title",null,n):null,Se,Ae,De,Le,Ce,Ne,xe,Ie,Te)},Re=r.a.forwardRef((function(e,t){return r.a.createElement(Be,je({svgRef:t},e))}));n.p;function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ve=[{key:"title_all",value:"all",text:"ALL"}].concat(["\u3042","\u304b","\u3055","\u305f","\u306a","\u306f","\u307e","\u3084","\u3089","\u308f","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","NUM"].map((function(e){return{key:"title_".concat(e),value:e,text:e}}))),Ue=[{key:"version_all",value:"all",text:"ALL"}].concat(["DDR 1st","DDR 2ndMIX","DDR 3rdMIX","DDR 4thMIX","DDR 5thMIX","DDRMAX","DDRMAX2","DDR EXTREME","DDR SuperNOVA","DDR SuperNOVA 2","DDR X","DDR X2","DDR X3 VS 2ndMIX","DDR (2013)","DDR (2014)","DDR A","DDR A20"].map((function(e,t){return{key:"version_".concat(t),value:t,text:e}})).reverse()),ze=[{key:"level_all",value:"all",text:"ALL"}].concat([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19].map((function(e){return{key:"level_".concat(e),value:e,text:e}}))),He=[{key:"difficulty_all",value:"all",text:"ALL"}].concat(v.map((function(e){return{key:"difficulty_".concat(e),value:e,text:e}}))),Ge=Object(s.b)((function(e){return{previewAudio:e.audio.previewAudio}}),(function(e){return{}}))((function(e){var t=e.activeView,n=e.simfileList,i=e.selectedDifficulty,o=e.previewAudio,s=Object(a.useRef)(),c=n.map((function(e){return{key:e.hash,value:e.hash,text:e.title}})),d=Object(a.useState)(null),h=Object(f.a)(d,2),m=h[0],p=h[1],g=Object(a.useState)(i),b=Object(f.a)(g,2),y=b[0],O=b[1],w=Object(a.useState)({title:"all",version:16,level:"all",difficulty:"all"}),E=Object(f.a)(w,2),k=E[0],P=E[1],_=Object(a.useState)([]),A=Object(f.a)(_,2),D=A[0],L=A[1];Object(a.useEffect)((function(){var e=k.title,t=k.version,a=k.level,r=k.difficulty,i=n.filter((function(n){return("all"===e||e===n.abcSort)&&("all"===t||t===parseInt(n.version))&&("all"===a||n.levels.slice(0,5).includes(a))})).filter((function(e){return"all"!==r?"all"===a?null!==e.levels[v.indexOf(r)]:e.levels[v.indexOf(r)]===a:e}));L(i),s.current.scrollTop=0}),[k]);var C=Object(a.useState)(null),N=Object(f.a)(C,2),x=N[0],I=N[1];Object(a.useEffect)((function(){if(document.body.click(),S.song){var e=S.progress?S.progress/1e5:0;T(null,{value:S.song},e)}else T(null,{value:"POq8OPlOO9199i11Od0P00801Qo01DQo"})}),[]),Object(a.useEffect)((function(){if(m){var e=n.find((function(e){return e.hash===m}));I(e),ue.storeAudioSource(e)}}),[m]);var T=function(){var t=Object(u.a)(l.a.mark((function t(a,r){var i,o,s,c,u,f,d,h,m=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=m.length>2&&void 0!==m[2]?m[2]:0,o=r.value,p(o),ue.stopSongPreview(),s=n.find((function(e){return e.hash===o})),"all"===k.difficulty){t.next=9;break}B(k.difficulty),t.next=47;break;case 9:if("all"===k.level){t.next=22;break}c=0;case 11:if(!(c<s.levels.length)){t.next=20;break}if((u=s.levels[c])!==k.level){t.next=17;break}return console.log("match",v[c],u),B(v[c]),t.abrupt("break",20);case 17:c++,t.next=11;break;case 20:t.next=47;break;case 22:if(f=v.indexOf(y),!s.levels[f]){t.next=27;break}e.onDifficultySelect(y),t.next=47;break;case 27:if(!["Difficult","Expert","Challenge"].includes(y)){t.next=38;break}d=4;case 29:if(!(d>=0)){t.next=36;break}if(!s.levels[d]){t.next=33;break}return e.onDifficultySelect(v[d]),t.abrupt("break",36);case 33:d--,t.next=29;break;case 36:t.next=47;break;case 38:if(!["Beginner","Basic"].includes(y)){t.next=47;break}h=0;case 40:if(!(h<=4)){t.next=47;break}if(!s.levels[h]){t.next=44;break}return e.onDifficultySelect(v[h]),t.abrupt("break",47);case 44:h++,t.next=40;break;case 47:e.onSongSelect(s,i);case 48:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),B=function(t){O(t),e.onDifficultySelect(t)};return r.a.createElement("div",{className:"form-container songView ".concat("song"===t?"open":"closed")},r.a.createElement("form",{className:"songForm"},r.a.createElement("div",{className:"form-inner-wrapper"},r.a.createElement("div",{className:"selectedSong"},r.a.createElement("div",{className:"selectedSong-jacket-wrapper ".concat("playing"===o.status?"playing":"")},r.a.createElement("div",{className:"selectedSong-jacket-overlay"},r.a.createElement(Re,null)),r.a.createElement("img",{className:"selectedSong-jacket",src:j("".concat(m,".png")),alt:"Selected song",onClick:function(){ue.currentPreview===x.hash?"playing"===o.status?ue.stopSongPreview():ue.playSongPreview(x):("playing"===o.status&&ue.stopSongPreview(),ue.playSongPreview(x))}})),r.a.createElement("div",{className:"selectedSong-info"},r.a.createElement(ke.a,{placeholder:"Choose a song",className:"song-title-dropdown",search:!0,selection:!0,value:m,onChange:T,options:c,selectOnBlur:!1,selectOnNavigation:!1}),r.a.createElement("div",{className:"song-artist"},x&&x.artist),r.a.createElement("div",{className:"song-difficulties"},x?x.levels.slice(0,5).map((function(e,t){if(!e)return null;var n=v[t];return r.a.createElement("div",{className:"song-difficulty ".concat(n," ").concat(i===n?"selected":""),key:"sp-difficulty_".concat(n),onClick:function(){return B(n)}},r.a.createElement("div",{className:"difficulty"},n),r.a.createElement("div",{className:"level"},e))})):null))),r.a.createElement("div",{className:"songForm-filters"},r.a.createElement("div",{className:"songForm-filters-row"},r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Title"),r.a.createElement(ke.a,{className:"title-filter-dropdown",selection:!0,value:k.title,onChange:function(e,t){return P(Me({},k,{title:t.value}))},options:Ve})),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Version"),r.a.createElement(ke.a,{className:"version-filter-dropdown",selection:!0,value:k.version,onChange:function(e,t){return P(Me({},k,{version:t.value}))},options:Ue})),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"By Level"),r.a.createElement(ke.a,{className:"level-filter-dropdown",selection:!0,value:k.level,onChange:function(e,t){return P(Me({},k,{level:t.value}))},options:ze}),r.a.createElement("label",null,"By Difficulty"),r.a.createElement(ke.a,{className:"difficulty-filter-dropdown",selection:!0,value:k.difficulty,onChange:function(e,t){return P(Me({},k,{difficulty:t.value}))},options:He})))))),r.a.createElement("div",{className:"songGrid-container",ref:s},r.a.createElement(Pe,{displayedSongs:D,onSongSelect:T,selectedSongOption:m})))})),Xe=n(422),qe=n(412),Qe=Object(s.b)((function(e){return{mods:e.mods}}),(function(e){return{updateMods:function(t){return e(function(e){return function(t){t({type:"UPDATE_MODS",payload:e})}}(t))}}}))((function(e){var t=e.activeView,n=(e.simfileList,e.selectedDifficulty,e.mods),a=(e.gameEngine,e.updateMods);return r.a.createElement("div",{className:"form-container ".concat("mods"===t?"open":"closed")},r.a.createElement("form",null,r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Speed"),$.mods.speed.map((function(e){return r.a.createElement(Xe.a,{key:"speed_".concat(e),label:"".concat(e,"x"),name:"speed",value:e,checked:n.speed===e,onChange:function(){return a({speed:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Arrow color"),$.mods.noteskin.map((function(e){return r.a.createElement(Xe.a,{key:"noteskin_".concat(e),label:_(e),name:"noteskin",value:e,checked:n.noteskin===e,onChange:function(){return a({noteskin:e})}})}))),r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Turn"),$.mods.turn.map((function(e){return r.a.createElement(Xe.a,{key:"turn_".concat(e),label:_(e),name:"turn",value:e,checked:n.turn===e,onChange:function(){return a({turn:e})}})}))),"shuffle"===n.turn&&r.a.createElement("div",{className:"form-field"},r.a.createElement("h4",{className:"form-label"},"Shuffle pattern"),$.mods.shuffle.map((function(e){return r.a.createElement(Xe.a,{key:"shuffle_".concat(e),label:e,name:"shuffle",value:e,checked:n.shuffle===e,onChange:function(){return a({shuffle:e})}})}))),r.a.createElement("h4",null,"Miscellaneous"),r.a.createElement("div",{className:"form-field"},r.a.createElement(qe.a,{toggle:!0,label:"Guidelines",name:"guidelines",checked:n.guidelines,onChange:function(){return a({guidelines:!n.guidelines})}})),r.a.createElement("div",{className:"form-field"},r.a.createElement(qe.a,{toggle:!0,label:"Color freeze heads",name:"colorFreezes",checked:n.colorFreezes,onChange:function(){return a({colorFreezes:!n.colorFreezes})}}))))})),Ze=Object(s.b)((function(e){var t=e.audio;return{chartAudio:t.chartAudio,previewAudio:t.previewAudio}}),(function(e){return{stopPreviewAudio:function(){return e((function(e){e({type:"STOP_PREVIEW_AUDIO"})}))}}}))((function(e){var t=e.activeView,n=e.chartAudio,a=(e.previewAudio,function(e){return"chart"!==e&&"playing"===n.status});return r.a.createElement("nav",{className:"mobileNav"},[{view:"song",icon:"music"},{view:"mods",icon:"sidebar"},{view:"2",icon:""},{view:"3",icon:""},{view:"chart",icon:"arrow up"}].map((function(i){var o=i.view,s=i.icon;return o?r.a.createElement("div",{key:"mobileNavItem_".concat(o),className:"mobileNav_item ".concat(t===o?"active":""," ").concat(a(o)?"disabled":""),onClick:function(){return function(t){"playing"!==n.status&&(ue.stopSongPreview(),e.setActiveView(t))}(o)}},r.a.createElement(h.a,{name:s})):r.a.createElement("div",{className:"mobileNav_item"})})))})),We=function(e){var t=Object(a.useState)(!0),n=Object(f.a)(t,2),i=n[0],o=n[1],s=Object(a.useState)([]),c=Object(f.a)(s,2),h=c[0],m=c[1],p=Object(a.useState)(null),v=Object(f.a)(p,2),g=v[0],b=v[1],y=Object(a.useState)(null),O=Object(f.a)(y,2),w=O[0],P=O[1],j=Object(a.useState)(ee.difficulty),_=Object(f.a)(j,2),S=_[0],A=_[1],D=Object(a.useState)(null),L=Object(f.a)(D,2),C=L[0],N=L[1],x=Object(a.useState)(ee.mods),I=Object(f.a)(x,2),T=(I[0],I[1],Object(a.useState)("chart")),B=Object(f.a)(T,2),R=B[0],F=B[1],M=Object(a.useState)(null),V=Object(f.a)(M,2),U=V[0],z=V[1],H=Object(a.useState)(!1),G=Object(f.a)(H,2),X=G[0],q=G[1];Object(a.useEffect)((function(){(function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q();case 2:o(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),ue.setLoadingAudio=q}),[]);var Q=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.a)(E()+"data/simfiles.tsv");case 3:(t=e.sent).forEach((function(e){e.levels=e.levels.split(",").map((function(e){return e?parseInt(e):null}))})),m(t),e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,r,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:0,console.log("MainContainer selected song",t),ue.selectSong(t,n),b(t),a=t.smName,"OddDoQ6dqi0QdQDDOO6qlO08d8bPbli1"===t.hash&&(a=a.replace("1",Math.floor(4*Math.random())+1)),e.prev=6,e.next=9,k("".concat(E(),"simfiles/").concat(encodeURIComponent(a),".sm"));case 9:r=e.sent,P(r),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),alert(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t){return e.apply(this,arguments)}}(),W=function(e){A(e)},Y=function(e){F(e),ue.activeView=e};return r.a.createElement("div",{className:"main-container"},!i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee,{loadingAudio:X,selectedSong:g,selectedDifficulty:S,sm:w,selectedAudio:C,gameEngine:U,setGameEngine:z}),r.a.createElement(Ge,{activeView:R,setActiveView:Y,simfileList:h,selectedDifficulty:S,onSongSelect:Z,onDifficultySelect:W,loadingAudio:X}),r.a.createElement(Qe,{activeView:R,simfileList:h,selectedSong:g,onSongSelect:Z,selectedDifficulty:S,onDifficultySelect:W,selectedAudio:C,setSelectedAudio:N,gameEngine:U}),r.a.createElement(Ze,{activeView:R,setActiveView:Y})))};var Ye=function(){return r.a.createElement("div",{className:"app-container"},r.a.createElement(We,null))};o.a.render(r.a.createElement(s.a,{store:le},r.a.createElement(Ye,null)),document.getElementById("root"))}},[[236,1,2]]]);
//# sourceMappingURL=main.dbe958d7.chunk.js.map